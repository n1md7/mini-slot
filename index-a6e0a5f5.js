var Fp=Object.defineProperty;var Bp=(i,t,e)=>t in i?Fp(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var W=(i,t,e)=>(Bp(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();const kp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI0AAAB5CAYAAAAEXaKqAAAMTUlEQVR4nO3cW2wbdb7A8W9uDrnZTqvSPqTYlVoRRIiNBFUvBFttooMqpAYFti8VDnCAgIDk9PCCKjapEPDCUZOiikuhTQoEWIgSkIBdrZo6ElLLghpDzkJUCHadNk1LG1+iXJyb98GyGyexZ2I7l+7+PtJf8Tj/m2d+/s9/xjMDQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghxL+ntCWo0wAYl6BekRgv8ONKd2IhFqAbCEpatckJ1MbagMttL+Bh5VeKJHWpfeHNqF4qdk+nAatlO1h3gLEIjBtTUKtICa8fHP8EVz+0/CXythXoSrTOZIPGBjTv/S/oOJFkTWk6yDLH/n+mGdL1STayykw6IOhd+H8zXphK7VSk8Rj8Tz0AHcBDidaTbNC0A5XO7xIcXTJNUNgBmcYku/FvbrQZfI+lpCrjVrhwEQA94EukjmSDJmi6Exx/v/GG4/9DQ+KipetCo4kICXphMvmRRq8Fc8mN5bo/Q9N7QJK7qERZgGDtfxMMDoSS7U8rPsmTtECq/98b26j9eOT9+tibNr7MRAuG6XWhv+GJVn19PXV1dej1N+Yf4+PjjI+PMzk5yfj4OIFAIPI6/H4gEIibJxAIMDExoZhvdl3x6v5Pcuj/oPpPoSmEXpt8fUkHTZirH0wmEw0NDaFllwuXy8XExARTU1NMTExEXk9OTka9Pzk5ydTUFB6Ph99++42ZmRmmpqYiafby7NfT09NMT09z5coVZmZmmJmZIRgMRl7HWv5P5OpP3VFtyoIGQK/X43A4sFqt+HwJzbFWDYPBAMCFCxdWuCerT0qDBqChoSEqYHQ6HWZzchNcr9fLjz8uz5lwm81GdXU1VqsVr9eL2WxOKHAsFkvSfXG5XKsyaFMeNF5v9HkHs9mM3W5PdTPY7XYcDgcdHR10dSV3EGAymairq6OysjJqLqbX62loaOCxxxZ/uLuUn7mxsXHxwZRhAFY+AC3Mmpmf/pygxWIJAsHMzMygRqMJajSaYHl5eXCp2e324Lp16yJtqk3l5eVBh8OhWP+WLVsWXfdSO3LkiOq+pKWlBU//rT6ynVjpo6fZHA4HANPT0xQWFpKenk5PTw8vv/wyJSUl7Nu3T7GOTz/9lP7+fnbs2AHAxo0b2bgx/gzOYrHQ2dlJeXn5ovq7bds2TCaTYr5XXnmF2trF/dZns9m4/fbbefrppxXz/vDDDwwNDWEwGNBqtZSUlCiWef755wkEArzxxhuKeYeGhiBNHzrrntj5vCgpDZrwXCYYDOL3+zEYDGRkZNDW1kZbWxulpaXccccdcev4+uuv+f777zl+/HjkvTfffJPdu3fHLVdSUsLDDz9MZ2en6v6eOXNGVb59+/Zx7NgxBgYG5v0vfGgfPpSfnp4mEAhw8uRJAJxOJ3v37o1bf2trKx9//DEAWVlZ7Ny5k3feeYe1a9ei1WrJyspasNxTTz0VtZ5iGR4eDv1Ek2UmFefzUj6nCQsEAly7do3NmzeTmRlqZmxsTLFcQUEBhYWFUe+1t7crBg3Ali1b6O7uVt1Hq9WqOu+BAwd49dVXuX79On6/n5GREfx+5VPf4+PjMTd6WEZGRuT15OQkdrudd999l4qKCgAKCwu59dZbWb9+PTk5OZG8Wq2WXbt2KX7mS5cuKfZzMZYsaCA0LPb29lJaWopOp1NcebBw0BQUFKhqb3BwcF7ZeJ588klV+a5fv87mzZu5dOnSoiegGRkZaDQaxTxzXbt2LVJuZGQEp9OJ0+lEr9dTVFTEunXrgNARltJnDn9pU2VJgwbA7/fz3Xffcc8996jqfH5+/ryVsGnTJsVyIyMjXLx4UXXQlJWVsX79+pj/Hx0d5fz58wwODjI1NQVAZWUlTU1NquoPy8jIIDs7WzHPXEVFRQuWGxsb49dff8XtdpOenq7q86r5si7GkgcNhIbcM2fO0NnZSWFhIRs2bIiZd+5Ik5OTQ1VVlWIb7e3tqgMmJyeH/fv3R5ZHR0cByM3NxePx4Ha7+eOPP4DQtzQc7A8++CCffPIJV65cUdVOuPwtt9yimGe2/Px8KioqFMsdOHAAt9tNWVkZWm3s3wduupFmtuHhYc6dO8eaNWswGo0LBs/9999PaWlpZHnbtm0xV974+DgOh4OzZ8/i9XpZs2aNqn5YrVZyc3Mjy19++SV9fX3s2bOHkZERgJhtPv7447z++uuq2gHQaDTk5eXFzbNp0ya2bt0KwNatW3nooYfifrEAWlpaIueCfv/9dywWS8x1dVMHTXZ2Njk5OYyNjfHLL79E9tEbNmyIjBLxzh4HAoHICNDX18fPP//MxMQEaWlpqkcZjUbD9u3bGR0d5erVqwwMDFBTU8P09DQ7d+5UnD9VVVXR3NzM5cuXVbWXlZWlGDT79++PGvli8fl8fPbZZ7z//vtcvHgx6n9dXV309PTwwAMPRAJwdh9SaUWCZjafzxc5VM/NzUWr1ZKXl0dubu68lZ2dnU1RUREQ2udv376dwcFB+vr66O/vn9fehQsXIrue0dFR3G43e/bswe12MzMzA8CxY8ci7be1tfHcc88pfo4XXniBl156SdVn1mg05Ofnq8o7l9vtxu124/P5+Pbbb3n77bfj5h8aGqK1tZVz585x3333UVZWBtzkI01OTo7iCvzwww8ZGBjg3nvvBeCuu+5i7dq1ccsYjUauXr1KU1MTw8PDOJ3OyG5mtqKiIo4ePRpZ7u/vp7m5ObJ88uRJnn32WXQ6Xdz2Hn30UY4ePTrv276QrKysqF3hQsK/MZlMpqifMYqLiykuLgbgkUceoampia6uLl588UV++umnmPX19vbS29vLqVOn2L17d8ovBVnWoMnLy1PcIF999RVnz57lrbfeAkLnIr755hvFs8I7duxgZGSEJ554ImaegwcPRu1+jhw5EvV/v9/PBx98oGoUOXjwIM8884xiPjWH3K2trRw6dAidTofL5YoKnLkqKipoaWnh7rvvVmzb6XTy3nvvKeZbrPSU1xhHXl4eWq02bpo7lPr9fmpqahTLabVaqqqquO222xZs22QyUVNTQ0FBQSR99NFHBIPBqPTaa69F5YmVampqIpdPpIrP56OxsVExn9lsxmazpbTtxVj2oNHpdHHTQucsenp6cDqdimV1Ol3MczpqNsZihS84S6XGxsZ5VwosV9tqLWvQJEPNiozFYrEs6icDtaqrq1dstDEajSs22tw0QaP2Qq7wL+2zzf1WVlZWkpaWFjepHZmWarRJedsz3lBKgWUNmngTvHjq6+tVlbXb7fMuM62trZ03ynzxxReKdXV0dKjqW3V1ddxvvJp+G43GqGWfzxd1VBevnOpLNqYcKb/5LhHzLsIixi0UJpMpeOLECVUXF3V3dwdPnz4dSU6nU1U5j8cTNBgMkTZ1Ol2wtrZ2wby1tbVBnU4Xs782m011u7PrNJlMkToMBkOwtrY26PF4VJU/fPhwVP8tFouqch6PJ2iz2RRvYzn9lS1lF2ElQ1XQqP3wyfB4PJGrBoFgfX29qnJ79+6d19/29vak+hIOnEQ4nc6ovnR3d6su6/F44gfN5/O2U8JBc9PMaRbicDioq6vDaDRGXSesdtK70Dwp0V1oKsrP3U0t5ogv2X4vxpKf3Avf0rIU9ca6TWbuzXqxuFyuhMvG6xcs7gKvWFpaWhbs40pb8qDx+XxJ3y2wWMnc7pKqW2VS9ZmXe92pcVPvnsTKSOlIk+oTXSI1BgcHgdT9aJnSoCkuLla8dkQsv1OnTrEqg8Z8J5w/f55du3alqkqRApcvX8bn82G+M3V1JhM0Lgg9xAhCjxx5odpJx1/fT75XNxNN8vdsxzXlgJnkbnA7fOjGI2Ec/4y8nfBvCsk+CctjKELv+keStaw2ubVwS2XodYZxdT/eLWAP/Q16waP8GL3qusgDG60keOdcskFzAqhuPw6VDyRZ02qTaQKN9eZ4OOSEHSaUt7/XB4WhG1y9gPobxOZINmgsgF2nBfvn0c92E6uL1wfWh+HH0O6pGUj4yY+peI7wYaBOpw09oksf/2pOsUKaP4081dMLmFkFzx05zSp4IKEkVUn5MRnLREfomcIrvUIkxU7drKKAEUIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgihyr8APvo/yZxiYygAAAAASUVORK5CYII=",Op=""+new URL("2xBAR-efa6cd69.png",import.meta.url).href,Lp=""+new URL("3xBAR-e2818b14.png",import.meta.url).href,Np=""+new URL("Seven-926b1e64.png",import.meta.url).href,Up=""+new URL("Cherry-dbf05cd9.png",import.meta.url).href,Gp=""+new URL("win-dff21367.mp3",import.meta.url).href,zp=""+new URL("spin-12eedf8e.mp3",import.meta.url).href;var Si=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(Si||{}),gh=(i=>(i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS",i))(gh||{}),Un=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(Un||{}),$=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))($||{}),Ie=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(Ie||{}),F=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(F||{}),Vi=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(Vi||{}),V=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(V||{}),Gn=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(Gn||{}),Re=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Re||{}),We=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(We||{}),Oe=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(Oe||{}),we=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(we||{}),Pe=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(Pe||{}),_o=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(_o||{}),ee=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(ee||{}),wt=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(wt||{}),dc=(i=>(i[i.RED=1]="RED",i[i.GREEN=2]="GREEN",i[i.BLUE=4]="BLUE",i[i.ALPHA=8]="ALPHA",i))(dc||{}),xt=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(xt||{}),De=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(De||{});const fc={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},B={ADAPTER:fc,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var ko=/iPhone/i,Cl=/iPod/i,Pl=/iPad/i,Il=/\biOS-universal(?:.+)Mac\b/i,Oo=/\bAndroid(?:.+)Mobile\b/i,Rl=/Android/i,as=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,sn=/Silk/i,ti=/Windows Phone/i,Ml=/\bWindows(?:.+)ARM\b/i,Dl=/BlackBerry/i,Fl=/BB10/i,Bl=/Opera Mini/i,kl=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ol=/Mobile(?:.+)Firefox\b/i,Ll=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function Hp(i){return function(t){return t.test(i)}}function Nl(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=Hp(e),n={apple:{phone:r(ko)&&!r(ti),ipod:r(Cl),tablet:!r(ko)&&(r(Pl)||Ll(t))&&!r(ti),universal:r(Il),device:(r(ko)||r(Cl)||r(Pl)||r(Il)||Ll(t))&&!r(ti)},amazon:{phone:r(as),tablet:!r(as)&&r(sn),device:r(as)||r(sn)},android:{phone:!r(ti)&&r(as)||!r(ti)&&r(Oo),tablet:!r(ti)&&!r(as)&&!r(Oo)&&(r(sn)||r(Rl)),device:!r(ti)&&(r(as)||r(sn)||r(Oo)||r(Rl))||r(/\bokhttp\b/i)},windows:{phone:r(ti),tablet:r(Ml),device:r(ti)||r(Ml)},other:{blackberry:r(Dl),blackberry10:r(Fl),opera:r(Bl),firefox:r(Ol),chrome:r(kl),device:r(Dl)||r(Fl)||r(Bl)||r(Ol)||r(kl)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Vp=Nl.default??Nl,Me=Vp(globalThis.navigator);B.RETINA_PREFIX=/@([0-9\.]+)x/;B.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Lo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _h(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var pc={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(h,l,u){this.fn=h,this.context=l,this.once=u||!1}function n(h,l,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,c||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,c;if(this._eventsCount===0)return l;for(c in u=this._events)t.call(u,c)&&l.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=e?e+l:l,c=this._events[u];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,f=c.length,p=new Array(f);d<f;d++)p[d]=c[d].fn;return p},a.prototype.listenerCount=function(l){var u=e?e+l:l,c=this._events[u];return c?c.fn?1:c.length:0},a.prototype.emit=function(l,u,c,d,f,p){var m=e?e+l:l;if(!this._events[m])return!1;var g=this._events[m],x=arguments.length,v,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),x){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,c),!0;case 4:return g.fn.call(g.context,u,c,d),!0;case 5:return g.fn.call(g.context,u,c,d,f),!0;case 6:return g.fn.call(g.context,u,c,d,f,p),!0}for(_=1,v=new Array(x-1);_<x;_++)v[_-1]=arguments[_];g.fn.apply(g.context,v)}else{var y=g.length,b;for(_=0;_<y;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),x){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,c);break;case 4:g[_].fn.call(g[_].context,u,c,d);break;default:if(!v)for(b=1,v=new Array(x-1);b<x;b++)v[b-1]=arguments[b];g[_].fn.apply(g[_].context,v)}}return!0},a.prototype.on=function(l,u,c){return n(this,l,u,c,!1)},a.prototype.once=function(l,u,c){return n(this,l,u,c,!0)},a.prototype.removeListener=function(l,u,c,d){var f=e?e+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!c||p.context===c)&&o(this,f);else{for(var m=0,g=[],x=p.length;m<x;m++)(p[m].fn!==u||d&&!p[m].once||c&&p[m].context!==c)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=e?e+l:l,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(pc);var $p=pc.exports;const Vs=_h($p);var xh={exports:{}};xh.exports=xo;xh.exports.default=xo;function xo(i,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:i.length,n=mc(i,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,u,c,d,f;if(s&&(n=qp(i,t,n,e)),i.length>80*e){a=l=i[0],h=u=i[1];for(var p=e;p<r;p+=e)c=i[p],d=i[p+1],c<a&&(a=c),d<h&&(h=d),c>l&&(l=c),d>u&&(u=d);f=Math.max(l-a,u-h),f=f!==0?32767/f:0}return gr(n,o,e,a,h,f,0),o}function mc(i,t,e,s,r){var n,o;if(r===wa(i,t,e,s)>0)for(n=t;n<e;n+=s)o=Ul(n,i[n],i[n+1],o);else for(n=e-s;n>=t;n-=s)o=Ul(n,i[n],i[n+1],o);return o&&vo(o,o.next)&&(xr(o),o=o.next),o}function Qi(i,t){if(!i)return i;t||(t=i);var e=i,s;do if(s=!1,!e.steiner&&(vo(e,e.next)||ct(e.prev,e,e.next)===0)){if(xr(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function gr(i,t,e,s,r,n,o){if(i){!o&&n&&tm(i,s,r,n);for(var a=i,h,l;i.prev!==i.next;){if(h=i.prev,l=i.next,n?Wp(i,s,r,n):Xp(i)){t.push(h.i/e|0),t.push(i.i/e|0),t.push(l.i/e|0),xr(i),i=l.next,a=l.next;continue}if(i=l,i===a){o?o===1?(i=jp(Qi(i),t,e),gr(i,t,e,s,r,n,2)):o===2&&Yp(i,t,e,s,r,n):gr(Qi(i),t,e,s,r,n,1);break}}}}function Xp(i){var t=i.prev,e=i,s=i.next;if(ct(t,e,s)>=0)return!1;for(var r=t.x,n=e.x,o=s.x,a=t.y,h=e.y,l=s.y,u=r<n?r<o?r:o:n<o?n:o,c=a<h?a<l?a:l:h<l?h:l,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,p=s.next;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=c&&p.y<=f&&xs(r,a,n,h,o,l,p.x,p.y)&&ct(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Wp(i,t,e,s){var r=i.prev,n=i,o=i.next;if(ct(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,u=r.y,c=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,p=u<c?u<d?u:d:c<d?c:d,m=a>h?a>l?a:l:h>l?h:l,g=u>c?u>d?u:d:c>d?c:d,x=ya(f,p,t,e,s),v=ya(m,g,t,e,s),_=i.prevZ,y=i.nextZ;_&&_.z>=x&&y&&y.z<=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&xs(a,u,h,c,l,d,_.x,_.y)&&ct(_.prev,_,_.next)>=0||(_=_.prevZ,y.x>=f&&y.x<=m&&y.y>=p&&y.y<=g&&y!==r&&y!==o&&xs(a,u,h,c,l,d,y.x,y.y)&&ct(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;_&&_.z>=x;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&xs(a,u,h,c,l,d,_.x,_.y)&&ct(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;y&&y.z<=v;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=g&&y!==r&&y!==o&&xs(a,u,h,c,l,d,y.x,y.y)&&ct(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function jp(i,t,e){var s=i;do{var r=s.prev,n=s.next.next;!vo(r,n)&&gc(r,s,s.next,n)&&_r(r,n)&&_r(n,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(n.i/e|0),xr(s),xr(s.next),s=i=n),s=s.next}while(s!==i);return Qi(s)}function Yp(i,t,e,s,r,n){var o=i;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&sm(o,a)){var h=_c(o,a);o=Qi(o,o.next),h=Qi(h,h.next),gr(o,t,e,s,r,n,0),gr(h,t,e,s,r,n,0);return}a=a.next}o=o.next}while(o!==i)}function qp(i,t,e,s){var r=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*s,h=n<o-1?t[n+1]*s:i.length,l=mc(i,a,h,s,!1),l===l.next&&(l.steiner=!0),r.push(im(l));for(r.sort(Kp),n=0;n<r.length;n++)e=Zp(r[n],e);return e}function Kp(i,t){return i.x-t.x}function Zp(i,t){var e=Qp(i,t);if(!e)return t;var s=_c(e,i);return Qi(s,s.next),Qi(e,e.next)}function Qp(i,t){var e=t,s=i.x,r=i.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=s&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===s))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,u=o.y,c=1/0,d;e=o;do s>=e.x&&e.x>=l&&s!==e.x&&xs(r<u?s:n,r,l,u,r<u?n:s,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(s-e.x),_r(e,i)&&(d<c||d===c&&(e.x>o.x||e.x===o.x&&Jp(o,e)))&&(o=e,c=d)),e=e.next;while(e!==h);return o}function Jp(i,t){return ct(i.prev,i,t.prev)<0&&ct(t.next,i,i.next)<0}function tm(i,t,e,s){var r=i;do r.z===0&&(r.z=ya(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,em(r)}function em(i){var t,e,s,r,n,o,a,h,l=1;do{for(e=i,i=null,n=null,o=0;e;){for(o++,s=e,a=0,t=0;t<l&&(a++,s=s.nextZ,!!s);t++);for(h=l;a>0||h>0&&s;)a!==0&&(h===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,a--):(r=s,s=s.nextZ,h--),n?n.nextZ=r:i=r,r.prevZ=n,n=r;e=s}n.nextZ=null,l*=2}while(o>1);return i}function ya(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function im(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function xs(i,t,e,s,r,n,o,a){return(r-o)*(t-a)>=(i-o)*(n-a)&&(i-o)*(s-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(s-a)}function sm(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!rm(i,t)&&(_r(i,t)&&_r(t,i)&&nm(i,t)&&(ct(i.prev,i,t.prev)||ct(i,t.prev,t))||vo(i,t)&&ct(i.prev,i,i.next)>0&&ct(t.prev,t,t.next)>0)}function ct(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function vo(i,t){return i.x===t.x&&i.y===t.y}function gc(i,t,e,s){var r=nn(ct(i,t,e)),n=nn(ct(i,t,s)),o=nn(ct(e,s,i)),a=nn(ct(e,s,t));return!!(r!==n&&o!==a||r===0&&rn(i,e,t)||n===0&&rn(i,s,t)||o===0&&rn(e,i,s)||a===0&&rn(e,t,s))}function rn(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function nn(i){return i>0?1:i<0?-1:0}function rm(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&gc(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function _r(i,t){return ct(i.prev,i,i.next)<0?ct(i,t,i.next)>=0&&ct(i,i.prev,t)>=0:ct(i,t,i.prev)<0||ct(i,i.next,t)<0}function nm(i,t){var e=i,s=!1,r=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function _c(i,t){var e=new ba(i.i,i.x,i.y),s=new ba(t.i,t.x,t.y),r=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function Ul(i,t,e,s){var r=new ba(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function xr(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ba(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}xo.deviation=function(i,t,e,s){var r=t&&t.length,n=r?t[0]*e:i.length,o=Math.abs(wa(i,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,u=a<h-1?t[a+1]*e:i.length;o-=Math.abs(wa(i,l,u,e))}var c=0;for(a=0;a<s.length;a+=3){var d=s[a]*e,f=s[a+1]*e,p=s[a+2]*e;c+=Math.abs((i[d]-i[p])*(i[f+1]-i[d+1])-(i[d]-i[f])*(i[p+1]-i[d+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function wa(i,t,e,s){for(var r=0,n=t,o=e-s;n<e;n+=s)r+=(i[o]-i[n])*(i[n+1]+i[o+1]),o=n;return r}xo.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<i.length;r++){for(var n=0;n<i[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(i[r][n][o]);r>0&&(s+=i[r-1].length,e.holes.push(s))}return e};var om=xh.exports;const xc=_h(om);var zn={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */zn.exports;(function(i,t){(function(e){var s=t&&!t.nodeType&&t,r=i&&!i.nodeType&&i,n=typeof Lo=="object"&&Lo;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,u=26,c=38,d=700,f=72,p=128,m="-",g=/^xn--/,x=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=h-l,b=Math.floor,A=String.fromCharCode,T;function w(R){throw RangeError(_[R])}function E(R,H){for(var q=R.length,it=[];q--;)it[q]=H(R[q]);return it}function M(R,H){var q=R.split("@"),it="";q.length>1&&(it=q[0]+"@",R=q[1]),R=R.replace(v,".");var J=R.split("."),nt=E(J,H).join(".");return it+nt}function I(R){for(var H=[],q=0,it=R.length,J,nt;q<it;)J=R.charCodeAt(q++),J>=55296&&J<=56319&&q<it?(nt=R.charCodeAt(q++),(nt&64512)==56320?H.push(((J&1023)<<10)+(nt&1023)+65536):(H.push(J),q--)):H.push(J);return H}function D(R){return E(R,function(H){var q="";return H>65535&&(H-=65536,q+=A(H>>>10&1023|55296),H=56320|H&1023),q+=A(H),q}).join("")}function P(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:h}function S(R,H){return R+22+75*(R<26)-((H!=0)<<5)}function O(R,H,q){var it=0;for(R=q?b(R/d):R>>1,R+=b(R/H);R>y*u>>1;it+=h)R=b(R/y);return b(it+(y+1)*R/(R+c))}function G(R){var H=[],q=R.length,it,J=0,nt=p,yt=f,At,kt,Yt,Dt,at,bt,Et,Ne,Ue;for(At=R.lastIndexOf(m),At<0&&(At=0),kt=0;kt<At;++kt)R.charCodeAt(kt)>=128&&w("not-basic"),H.push(R.charCodeAt(kt));for(Yt=At>0?At+1:0;Yt<q;){for(Dt=J,at=1,bt=h;Yt>=q&&w("invalid-input"),Et=P(R.charCodeAt(Yt++)),(Et>=h||Et>b((a-J)/at))&&w("overflow"),J+=Et*at,Ne=bt<=yt?l:bt>=yt+u?u:bt-yt,!(Et<Ne);bt+=h)Ue=h-Ne,at>b(a/Ue)&&w("overflow"),at*=Ue;it=H.length+1,yt=O(J-Dt,it,Dt==0),b(J/it)>a-nt&&w("overflow"),nt+=b(J/it),J%=it,H.splice(J++,0,nt)}return D(H)}function C(R){var H,q,it,J,nt,yt,At,kt,Yt,Dt,at,bt=[],Et,Ne,Ue,js;for(R=I(R),Et=R.length,H=p,q=0,nt=f,yt=0;yt<Et;++yt)at=R[yt],at<128&&bt.push(A(at));for(it=J=bt.length,J&&bt.push(m);it<Et;){for(At=a,yt=0;yt<Et;++yt)at=R[yt],at>=H&&at<At&&(At=at);for(Ne=it+1,At-H>b((a-q)/Ne)&&w("overflow"),q+=(At-H)*Ne,H=At,yt=0;yt<Et;++yt)if(at=R[yt],at<H&&++q>a&&w("overflow"),at==H){for(kt=q,Yt=h;Dt=Yt<=nt?l:Yt>=nt+u?u:Yt-nt,!(kt<Dt);Yt+=h)js=kt-Dt,Ue=h-Dt,bt.push(A(S(Dt+js%Ue,0))),kt=b(js/Ue);bt.push(A(S(kt,0))),nt=O(q,Ne,it==J),q=0,++it}++q,++H}return bt.join("")}function k(R){return M(R,function(H){return g.test(H)?G(H.slice(4).toLowerCase()):H})}function X(R){return M(R,function(H){return x.test(H)?"xn--"+C(H):H})}if(o={version:"1.3.2",ucs2:{decode:I,encode:D},decode:G,encode:C,toASCII:X,toUnicode:k},s&&r)if(i.exports==s)r.exports=o;else for(T in o)o.hasOwnProperty(T)&&(s[T]=o[T]);else e.punycode=o})(Lo)})(zn,zn.exports);var am=zn.exports,hm={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},vr={};function lm(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var um=function(i,t,e,s){t=t||"&",e=e||"=";var r={};if(typeof i!="string"||i.length===0)return r;var n=/\+/g;i=i.split(t);var o=1e3;s&&typeof s.maxKeys=="number"&&(o=s.maxKeys);var a=i.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var l=i[h].replace(n,"%20"),u=l.indexOf(e),c,d,f,p;u>=0?(c=l.substr(0,u),d=l.substr(u+1)):(c=l,d=""),f=decodeURIComponent(c),p=decodeURIComponent(d),lm(r,f)?Array.isArray(r[f])?r[f].push(p):r[f]=[r[f],p]:r[f]=p}return r},Ys=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},cm=function(i,t,e,s){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(r){var n=encodeURIComponent(Ys(r))+e;return Array.isArray(i[r])?i[r].map(function(o){return n+encodeURIComponent(Ys(o))}).join(t):n+encodeURIComponent(Ys(i[r]))}).join(t):s?encodeURIComponent(Ys(s))+e+encodeURIComponent(Ys(i)):""};vr.decode=vr.parse=um;vr.encode=vr.stringify=cm;var dm=am,ze=hm,fm=yo,pm=Am,mm=Em;function Fe(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var gm=/^([a-z0-9.+-]+:)/i,_m=/:[0-9]*$/,xm=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,vm=["<",">",'"',"`"," ","\r",`
`,"	"],ym=["{","}","|","\\","^","`"].concat(vm),Ta=["'"].concat(ym),Gl=["%","/","?",";","#"].concat(Ta),zl=["/","?","#"],bm=255,Hl=/^[+a-z0-9A-Z_-]{0,63}$/,wm=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Tm={javascript:!0,"javascript:":!0},Ea={javascript:!0,"javascript:":!0},Es={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Aa=vr;function yo(i,t,e){if(i&&ze.isObject(i)&&i instanceof Fe)return i;var s=new Fe;return s.parse(i,t,e),s}Fe.prototype.parse=function(i,t,e){if(!ze.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var s=i.indexOf("?"),r=s!==-1&&s<i.indexOf("#")?"?":"#",n=i.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),i=n.join(r);var a=i;if(a=a.trim(),!e&&i.split("#").length===1){var h=xm.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=Aa.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=gm.exec(a);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var c=a.substr(0,2)==="//";c&&!(l&&Ea[l])&&(a=a.substr(2),this.slashes=!0)}if(!Ea[l]&&(c||l&&!Es[l])){for(var d=-1,f=0;f<zl.length;f++){var p=a.indexOf(zl[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(m=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<Gl.length;f++){var p=a.indexOf(Gl[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var v=this.hostname.split(/\./),f=0,_=v.length;f<_;f++){var y=v[f];if(y&&!y.match(Hl)){for(var b="",A=0,T=y.length;A<T;A++)y.charCodeAt(A)>127?b+="x":b+=y[A];if(!b.match(Hl)){var w=v.slice(0,f),E=v.slice(f+1),M=y.match(wm);M&&(w.push(M[1]),E.unshift(M[2])),E.length&&(a="/"+E.join(".")+a),this.hostname=w.join(".");break}}}this.hostname.length>bm?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=dm.toASCII(this.hostname));var I=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+I,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Tm[u])for(var f=0,_=Ta.length;f<_;f++){var P=Ta[f];if(a.indexOf(P)!==-1){var S=encodeURIComponent(P);S===P&&(S=escape(P)),a=a.split(P).join(S)}}var O=a.indexOf("#");O!==-1&&(this.hash=a.substr(O),a=a.slice(0,O));var G=a.indexOf("?");if(G!==-1?(this.search=a.substr(G),this.query=a.substr(G+1),t&&(this.query=Aa.parse(this.query)),a=a.slice(0,G)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Es[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",C=this.search||"";this.path=I+C}return this.href=this.format(),this};function Em(i){return ze.isString(i)&&(i=yo(i)),i instanceof Fe?i.format():Fe.prototype.format.call(i)}Fe.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",s=this.hash||"",r=!1,n="";this.host?r=i+this.host:this.hostname&&(r=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&ze.isObject(this.query)&&Object.keys(this.query).length&&(n=Aa.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Es[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+e+o+s};function Am(i,t){return yo(i,!1,!0).resolve(t)}Fe.prototype.resolve=function(i){return this.resolveObject(yo(i,!1,!0)).format()};Fe.prototype.resolveObject=function(i){if(ze.isString(i)){var t=new Fe;t.parse(i,!1,!0),i=t}for(var e=new Fe,s=Object.keys(this),r=0;r<s.length;r++){var n=s[r];e[n]=this[n]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var o=Object.keys(i),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=i[h])}return Es[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!Es[i.protocol]){for(var l=Object.keys(i),u=0;u<l.length;u++){var c=l[u];e[c]=i[c]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!Ea[i.protocol]){for(var _=(i.pathname||"").split("/");_.length&&!(i.host=_.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",m=i.host||i.pathname&&i.pathname.charAt(0)==="/",g=m||p||e.host&&i.pathname,x=g,v=e.pathname&&e.pathname.split("/")||[],_=i.pathname&&i.pathname.split("/")||[],y=e.protocol&&!Es[e.protocol];if(y&&(e.hostname="",e.port=null,e.host&&(v[0]===""?v[0]=e.host:v.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(_[0]===""?_[0]=i.host:_.unshift(i.host)),i.host=null),g=g&&(_[0]===""||v[0]==="")),m)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,v=_;else if(_.length)v||(v=[]),v.pop(),v=v.concat(_),e.search=i.search,e.query=i.query;else if(!ze.isNullOrUndefined(i.search)){if(y){e.hostname=e.host=v.shift();var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.host=e.hostname=b.shift())}return e.search=i.search,e.query=i.query,(!ze.isNull(e.pathname)||!ze.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!v.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var A=v.slice(-1)[0],T=(e.host||i.host||v.length>1)&&(A==="."||A==="..")||A==="",w=0,E=v.length;E>=0;E--)A=v[E],A==="."?v.splice(E,1):A===".."?(v.splice(E,1),w++):w&&(v.splice(E,1),w--);if(!g&&!x)for(;w--;w)v.unshift("..");g&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),T&&v.join("/").substr(-1)!=="/"&&v.push("");var M=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(y){e.hostname=e.host=M?"":v.length?v.shift():"";var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.host=e.hostname=b.shift())}return g=g||e.host&&v.length,g&&!M&&v.unshift(""),v.length?e.pathname=v.join("/"):(e.pathname=null,e.path=null),(!ze.isNull(e.pathname)||!ze.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};Fe.prototype.parseHost=function(){var i=this.host,t=_m.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const vc={parse:fm,format:mm,resolve:pm};function Te(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function qs(i){return i.split("?")[0].split("#")[0]}function Sm(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Cm(i,t,e){return i.replace(new RegExp(Sm(t),"g"),e)}function Pm(i,t){let e="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${i.slice(r+1,a)}`:e=i.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Bt={toPosix(i){return Cm(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){Te(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),s=/^[^/:]+:\/\//.exec(i),r=/^[^/:]+:\//.exec(i);if(e||s||r){const n=(e==null?void 0:e[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);t=n,i=i.slice(n.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const s=qs(this.toPosix(t??B.ADAPTER.getBaseUrl())),r=qs(this.toPosix(e??this.rootname(s)));return Te(i),i=this.toPosix(i),i.startsWith("/")?Bt.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(i=this.toPosix(i),Te(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=Pm(i,!1),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return Te(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(Te(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.extname(r)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(Te(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),o=i;i=i.slice(n.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){Te(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){Te(i),t&&Te(t),i=qs(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(n=i.length-1;n>=0;--n){const h=i.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){Te(i),i=qs(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){Te(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=qs(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=i.length-1,u=0;for(;l>=r;--l){if(e=i.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||a===-1||u===0||u===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,a)):(t.name=i.slice(o,n),t.base=i.slice(o,a)),t.ext=i.slice(n,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},Vl={};function j(i,t,e=3){if(Vl[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),Vl[t]=!0}function Im(){j("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Rm(){j("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let No;function yc(){return typeof No>"u"&&(No=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:B.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!B.ADAPTER.getWebGLRenderingContext())return!1;const s=B.ADAPTER.createCanvas();let r=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),No}var Mm={grad:.9,turn:360,rad:360/(2*Math.PI)},ei=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},Ct=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},me=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},bc=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},$l=function(i){return{r:me(i.r,0,255),g:me(i.g,0,255),b:me(i.b,0,255),a:me(i.a)}},Uo=function(i){return{r:Ct(i.r),g:Ct(i.g),b:Ct(i.b),a:Ct(i.a,3)}},Dm=/^#([0-9a-f]{3,8})$/i,on=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},wc=function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=Math.max(t,e,s),o=n-Math.min(t,e,s),a=o?n===t?(e-s)/o:n===e?2+(s-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},Tc=function(i){var t=i.h,e=i.s,s=i.v,r=i.a;t=t/360*6,e/=100,s/=100;var n=Math.floor(t),o=s*(1-e),a=s*(1-(t-n)*e),h=s*(1-(1-t+n)*e),l=n%6;return{r:255*[s,a,o,o,h,s][l],g:255*[h,s,s,a,o,o][l],b:255*[o,o,h,s,s,a][l],a:r}},Xl=function(i){return{h:bc(i.h),s:me(i.s,0,100),l:me(i.l,0,100),a:me(i.a)}},Wl=function(i){return{h:Ct(i.h),s:Ct(i.s),l:Ct(i.l),a:Ct(i.a,3)}},jl=function(i){return Tc((e=(t=i).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},ur=function(i){return{h:(t=wc(i)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},Fm=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bm=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,km=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Om=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Sa={string:[[function(i){var t=Dm.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Ct(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?Ct(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=km.exec(i)||Om.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:$l({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=Fm.exec(i)||Bm.exec(i);if(!t)return null;var e,s,r=Xl({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(Mm[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return jl(r)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=r===void 0?1:r;return ei(t)&&ei(e)&&ei(s)?$l({r:Number(t),g:Number(e),b:Number(s),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,s=i.l,r=i.a,n=r===void 0?1:r;if(!ei(t)||!ei(e)||!ei(s))return null;var o=Xl({h:Number(t),s:Number(e),l:Number(s),a:Number(n)});return jl(o)},"hsl"],[function(i){var t=i.h,e=i.s,s=i.v,r=i.a,n=r===void 0?1:r;if(!ei(t)||!ei(e)||!ei(s))return null;var o=function(a){return{h:bc(a.h),s:me(a.s,0,100),v:me(a.v,0,100),a:me(a.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(n)});return Tc(o)},"hsv"]]},Yl=function(i,t){for(var e=0;e<t.length;e++){var s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},Lm=function(i){return typeof i=="string"?Yl(i.trim(),Sa.string):typeof i=="object"&&i!==null?Yl(i,Sa.object):[null,void 0]},Go=function(i,t){var e=ur(i);return{h:e.h,s:me(e.s+100*t,0,100),l:e.l,a:e.a}},zo=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},ql=function(i,t){var e=ur(i);return{h:e.h,s:e.s,l:me(e.l+100*t,0,100),a:e.a}},Ca=function(){function i(t){this.parsed=Lm(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return Ct(zo(this.rgba),2)},i.prototype.isDark=function(){return zo(this.rgba)<.5},i.prototype.isLight=function(){return zo(this.rgba)>=.5},i.prototype.toHex=function(){return t=Uo(this.rgba),e=t.r,s=t.g,r=t.b,o=(n=t.a)<1?on(Ct(255*n)):"","#"+on(e)+on(s)+on(r)+o;var t,e,s,r,n,o},i.prototype.toRgb=function(){return Uo(this.rgba)},i.prototype.toRgbString=function(){return t=Uo(this.rgba),e=t.r,s=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+s+", "+r+", "+n+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,n},i.prototype.toHsl=function(){return Wl(ur(this.rgba))},i.prototype.toHslString=function(){return t=Wl(ur(this.rgba)),e=t.h,s=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+n+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,n},i.prototype.toHsv=function(){return t=wc(this.rgba),{h:Ct(t.h),s:Ct(t.s),v:Ct(t.v),a:Ct(t.a,3)};var t},i.prototype.invert=function(){return Ge({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),Ge(Go(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ge(Go(this.rgba,-t))},i.prototype.grayscale=function(){return Ge(Go(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),Ge(ql(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),Ge(ql(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?Ge({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Ct(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=ur(this.rgba);return typeof t=="number"?Ge({h:t,s:e.s,l:e.l,a:e.a}):Ct(e.h)},i.prototype.isEqual=function(t){return this.toHex()===Ge(t).toHex()},i}(),Ge=function(i){return i instanceof Ca?i:new Ca(i)},Kl=[],Nm=function(i){i.forEach(function(t){Kl.indexOf(t)<0&&(t(Ca,Sa),Kl.push(t))})};function Um(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var n={};i.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=s[this.toHex()];if(l)return l;if(o!=null&&o.closest){var u=this.toRgb(),c=1/0,d="black";if(!n.length)for(var f in e)n[f]=new i(e[f]).toRgb();for(var p in e){var m=(a=u,h=n[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));m<c&&(c=m,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new i(h).toRgb():null},"name"])}Nm([Um]);const As=class{constructor(i=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=i}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(i){return this.value=i,this}set value(i){if(i instanceof As)this._value=this.cloneSource(i._value),this._int=i._int,this._components.set(i._components);else{if(i===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,i))&&(this.normalize(i),this._value=this.cloneSource(i))}}get value(){return this._value}cloneSource(i){return typeof i=="string"||typeof i=="number"||i instanceof Number||i===null?i:Array.isArray(i)||ArrayBuffer.isView(i)?i.slice(0):typeof i=="object"&&i!==null?{...i}:i}isSourceEqual(i,t){const e=typeof i;if(e!==typeof t)return!1;if(e==="number"||e==="string"||i instanceof Number)return i===t;if(Array.isArray(i)&&Array.isArray(t)||ArrayBuffer.isView(i)&&ArrayBuffer.isView(t))return i.length!==t.length?!1:i.every((r,n)=>r===t[n]);if(i!==null&&t!==null){const r=Object.keys(i),n=Object.keys(t);return r.length!==n.length?!1:r.every(o=>i[o]===t[o])}return i===t}toRgba(){const[i,t,e,s]=this._components;return{r:i,g:t,b:e,a:s}}toRgb(){const[i,t,e]=this._components;return{r:i,g:t,b:e}}toRgbaString(){const[i,t,e]=this.toUint8RgbArray();return`rgba(${i},${t},${e},${this.alpha})`}toUint8RgbArray(i){const[t,e,s]=this._components;return i=i??[],i[0]=Math.round(t*255),i[1]=Math.round(e*255),i[2]=Math.round(s*255),i}toRgbArray(i){i=i??[];const[t,e,s]=this._components;return i[0]=t,i[1]=e,i[2]=s,i}toNumber(){return this._int}toLittleEndianNumber(){const i=this._int;return(i>>16)+(i&65280)+((i&255)<<16)}multiply(i){const[t,e,s,r]=As.temp.setValue(i)._components;return this._components[0]*=t,this._components[1]*=e,this._components[2]*=s,this._components[3]*=r,this.refreshInt(),this._value=null,this}premultiply(i,t=!0){return t&&(this._components[0]*=i,this._components[1]*=i,this._components[2]*=i),this._components[3]=i,this.refreshInt(),this._value=null,this}toPremultiplied(i,t=!0){if(i===1)return(255<<24)+this._int;if(i===0)return t?0:this._int;let e=this._int>>16&255,s=this._int>>8&255,r=this._int&255;return t&&(e=e*i+.5|0,s=s*i+.5|0,r=r*i+.5|0),(i*255<<24)+(e<<16)+(s<<8)+r}toHex(){const i=this._int.toString(16);return`#${"000000".substring(0,6-i.length)+i}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(i){return this._components[3]=this._clamp(i),this}round(i){const[t,e,s]=this._components;return this._components[0]=Math.round(t*i)/i,this._components[1]=Math.round(e*i)/i,this._components[2]=Math.round(s*i)/i,this.refreshInt(),this._value=null,this}toArray(i){i=i??[];const[t,e,s,r]=this._components;return i[0]=t,i[1]=e,i[2]=s,i[3]=r,i}normalize(i){let t,e,s,r;if((typeof i=="number"||i instanceof Number)&&i>=0&&i<=16777215){const n=i;t=(n>>16&255)/255,e=(n>>8&255)/255,s=(n&255)/255,r=1}else if((Array.isArray(i)||i instanceof Float32Array)&&i.length>=3&&i.length<=4)i=this._clamp(i),[t,e,s,r=1]=i;else if((i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&i.length>=3&&i.length<=4)i=this._clamp(i,0,255),[t,e,s,r=255]=i,t/=255,e/=255,s/=255,r/=255;else if(typeof i=="string"||typeof i=="object"){if(typeof i=="string"){const o=As.HEX_PATTERN.exec(i);o&&(i=`#${o[2]}`)}const n=Ge(i);n.isValid()&&({r:t,g:e,b:s,a:r}=n.rgba,t/=255,e/=255,s/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=e,this._components[2]=s,this._components[3]=r,this.refreshInt();else throw new Error(`Unable to convert color ${i}`)}refreshInt(){this._clamp(this._components);const[i,t,e]=this._components;this._int=(i*255<<16)+(t*255<<8)+(e*255|0)}_clamp(i,t=0,e=1){return typeof i=="number"?Math.min(Math.max(i,t),e):(i.forEach((s,r)=>{i[r]=Math.min(Math.max(s,t),e)}),i)}};let tt=As;tt.shared=new As;tt.temp=new As;tt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function Gr(i,t=[]){return j("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),tt.shared.setValue(i).toRgbArray(t)}function Ec(i){return j("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),tt.shared.setValue(i).toHex()}function Gm(i){return j("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(i).toNumber()}function zr(i){return j("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(i).toNumber()}function zm(){const i=[],t=[];for(let s=0;s<32;s++)i[s]=s,t[s]=s;i[$.NORMAL_NPM]=$.NORMAL,i[$.ADD_NPM]=$.ADD,i[$.SCREEN_NPM]=$.SCREEN,t[$.NORMAL]=$.NORMAL_NPM,t[$.ADD]=$.ADD_NPM,t[$.SCREEN]=$.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const vh=zm();function yh(i,t){return vh[t?1:0][i]}function Hm(i,t,e,s=!0){return j("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),tt.shared.setValue(i).premultiply(t,s).toArray(e??new Float32Array(4))}function Vm(i,t){return j("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),tt.shared.setValue(i).toPremultiplied(t)}function $m(i,t,e,s=!0){return j("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),tt.shared.setValue(i).premultiply(t,s).toArray(e??new Float32Array(4))}const Ac=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Sc(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let s=0,r=0;s<e;s+=6,r+=4)t[s+0]=r+0,t[s+1]=r+1,t[s+2]=r+2,t[s+3]=r+0,t[s+4]=r+2,t[s+5]=r+3;return t}function bo(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}const Xm={Float32Array,Uint32Array,Int32Array,Uint8Array};function Wm(i,t){let e=0,s=0;const r={};for(let h=0;h<i.length;h++)s+=t[h],e+=i[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<i.length;h++){const l=t[h],u=i[h],c=bo(u);r[c]||(r[c]=new Xm[c](n)),o=r[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*s+a,p=d%l;o[f+p]=u[d]}a+=l}return new Float32Array(n)}function yr(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function Pa(i){return!(i&i-1)&&!!i}function Ia(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function $i(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}function ni(i){return i===0?0:i<0?-1:1}let jm=0;function wi(){return++jm}const Cc=class{constructor(i,t,e,s){this.left=i,this.top=t,this.right=e,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Hn=Cc;Hn.EMPTY=new Cc(0,0,0,0);const Ra={},Gt=Object.create(null),Zt=Object.create(null);function Ym(){let i;for(i in Gt)Gt[i].destroy();for(i in Zt)Zt[i].destroy()}function qm(){let i;for(i in Gt)delete Gt[i];for(i in Zt)delete Zt[i]}class Pc{constructor(t,e,s){this._canvas=B.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||B.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Zl(i,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(i[r+3]!==0)return!1;return!0}function Ql(i,t,e,s,r){const n=4*t;for(let o=s,a=s*n+4*e;o<=r;++o,a+=n)if(i[a+3]!==0)return!1;return!0}function Ic(i){const{width:t,height:e}=i,s=i.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const n=s.getImageData(0,0,t,e).data;let o=0,a=0,h=t-1,l=e-1;for(;a<e&&Zl(n,t,a);)++a;if(a===e)return Hn.EMPTY;for(;Zl(n,t,l);)--l;for(;Ql(n,t,o,a,l);)++o;for(;Ql(n,t,h,a,l);)--h;return++h,++l,new Hn(o,a,h,l)}function Rc(i){const t=Ic(i),{width:e,height:s}=t;let r=null;if(!t.isEmpty()){const n=i.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(t.left,t.top,e,s)}return{width:e,height:s,data:r}}function Km(i){const t=Ac.exec(i);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}let an;function Mc(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,an||(an=document.createElement("a")),an.href=i;const e=vc.parse(an.href),s=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!s||e.protocol!==t.protocol?"anonymous":""}function oi(i,t=1){var s;const e=(s=B.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}const Zm=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:Zt,BoundingBox:Hn,CanvasRenderTarget:Pc,DATA_URI:Ac,EventEmitter:Vs,ProgramCache:Ra,TextureCache:Gt,clearTextureCache:qm,correctBlendMode:yh,createIndicesForQuads:Sc,decomposeDataUri:Km,deprecation:j,destroyTextureCache:Ym,determineCrossOrigin:Mc,earcut:xc,getBufferType:bo,getCanvasBoundingBox:Ic,getResolutionOfUrl:oi,hex2rgb:Gr,hex2string:Ec,interleaveTypedArrays:Wm,isMobile:Me,isPow2:Pa,isWebGLSupported:yc,log2:Ia,nextPow2:yr,path:Bt,premultiplyBlendMode:vh,premultiplyRgba:Hm,premultiplyTint:Vm,premultiplyTintToRgba:$m,removeItems:$i,rgb2hex:zr,sayHello:Rm,sign:ni,skipHello:Im,string2hex:Gm,trimCanvas:Rc,uid:wi,url:vc},Symbol.toStringTag,{value:"Module"}));var L=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(L||{});const Ma=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Jl=(i,t)=>Ma(i).priority??t,z={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Ma).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(Ma).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(i,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&(n[i].forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>Jl(n,e)-Jl(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};class Vn{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const Qm=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Jm(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function Dc(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=Qm.replace(/%forloop%/gi,Jm(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const Ho=0,Vo=1,$o=2,Xo=3,Wo=4,jo=5;class Qe{constructor(){this.data=0,this.blendMode=$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ho)}set blend(t){!!(this.data&1<<Ho)!==t&&(this.data^=1<<Ho)}get offsets(){return!!(this.data&1<<Vo)}set offsets(t){!!(this.data&1<<Vo)!==t&&(this.data^=1<<Vo)}get culling(){return!!(this.data&1<<$o)}set culling(t){!!(this.data&1<<$o)!==t&&(this.data^=1<<$o)}get depthTest(){return!!(this.data&1<<Xo)}set depthTest(t){!!(this.data&1<<Xo)!==t&&(this.data^=1<<Xo)}get depthMask(){return!!(this.data&1<<jo)}set depthMask(t){!!(this.data&1<<jo)!==t&&(this.data^=1<<jo)}get clockwiseFrontFace(){return!!(this.data&1<<Wo)}set clockwiseFrontFace(t){!!(this.data&1<<Wo)!==t&&(this.data^=1<<Wo)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==$.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Qe;return t.depthTest=!1,t.blend=!0,t}}const $n=[];function bh(i,t){if(!i)return null;let e="";if(typeof i=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);s&&(e=s[1].toLowerCase())}for(let s=$n.length-1;s>=0;--s){const r=$n[s];if(r.test&&r.test(i,e))return new r(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ie{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,s,r,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][l](t,e,s,r,n,o,a,h);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ie.prototype,{dispatch:{value:ie.prototype.emit},run:{value:ie.prototype.emit}});class Rs{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ie("setRealSize"),this.onUpdate=new ie("update"),this.onError=new ie("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class $s extends Rs{constructor(t,e){const{width:s,height:r}=e||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=t}upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===we.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const tg={scaleMode:Re.NEAREST,format:F.RGBA,alphaMode:we.NPM},ds=class extends Vs{constructor(i=null,t=null){super(),t=Object.assign({},ds.defaultOptions,t);const{alphaMode:e,mipmap:s,anisotropicLevel:r,scaleMode:n,width:o,height:a,wrapMode:h,format:l,type:u,target:c,resolution:d,resourceOptions:f}=t;i&&!(i instanceof Rs)&&(i=bh(i,f),i.internal=!0),this.resolution=d||B.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=h,this._scaleMode=n,this.format=l,this.type=u,this.target=c,this.alphaMode=e,this.uid=wi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Pa(this.realWidth)&&Pa(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Zt[this.cacheId],delete Gt[this.cacheId],this.cacheId=null),this.dispose(),ds.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=B.STRICT_TEXTURE_CACHE){const s=typeof i=="string";let r=null;if(s)r=i;else{if(!i._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${o}_${wi()}`}r=i._pixiId}let n=Zt[r];if(s&&e&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new ds(i,t),n.cacheId=r,ds.addToCache(n,r)),n}static fromBuffer(i,t,e,s){i=i||new Float32Array(t*e*4);const r=new $s(i,{width:t,height:e}),n=i instanceof Float32Array?V.FLOAT:V.UNSIGNED_BYTE;return new ds(r,Object.assign({},tg,{type:n},s))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),Zt[t]&&Zt[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Zt[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=Zt[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete Zt[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete Zt[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let Y=ds;Y.defaultOptions={mipmap:Oe.POW2,anisotropicLevel:0,scaleMode:Re.LINEAR,wrapMode:We.CLAMP,alphaMode:we.UNPACK,target:Vi.TEXTURE_2D,format:F.RGBA,type:V.UNSIGNED_BYTE};Y._globalBatch=0;class Xn{constructor(){this.texArray=null,this.blend=0,this.type=Ie.TRIANGLES,this.start=0,this.size=0,this.data=null}}let eg=0;class pt{constructor(t,e=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=eg++,this.disposeRunner=new ie("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?De.ELEMENT_ARRAY_BUFFER:De.ARRAY_BUFFER}get index(){return this.type===De.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new pt(t)}}class br{constructor(t,e=0,s=!1,r=V.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=s,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,s,r,n){return new br(t,e,s,r,n)}}const ig={Float32Array,Uint32Array,Int32Array,Uint8Array};function sg(i,t){let e=0,s=0;const r={};for(let h=0;h<i.length;h++)s+=t[h],e+=i[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<i.length;h++){const l=t[h],u=i[h],c=bo(u);r[c]||(r[c]=new ig[c](n)),o=r[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*s+a,p=d%l;o[f+p]=u[d]}a+=l}return new Float32Array(n)}const tu={5126:4,5123:2,5121:1};let rg=0;const ng={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ai{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=rg++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ie("disposeGeometry"),this.refCount=0}addAttribute(t,e,s=0,r=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof pt||(e instanceof Array&&(e=new Float32Array(e)),e=new pt(e));const l=t.split("|");if(l.length>1){for(let c=0;c<l.length;c++)this.addAttribute(l[c],e,s,r,n);return this}let u=this.buffers.indexOf(e);return u===-1&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new br(u,s,r,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof pt||(t instanceof Array&&(t=new Uint16Array(t)),t=new pt(t)),t.type=De.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],s=new pt;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*tu[n.type]/4),n.buffer=0}for(s.data=sg(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new ai;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new pt(this.buffers[e].data.slice(0));for(const e in this.attributes){const s=this.attributes[e];t.attributes[e]=new br(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=De.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new ai,s=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)r[h]=r[h]||0,r[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)s[a]=new ng[bo(o.buffers[a].data)](r[a]),e.buffers[a]=new pt(s[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=De.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(h+=d.size*tu[d.type]/4)}for(let c=0;c<t.length;c++){const d=t[c].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[c].buffers[u].data.length/h,l+=d.length}}return e}}class wh extends ai{constructor(t=!1){super(),this._buffer=new pt(null,t,!1),this._indexBuffer=new pt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,V.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,V.FLOAT).addAttribute("aColor",this._buffer,4,!0,V.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,V.FLOAT).addIndex(this._indexBuffer)}}const wr=Math.PI*2,Fc=180/Math.PI,Ms=Math.PI/180;var Rt=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(Rt||{});let K=class Bc{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Bc(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};const hn=[new K,new K,new K,new K];class Z{constructor(t=0,e=0,s=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r),this.type=Rt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Z(0,0,0,0)}clone(){return new Z(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const w=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=w)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=hn[0].set(t.left,t.top),h=hn[1].set(t.left,t.bottom),l=hn[2].set(t.right,t.top),u=hn[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(c===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(u,u),Math.max(a.x,h.x,l.x,u.x)<=s||Math.min(a.x,h.x,l.x,u.x)>=r||Math.max(a.y,h.y,l.y,u.y)<=n||Math.min(a.y,h.y,l.y,u.y)>=o))return!1;const d=c*(h.y-a.y),f=c*(a.x-h.x),p=d*s+f*n,m=d*r+f*n,g=d*s+f*o,x=d*r+f*o;if(Math.max(p,m,g,x)<=d*a.x+f*a.y||Math.min(p,m,g,x)>=d*u.x+f*u.y)return!1;const v=c*(a.y-l.y),_=c*(l.x-a.x),y=v*s+_*n,b=v*r+_*n,A=v*s+_*o,T=v*r+_*o;return!(Math.max(y,b,A,T)<=v*a.x+_*a.y||Math.min(y,b,A,T)>=v*u.x+_*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class wo{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.radius=s,this.type=Rt.CIRC}clone(){return new wo(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=s}getBounds(){return new Z(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class To{constructor(t=0,e=0,s=0,r=0){this.x=t,this.y=e,this.width=s,this.height=r,this.type=Rt.ELIP}clone(){return new To(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,r=(e-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new Z(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Xi{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,n=e.length;r<n;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.type=Rt.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Xi(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],u=this.points[o*2+1];h>e!=u>e&&t<(l-a)*((e-h)/(u-h))+a&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class Eo{constructor(t=0,e=0,s=0,r=0,n=20){this.x=t,this.y=e,this.width=s,this.height=r,this.radius=n,this.type=Rt.RREC}clone(){return new Eo(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),n=e-(this.y+s);const o=s*s;if(r*r+n*n<=o||(r=t-(this.x+this.width-s),r*r+n*n<=o)||(n=e-(this.y+this.height-s),r*r+n*n<=o)||(r=t-(this.x+s),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class ot{constructor(t=1,e=0,s=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new K;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new K;const s=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*s*r+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*n+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}setTransform(t,e,s,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(s,e),l=Math.abs(a+h);return l<1e-5||Math.abs(wr-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new ot;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new ot}static get TEMP_MATRIX(){return new ot}}const Bi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ki=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Oi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Li=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Da=[],kc=[],ln=Math.sign;function og(){for(let i=0;i<16;i++){const t=[];Da.push(t);for(let e=0;e<16;e++){const s=ln(Bi[i]*Bi[e]+Oi[i]*ki[e]),r=ln(ki[i]*Bi[e]+Li[i]*ki[e]),n=ln(Bi[i]*Oi[e]+Oi[i]*Li[e]),o=ln(ki[i]*Oi[e]+Li[i]*Li[e]);for(let a=0;a<16;a++)if(Bi[a]===s&&ki[a]===r&&Oi[a]===n&&Li[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new ot;t.set(Bi[i],ki[i],Oi[i],Li[i],0,0),kc.push(t)}}og();const ht={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Bi[i],uY:i=>ki[i],vX:i=>Oi[i],vY:i=>Li[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Da[i][t],sub:(i,t)=>Da[i][ht.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?ht.S:ht.N:Math.abs(t)*2<=Math.abs(i)?i>0?ht.E:ht.W:t>0?i>0?ht.SE:ht.SW:i>0?ht.NE:ht.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=kc[ht.inv(t)];r.tx=e,r.ty=s,i.append(r)}};class $e{constructor(t,e,s=0,r=0){this._x=s,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new $e(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Oc=class{constructor(){this.worldTransform=new ot,this.localTransform=new ot,this.position=new $e(this.onChange,this,0,0),this.scale=new $e(this.onChange,this,1,1),this.pivot=new $e(this.onChange,this,0,0),this.skew=new $e(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,s=this.worldTransform;s.a=t.a*e.a+t.b*e.c,s.b=t.a*e.b+t.b*e.d,s.c=t.c*e.a+t.d*e.c,s.d=t.c*e.b+t.d*e.d,s.tx=t.tx*e.a+t.ty*e.c+e.tx,s.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let Hr=Oc;Hr.IDENTITY=new Oc;var ag=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,hg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function eu(i,t,e){const s=i.createShader(t);return i.shaderSource(s,e),i.compileShader(s),s}function Yo(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Lc(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Yo(2*t);case"bvec3":return Yo(3*t);case"bvec4":return Yo(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Wi=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${i}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(i,t)=>i.type==="vec3"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${i}"].location, v.red, v.green, v.blue)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],lg={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},ug={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function cg(i,t){var s;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in i.uniforms){const n=t[r];if(!n){(s=i.uniforms[r])!=null&&s.group&&(i.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=i.uniforms[r];let a=!1;for(let h=0;h<Wi.length;h++)if(Wi[h].test(n,o)){e.push(Wi[h].code(r,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?lg:ug)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Nc={};let hs=Nc;function Uc(){if(hs===Nc||hs!=null&&hs.isContextLost()){const i=B.ADAPTER.createCanvas();let t;B.PREFER_ENV>=Si.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),hs=t}return hs}let un;function dg(){if(!un){un=ee.MEDIUM;const i=Uc();i&&i.getShaderPrecisionFormat&&(un=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?ee.HIGH:ee.MEDIUM)}return un}function iu(i,t){const e=i.getShaderSource(t).split(`
`).map((l,u)=>`${u}: ${l}`),s=i.getShaderInfoLog(t),r=s.split(`
`),n={},o=r.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function fg(i,t,e,s){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||iu(i,e),i.getShaderParameter(s,i.COMPILE_STATUS)||iu(i,s),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const pg={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Gc(i){return pg[i]}let cn=null;const su={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function zc(i,t){if(!cn){const e=Object.keys(su);cn={};for(let s=0;s<e.length;++s){const r=e[s];cn[i[r]]=su[r]}}return cn[t]}function ru(i,t,e){if(i.substring(0,9)!=="precision"){let s=t;return t===ee.HIGH&&e!==ee.HIGH&&(s=ee.MEDIUM),`precision ${s} float;
${i}`}else if(e!==ee.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Ks;function Hc(){if(typeof Ks=="boolean")return Ks;try{Ks=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ks=!1}return Ks}let mg=0;const dn={},fs=class{constructor(i,t,e="pixi-shader",s={}){this.extra={},this.id=mg++,this.vertexSrc=i||fs.defaultVertexSrc,this.fragmentSrc=t||fs.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),dn[e]?(dn[e]++,e+=`-${dn[e]}`):dn[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=ru(this.vertexSrc,fs.defaultVertexPrecision,ee.HIGH),this.fragmentSrc=ru(this.fragmentSrc,fs.defaultFragmentPrecision,dg())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return hg}static get defaultFragmentSrc(){return ag}static from(i,t,e){const s=i+t;let r=Ra[s];return r||(Ra[s]=r=new fs(i,t,e)),r}};let ge=fs;ge.defaultVertexPrecision=ee.HIGH;ge.defaultFragmentPrecision=Me.apple.device?ee.HIGH:ee.MEDIUM;let gg=0;class ye{constructor(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=gg++,this.static=!!e,this.ubo=!!s,t instanceof pt?(this.buffer=t,this.buffer.type=De.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new pt(new Float32Array(1)),this.buffer.type=De.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,s){if(!this.ubo)this.uniforms[t]=new ye(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,s){return new ye(t,e,s)}static uboFrom(t,e){return new ye(t,e??!0,!0)}}class Be{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ye?this.uniformGroup=e:this.uniformGroup=new ye(e):this.uniformGroup=new ye({}),this.disposeRunner=new ie("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const s in e.uniforms){const r=e.uniforms[s];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,s){const r=ge.from(t,e);return new Be(r,s)}}class Vc{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let n=0;n<t;n++)s[n]=n;this.defaultGroupCache[t]=ye.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ge(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new ot,default:this.defaultGroupCache[t]};return new Be(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+=`if(vTextureId < ${s}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Wn{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function _g(){return!Me.apple.device}function xg(i){let t=!0;const e=B.ADAPTER.getNavigator();if(Me.tablet||Me.phone){if(Me.apple.device){const s=e.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(Me.android.device){const s=e.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?i:4}class Vr{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var vg=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,yg=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Ae=class extends Vr{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=wh,this.vertexSize=6,this.state=Qe.for2d(),this.size=Ae.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??xg(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??_g(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return j("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return yg}static get defaultFragmentTemplate(){return vg}setShaderGenerator({vertex:i=Ae.defaultVertexSrc,fragment:t=Ae.defaultFragmentTemplate}={}){this.shaderGenerator=new Vc(i,t)}contextChange(){const i=this.renderer.gl;B.PREFER_ENV===Si.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),Ae.defaultMaxTextures),this.maxTextures=Dc(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=Ae,e=this.size/4,s=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new Xn);for(;t.length<s;)t.push(new Wn);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=Ae._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++Y._globalBatch,a=0,h=e[0],l=0;s.copyBoundTextures(r,t);for(let u=0;u<this._bufferSize;++u){const c=i[u];i[u]=null,c._batchEnabled!==o&&(h.count>=t&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,u),l=u,h=e[++a],++o),c._batchEnabled=o,c.touched=n,h.elements[h.count++]=c)}h.count>0&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let u=0;u<r.length;u++)r[u]=null;Y._globalBatch=o}buildDrawCalls(i,t,e){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:n,vertexSize:o}=this,a=Ae._drawCallPool;let h=this._dcIndex,l=this._aIndex,u=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=i;for(let d=t;d<e;++d){const f=s[d],p=f._texture.baseTexture,m=vh[p.alphaMode?1:0][f.blendMode];s[d]=null,t<d&&c.blend!==m&&(c.size=u-c.start,t=d,c=a[++h],c.texArray=i,c.start=u),this.packInterleavedGeometry(f,r,n,l,u),l+=f.vertexData.length/2*o,u+=f.indices.length,c.blend=m}t<e&&(c.size=u-c.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=u}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;Ae.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,s=Ae._drawCallPool;let r=null;for(let n=0;n<i;n++){const{texArray:o,type:a,size:h,start:l,blend:u}=s[n];r!==o&&(r=o,this.bindAndClearTexArray(o)),this.state.blendMode=u,e.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ae.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=yr(Math.ceil(i/8)),e=Ia(t),s=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new Vn(s*this.vertexSize*4)),r}getIndexBuffer(i){const t=yr(Math.ceil(i/12)),e=Ia(t),s=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(s)),r}packInterleavedGeometry(i,t,e,s,r){const{uint32View:n,float32View:o}=t,a=s/this.vertexSize,h=i.uvs,l=i.indices,u=i.vertexData,c=i._texture.baseTexture._batchLocation,d=Math.min(i.worldAlpha,1),f=tt.shared.setValue(i._tintRGB).toPremultiplied(d,i._texture.baseTexture.alphaMode>0);for(let p=0;p<u.length;p+=2)o[s++]=u[p],o[s++]=u[p+1],o[s++]=h[p],o[s++]=h[p+1],n[s++]=f,o[s++]=c;for(let p=0;p<l.length;p++)e[r++]=a+l[p]}};let de=Ae;de.defaultBatchSize=4096;de.extension={name:"batch",type:L.RendererPlugin};de._drawCallPool=[];de._textureArrayPool=[];z.add(de);var bg=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,wg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ir=class extends Be{constructor(i,t,e){const s=ge.from(i||ir.defaultVertexSrc,t||ir.defaultFragmentSrc);super(s,e),this.padding=0,this.resolution=ir.defaultResolution,this.multisample=ir.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Qe}apply(i,t,e,s,r){i.applyFilter(this,t,e,s)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return wg}static get defaultFragmentSrc(){return bg}};let Q=ir;Q.defaultResolution=1;Q.defaultMultisample=xt.NONE;class $r{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new tt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:s,backgroundAlpha:r}=t,n=s??e;n!==void 0&&(this.color=n),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}$r.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};$r.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"background"};z.add($r);class Th{constructor(t){this.renderer=t,this.emptyRenderer=new Vr(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:s}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=s[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,s,r){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const u=n[l],c=u._batchLocation;if(c>=0&&c<r&&e[c]===u){o[l]=c;continue}for(;h<r;){const d=e[h];if(d&&d._batchEnabled===s&&d._batchLocation===h){h++;continue}o[l]=h,u._batchLocation=h,e[h]=u;break}}}destroy(){this.renderer=null}}Th.extension={type:L.RendererSystem,name:"batch"};z.add(Th);let nu=0;class Xr{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=nu++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=nu++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let s;if(B.PREFER_ENV>=Si.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Xr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};Xr.extension={type:L.RendererSystem,name:"context"};z.add(Xr);class Tg extends $s{upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===we.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}}class jn{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ie("disposeFramebuffer"),this.multisample=xt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Y(null,{scaleMode:Re.NEAREST,resolution:1,mipmap:Oe.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Y(new Tg(null,{width:this.width,height:this.height}),{scaleMode:Re.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Oe.OFF,format:F.DEPTH_COMPONENT,type:V.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Eh extends Y{constructor(t={}){if(typeof t=="number"){const e=arguments[0],s=arguments[1],r=arguments[2],n=arguments[3];t={width:e,height:s,scaleMode:r,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=xt.NONE),super(null,t),this.mipmap=Oe.OFF,this.valid=!0,this._clear=new tt([0,0,0,0]),this.framebuffer=new jn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class hi extends Rs{constructor(t){const e=t,s=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(s,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=Mc(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,e,s,r){const n=t.gl,o=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===we.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&s.width===o&&s.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,s.type,r):(s.width=o,s.height=a,n.texImage2D(e.target,0,s.internalFormat,e.format,s.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(e,s),super.update()}dispose(){this.source=null}}class Ah extends hi{constructor(t,e){if(e=e||{},typeof t=="string"){const s=new Image;hi.crossOrigin(s,t,e.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??B.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,s)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===we.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,s){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,s,this.bitmap),!this.preserveBitmap){let r=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==s&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Sh{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const r=e.width,n=e.height;if(s){const o=t.width/2/r,a=t.height/2/n,h=t.x/r+o,l=t.y/n+a;s=ht.add(s,ht.NW),this.x0=h+o*ht.uX(s),this.y0=l+a*ht.uY(s),s=ht.add(s,2),this.x1=h+o*ht.uX(s),this.y1=l+a*ht.uY(s),s=ht.add(s,2),this.x2=h+o*ht.uX(s),this.y2=l+a*ht.uY(s),s=ht.add(s,2),this.x3=h+o*ht.uX(s),this.y3=l+a*ht.uY(s)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const ou=new Sh;function fn(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class N extends Vs{constructor(t,e,s,r,n,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Z(0,0,1,1)),t instanceof N&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=ou,this.uvMatrix=null,this.orig=s||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new K(o.x,o.y):new K(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Gt[e.url]&&N.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,N.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),s=new N(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===ou&&(this._uvs=new Sh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},s=B.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof Y){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${wi()}`,Y.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${wi()}`}n=t._pixiId}let o=Gt[n];if(r&&s&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof Y)?(e.resolution||(e.resolution=oi(t)),o=new N(new Y(t,e)),o.baseTexture.cacheId=n,Y.addToCache(o.baseTexture,n),N.addToCache(o,n)):!o&&t instanceof Y&&(o=new N(t),N.addToCache(o,n)),o}static fromURL(t,e){const s=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=N.from(t,Object.assign({resourceOptions:s},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,s,r){return new N(Y.fromBuffer(t,e,s,r))}static fromLoader(t,e,s,r){const n=new Y(t,Object.assign({scaleMode:Y.defaultOptions.scaleMode,resolution:oi(e)},r)),{resource:o}=n;o instanceof Ah&&(o.url=e);const a=new N(n);return s||(s=e),Y.addToCache(a.baseTexture,s),N.addToCache(a,s),s!==e&&(Y.addToCache(a.baseTexture,e),N.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Gt[e]&&Gt[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Gt[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Gt[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete Gt[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Gt[t.textureCacheIds[e]]===t&&delete Gt[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:s,width:r,height:n}=t,o=e+r>this.baseTexture.width,a=s+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,u=`Y: ${s} + ${n} = ${s+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${u}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return N._EMPTY||(N._EMPTY=new N(new Y),fn(N._EMPTY),fn(N._EMPTY.baseTexture)),N._EMPTY}static get WHITE(){if(!N._WHITE){const t=B.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),N._WHITE=new N(Y.from(t)),fn(N._WHITE),fn(N._WHITE.baseTexture)}return N._WHITE}}class Ci extends N{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,s=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Ci(new Eh(t))}}class Ch{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,s=xt.NONE){const r=new Eh(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new Ci(r)}getOptimalTexture(t,e,s=1,r=xt.NONE){let n;t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=yr(t),e=yr(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(s),o}getFilterTexture(t,e,s){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||xt.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Ch.SCREEN_KEY=-1;class $c extends ai{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Ph extends ai{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new pt(this.vertices),this.uvBuffer=new pt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+e.width/t.width,this.uvs[3]=r,this.uvs[4]=s+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=s,this.uvs[7]=r+e.height/t.height,s=e.x,r=e.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+e.width,this.vertices[3]=r,this.vertices[4]=s+e.width,this.vertices[5]=r+e.height,this.vertices[6]=s,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Xc{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=xt.NONE,this.sourceFrame=new Z,this.destinationFrame=new Z,this.bindingSourceFrame=new Z,this.bindingDestinationFrame=new Z,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const pn=[new K,new K,new K,new K],qo=new ot;class Ih{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Ch,this.statePool=[],this.quad=new $c,this.quadUv=new Ph,this.tempRect=new Z,this.activeState={},this.globalUniforms=new ye({outputFrame:new Z,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const s=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Xc,o=this.renderer.renderTexture;let a=e[0].resolution,h=e[0].multisample,l=e[0].padding,u=e[0].autoFit,c=e[0].legacy??!0;for(let p=1;p<e.length;p++){const m=e[p];a=Math.min(a,m.resolution),h=Math.min(h,m.multisample),l=this.useMaxPadding?Math.max(l,m.padding):l+m.padding,u=u&&m.autoFit,c=c||(m.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=a,n.multisample=h,n.legacy=c,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);const d=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(qo.copyFrom(s.projection.transform).invert(),d),u?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=s.projection.transform,s.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,f),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=r.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,h.renderTexture,Pe.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;let c=0;for(c=0;c<s.length-1;++c){c===1&&e.multisample>1&&(u=this.getOptimalFilterTexture(l.width,l.height,e.resolution),u.filterFrame=l.filterFrame),s[c].apply(this,l,u,Pe.CLEAR,e);const d=l;l=u,u=d}s[c].apply(this,l,h.renderTexture,Pe.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Pe.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(e===Pe.CLEAR||e===Pe.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,s,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(s,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Ie.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Ie.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:n}=e._texture,o=t.set(r.width,0,0,r.height,s.x,s.y),a=e.worldTransform.copyTo(ot.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,s=1,r=xt.NONE){return this.texturePool.getOptimalTexture(t,e,s,r)}getFilterTexture(t,e,s){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||xt.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const s=pn[0],r=pn[1],n=pn[2],o=pn[3];s.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(s,s),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(s.x,r.x,n.x,o.x),h=Math.min(s.y,r.y,n.y,o.y),l=Math.max(s.x,r.x,n.x,o.x),u=Math.max(s.y,r.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=u-h}roundFrame(t,e,s,r,n){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?qo.copyFrom(n):qo.identity(),n.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}Ih.extension={type:L.RendererSystem,name:"filter"};z.add(Ih);class Wc{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=xt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Eg=new Z;class Rh{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new jn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Z,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;B.PREFER_ENV===Si.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,s=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=s),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>s,a=e.height>>s,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>s,a=t.height>>s;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,s,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),r=Math.round(r),(n.width!==s||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=s,n.height=r,this.gl.viewport(t,e,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,s,r,n=Un.COLOR|Un.DEPTH){const{gl:o}=this;o.clearColor(t,e,s,r),o.clear(n)}initFramebuffer(t){const{gl:e}=this,s=new Wc(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:e}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,s.stencil),s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;s.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),h===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,l.target,u._glTextures[this.CONTEXT_UID].texture,e),a.push(s.COLOR_ATTACHMENT0+h))}if(a.length>1&&s.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let s=xt.NONE;if(t<=1||e===null)return s;for(let r=0;r<e.length;r++)if(e[r]<=t){s=e[r];break}return s===1&&(s=xt.NONE),s}blit(t,e,s){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const u=r.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new jn(r.width,r.height),h.blitFramebuffer.addColorTexture(0,u)),t=h.blitFramebuffer,t.colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=Eg,e.width=r.width,e.height=r.height),s||(s=e);const l=e.width===s.width&&e.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const s=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const s=t.width,r=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,s,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,r),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Z}destroy(){this.renderer=null}}Rh.extension={type:L.RendererSystem,name:"framebuffer"};z.add(Rh);const Ko={5126:4,5123:2,5121:1};class Mh{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;B.PREFER_ENV===Si.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=r=>s.bindVertexArrayOES(r),t.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(r,n)=>s.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,h)=>s.drawElementsInstancedANGLE(r,n,o,a,h),t.drawArraysInstanced=(r,n,o,a)=>s.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:s}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const r=t.buffers[s];e.update(r)}}checkCompatibility(t,e){const s=t.attributes,r=e.attributeData;for(const n in r)if(!s[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const s=t.attributes,r=e.attributeData,n=["g",t.id];for(const o in s)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,e,s=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let u=l[h];if(u)return l[a.id]=u,u;const c=t.buffers,d=t.attributes,f={},p={};for(const m in c)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*Ko[d[m].type];for(const m in d){const g=d[m],x=g.size;g.stride===void 0&&(f[g.buffer]===x*Ko[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=x*Ko[g.type])}u=r.createVertexArray(),r.bindVertexArray(u);for(let m=0;m<c.length;m++){const g=c[m];o.bind(g),s&&g._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=u,l[h]=u,r.bindVertexArray(null),o.unbind(De.ARRAY_BUFFER),u}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in s)if(h[0]==="g"){const l=s[h];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)}activateVao(t,e){const s=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const u=a[l],c=o[u.buffer],d=c._glBuffers[r];if(e.attributeData[l]){h!==d&&(n.bind(c),h=d);const f=e.attributeData[l].location;if(s.enableVertexAttribArray(f),s.vertexAttribPointer(f,u.size,u.type||s.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)s.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,s,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(s||0)*a,r||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(s||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,s,e||o.getSize(),r||1):n.drawArrays(t,s,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Mh.extension={type:L.RendererSystem,name:"geometry"};z.add(Mh);const au=new ot;class Ao{constructor(t,e){this._texture=t,this.mapCoord=new ot,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*s.a+o*s.c+s.tx,e[r+1]=n*s.b+o*s.d+s.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,n=e.trim;n&&(au.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(au));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var Ag=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Sg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class jc extends Q{constructor(t,e,s){let r=null;typeof t!="string"&&e===void 0&&s===void 0&&(r=t,t=void 0,e=void 0,s=void 0),super(t||Sg,e||Ag,s),this.maskSprite=r,this.maskMatrix=new ot}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,s,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Ao(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,s,r))}}class Yc{constructor(t=null){this.type=wt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Q.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=wt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Dh{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let s=e;if(!s.isMaskData){const n=this.maskDataPool.pop()||new Yc;n.pooled=!0,n.maskObject=e,s=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==wt.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case wt.SCISSOR:this.renderer.scissor.push(s);break;case wt.STENCIL:this.renderer.stencil.push(s);break;case wt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case wt.COLOR:this.pushColorMask(s);break}s.type===wt.SPRITE&&this.maskStack.push(s)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case wt.SCISSOR:this.renderer.scissor.pop(e);break;case wt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case wt.SPRITE:this.popSpriteMask(e);break;case wt.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===wt.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=wt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=wt.SCISSOR:t.type=wt.STENCIL:t.type=wt.COLOR}pushSpriteMask(t){const{maskObject:e}=t,s=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new jc]));const n=this.renderer,o=n.renderTexture;let a,h;if(o.current){const u=o.current;a=t.resolution||u.resolution,h=t.multisample??u.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;r[0].resolution=a,r[0].multisample=h,r[0].maskSprite=e;const l=s.filterArea;s.filterArea=e.getBounds(!0),n.filter.push(s,r),s.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}Dh.extension={type:L.RendererSystem,name:"mask"};z.add(Dh);class qc{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,s=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==s&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const hu=new ot,lu=[],Cn=class extends qc{constructor(i){super(i),this.glConst=B.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:s}=this,r=s.renderTexture,n=e.getBounds(!0,lu.pop()??new Z);this.roundFrameToPixels(n,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),t&&n.fit(t),i._scissorRectLocal=n}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:s,d:r}=i;return(Math.abs(e)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||Cn.isMatrixRotated(t.worldTransform)||Cn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,s,r){Cn.isMatrixRotated(r)||(r=r?hu.copyFrom(r):hu.identity(),r.translate(-e.x,-e.y).scale(s.width/e.width,s.height/e.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,i),i.fit(s),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&lu.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let Fh=Cn;Fh.extension={type:L.RendererSystem,name:"scissor"};z.add(Fh);class Bh extends qc{constructor(t){super(t),this.glConst=B.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:s}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(s._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Bh.extension={type:L.RendererSystem,name:"stencil"};z.add(Bh);class kh{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return j("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return j("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return j("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}kh.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_plugin"};z.add(kh);class Oh{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ot,this.transform=null}update(t,e,s,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,s,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Oh.extension={type:L.RendererSystem,name:"projection"};z.add(Oh);const Cg=new Hr;class Lh{constructor(t){this.renderer=t,this._tempMatrix=new ot}generateTexture(t,e){const{region:s,...r}=e||{},n=s||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=Ci.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=Cg,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Lh.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"textureGenerator"};z.add(Lh);const Ri=new Z,Zs=new Z;class Nh{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Z,this.destinationFrame=new Z,this.viewportFrame=new Z}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,s){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(Ri.width=t.frame.width,Ri.height=t.frame.height,e=Ri),s||(Zs.x=t.frame.x,Zs.y=t.frame.y,Zs.width=e.width,Zs.height=e.height,s=Zs),o=n.framebuffer):(a=r.resolution,e||(Ri.width=r._view.screen.width,Ri.height=r._view.screen.height,e=Ri),s||(s=Ri,s.width=e.width,s.height=e.height));const h=this.viewportFrame;h.x=s.x*a,h.y=s.y*a,h.width=s.width*a,h.height=s.height*a,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(s,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)}clear(t,e){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=tt.shared.setValue(t||s);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:l,width:u,height:c}=this.viewportFrame;h=Math.round(h),l=Math.round(l),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,u,c)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Nh.extension={type:L.RendererSystem,name:"renderTexture"};z.add(Nh);class Pg{}class Kc{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Ig(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const n=t.getActiveAttrib(i,r);if(n.name.startsWith("gl_"))continue;const o=zc(t,n.type),a={type:o,name:n.name,size:Gc(o),location:t.getAttribLocation(i,n.name)};e[n.name]=a}return e}function Rg(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const n=t.getActiveUniform(i,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=zc(t,n.type);e[o]={name:o,index:r,type:h,size:n.size,isArray:a,value:Lc(h,n.size)}}return e}function Zc(i,t){var h;const e=eu(i,i.VERTEX_SHADER,t.vertexSrc),s=eu(i,i.FRAGMENT_SHADER,t.fragmentSrc),r=i.createProgram();i.attachShader(r,e),i.attachShader(r,s);const n=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(n&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(r),i.getProgramParameter(r,i.LINK_STATUS)||fg(i,r,e,s),t.attributeData=Ig(r,i),t.uniformData=Rg(r,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((u,c)=>u>c?1:-1);for(let u=0;u<l.length;u++)t.attributeData[l[u]].location=u,i.bindAttribLocation(r,u,l[u]);i.linkProgram(r)}i.deleteShader(e),i.deleteShader(s);const o={};for(const l in t.uniformData){const u=t.uniformData[l];o[l]={location:i.getUniformLocation(r,l),value:Lc(u.type,u.size)}}return new Kc(r,o)}function Mg(i,t,e,s,r){e.buffer.update(r)}const Dg={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Qc={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Jc(i){const t=i.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,s=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=Qc[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,s%e!==0&&s<16){const a=s%e%16;s+=a,r+=a}s+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,s=e):(o.offset=r,s+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function td(i,t){const e=[];for(const s in i)t[s]&&e.push(t[s]);return e.sort((s,r)=>s.index-r.index),e}function ed(i,t){if(!i.autoManage)return{size:0,syncFunc:Mg};const e=td(i.uniforms,t),{uboElements:s,size:r}=Jc(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const a=s[o],h=i.uniforms[a.data.name],l=a.data.name;let u=!1;for(let c=0;c<Wi.length;c++){const d=Wi[c];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,Wi[c].codeUbo(a.data.name,h)),u=!0;break}}if(!u)if(a.data.size>1){const c=Gc(a.data.type),d=Math.max(Qc[a.data.type]/16,1),f=c/d,p=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const c=Dg[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${c};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let Fg=0;const mn={textureCount:0,uboCount:0};class Uh{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Fg++}systemCheck(){if(!Hc())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),e||(mn.textureCount=0,mn.uboCount=0,this.syncUniformGroup(t.uniformGroup,mn)),r}setUniforms(t){const e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,e){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))}syncUniforms(t,e,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=cg(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const r=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),r(s.uniformData,t.uniforms,this.renderer,mn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])}createSyncBufferGroup(t,e,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=ed(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,s){const r=t.uniforms,n=[`${s}-`];for(const o in r)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,s=t.program,r=Zc(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Uh.extension={type:L.RendererSystem,name:"shader"};z.add(Uh);class Wr{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.4 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Wr.defaultOptions={hello:!1};Wr.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"startup"};z.add(Wr);function Bg(i,t=[]){return t[$.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.ADD]=[i.ONE,i.ONE],t[$.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.NONE]=[0,0],t[$.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[$.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[$.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[$.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[$.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[$.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[$.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[$.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[$.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[$.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[$.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const kg=0,Og=1,Lg=2,Ng=3,Ug=4,Gg=5,Fa=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=$.NONE,this._blendEq=!1,this.map=[],this.map[kg]=this.setBlend,this.map[Og]=this.setOffset,this.map[Lg]=this.setCullFace,this.map[Ng]=this.setDepthTest,this.map[Ug]=this.setFrontFace,this.map[Gg]=this.setDepthMask,this.checks=[],this.defaultState=new Qe,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=Bg(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(Fa.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(Fa.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Gh=Fa;Gh.extension={type:L.RendererSystem,name:"state"};z.add(Gh);class id extends Vs{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),s=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of s)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ie(e)})}addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(t,e){const s=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=s.find(o=>this._systemsHash[o]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Pn=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=Pn.defaultMaxIdle,this.checkCountMax=Pn.defaultCheckCountMax,this.mode=Pn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==_o.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let s=0;s<t.length;s++){const r=t[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(i.destroyTexture(r,!0),t[s]=null,e=!0)}if(e){let s=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[s++]=t[r]);t.length=s}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let s=i.children.length-1;s>=0;s--)this.unload(i.children[s])}destroy(){this.renderer=null}};let fe=Pn;fe.defaultMode=_o.AUTO;fe.defaultMaxIdle=60*60;fe.defaultCheckCountMax=60*10;fe.extension={type:L.RendererSystem,name:"textureGC"};z.add(fe);class In{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=V.UNSIGNED_BYTE,this.internalFormat=F.RGBA,this.samplerType=0}}function zg(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[V.UNSIGNED_BYTE]:{[F.RGBA]:i.RGBA8,[F.RGB]:i.RGB8,[F.RG]:i.RG8,[F.RED]:i.R8,[F.RGBA_INTEGER]:i.RGBA8UI,[F.RGB_INTEGER]:i.RGB8UI,[F.RG_INTEGER]:i.RG8UI,[F.RED_INTEGER]:i.R8UI,[F.ALPHA]:i.ALPHA,[F.LUMINANCE]:i.LUMINANCE,[F.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[V.BYTE]:{[F.RGBA]:i.RGBA8_SNORM,[F.RGB]:i.RGB8_SNORM,[F.RG]:i.RG8_SNORM,[F.RED]:i.R8_SNORM,[F.RGBA_INTEGER]:i.RGBA8I,[F.RGB_INTEGER]:i.RGB8I,[F.RG_INTEGER]:i.RG8I,[F.RED_INTEGER]:i.R8I},[V.UNSIGNED_SHORT]:{[F.RGBA_INTEGER]:i.RGBA16UI,[F.RGB_INTEGER]:i.RGB16UI,[F.RG_INTEGER]:i.RG16UI,[F.RED_INTEGER]:i.R16UI,[F.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[V.SHORT]:{[F.RGBA_INTEGER]:i.RGBA16I,[F.RGB_INTEGER]:i.RGB16I,[F.RG_INTEGER]:i.RG16I,[F.RED_INTEGER]:i.R16I},[V.UNSIGNED_INT]:{[F.RGBA_INTEGER]:i.RGBA32UI,[F.RGB_INTEGER]:i.RGB32UI,[F.RG_INTEGER]:i.RG32UI,[F.RED_INTEGER]:i.R32UI,[F.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[V.INT]:{[F.RGBA_INTEGER]:i.RGBA32I,[F.RGB_INTEGER]:i.RGB32I,[F.RG_INTEGER]:i.RG32I,[F.RED_INTEGER]:i.R32I},[V.FLOAT]:{[F.RGBA]:i.RGBA32F,[F.RGB]:i.RGB32F,[F.RG]:i.RG32F,[F.RED]:i.R32F,[F.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[V.HALF_FLOAT]:{[F.RGBA]:i.RGBA16F,[F.RGB]:i.RGB16F,[F.RG]:i.RG16F,[F.RED]:i.R16F},[V.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:i.RGB565},[V.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:i.RGBA4},[V.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:i.RGB5_A1},[V.UNSIGNED_INT_2_10_10_10_REV]:{[F.RGBA]:i.RGB10_A2,[F.RGBA_INTEGER]:i.RGB10_A2UI},[V.UNSIGNED_INT_10F_11F_11F_REV]:{[F.RGB]:i.R11F_G11F_B10F},[V.UNSIGNED_INT_5_9_9_9_REV]:{[F.RGB]:i.RGB9_E5},[V.UNSIGNED_INT_24_8]:{[F.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[V.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[F.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[V.UNSIGNED_BYTE]:{[F.RGBA]:i.RGBA,[F.RGB]:i.RGB,[F.ALPHA]:i.ALPHA,[F.LUMINANCE]:i.LUMINANCE,[F.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[V.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:i.RGB},[V.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:i.RGBA},[V.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:i.RGBA}},t}class zh{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Y,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=zg(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new In(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new In(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),s[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[r].samplerType!==Gn.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new In(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var s;e.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===V.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const s=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(s,t,e))e.samplerType!==Gn.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=s.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&$i(this.managedTextures,r,1)}}updateTextureStyle(t){var s;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Oe.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=We.CLAMP:e.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const s=this.gl;if(e.mipmap&&t.mipmap!==Oe.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Re.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===Re.LINEAR){const n=Math.min(t.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Re.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===Re.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}zh.extension={type:L.RendererSystem,name:"texture"};z.add(zh);class Hh{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:s,renderer:r}=this;e&&r.shader.bind(e),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:s,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(s.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const s=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}s&&(e||r.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Hh.extension={type:L.RendererSystem,name:"transformFeedback"};z.add(Hh);class jr{constructor(t){this.renderer=t}init(t){this.screen=new Z(0,0,t.width,t.height),this.element=t.view||B.ADAPTER.createCanvas(),this.resolution=t.resolution||B.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}jr.defaultOptions={width:800,height:600,resolution:B.RESOLUTION,autoDensity:!1};jr.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_view"};z.add(jr);B.PREFER_ENV=Si.WEBGL2;B.STRICT_TEXTURE_CACHE=!1;B.RENDER_OPTIONS={...Xr.defaultOptions,...$r.defaultOptions,...jr.defaultOptions,...Wr.defaultOptions};Object.defineProperties(B,{WRAP_MODE:{get(){return Y.defaultOptions.wrapMode},set(i){j("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Y.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return Y.defaultOptions.scaleMode},set(i){j("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Y.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return Y.defaultOptions.mipmap},set(i){j("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Y.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return Y.defaultOptions.anisotropicLevel},set(i){j("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Y.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return j("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Q.defaultResolution},set(i){Q.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return j("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Q.defaultMultisample},set(i){Q.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return de.defaultMaxTextures},set(i){j("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),de.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return de.defaultBatchSize},set(i){j("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),de.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return de.canUploadSameBuffer},set(i){j("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),de.canUploadSameBuffer=i}},GC_MODE:{get(){return fe.defaultMode},set(i){j("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),fe.defaultMode=i}},GC_MAX_IDLE:{get(){return fe.defaultMaxIdle},set(i){j("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),fe.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return fe.defaultCheckCountMax},set(i){j("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),fe.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return ge.defaultVertexPrecision},set(i){j("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ge.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return ge.defaultFragmentPrecision},set(i){j("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ge.defaultFragmentPrecision=i}}});var li=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(li||{});class Zo{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Kt=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Zo(null,null,1/0),this.deltaMS=1/Kt.targetFPMS,this.elapsedMS=1/Kt.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=li.NORMAL){return this._addListener(new Zo(i,t,e))}addOnce(i,t,e=li.NORMAL){return this._addListener(new Zo(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=i-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=i-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Kt.targetFPMS;const e=this._head;let s=e.next;for(;s;)s=s.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,Kt.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Kt._shared){const i=Kt._shared=new Kt;i.autoStart=!0,i._protected=!0}return Kt._shared}static get system(){if(!Kt._system){const i=Kt._system=new Kt;i.autoStart=!0,i._protected=!0}return Kt._system}};let vt=Kt;vt.targetFPMS=.06;Object.defineProperties(B,{TARGET_FPMS:{get(){return vt.targetFPMS},set(i){j("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),vt.targetFPMS=i}}});class Vh{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,li.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?vt.shared:new vt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Vh.extension=L.Application;z.add(Vh);const sd=[];z.handleByList(L.Renderer,sd);function rd(i){for(const t of sd)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var Hg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Vg=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const nd=Hg,$h=Vg;class Xh{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}e>=xt.HIGH?this.multisample=xt.HIGH:e>=xt.MEDIUM?this.multisample=xt.MEDIUM:e>=xt.LOW?this.multisample=xt.LOW:this.multisample=xt.NONE}destroy(){}}Xh.extension={type:L.RendererSystem,name:"_multisample"};z.add(Xh);class $g{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Wh{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,s.bindBufferBase(s.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,s){const{gl:r,CONTEXT_UID:n}=this;s=s||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,s*256,256)}update(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),s&&(e||r.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:s}=this;return t._glBuffers[e]=new $g(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Wh.extension={type:L.RendererSystem,name:"buffer"};z.add(Wh);class jh{constructor(t){this.renderer=t}render(t,e){const s=this.renderer;let r,n,o,a;if(e&&(r=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(r||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(n??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),r&&(e.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}jh.extension={type:L.RendererSystem,name:"objectRenderer"};z.add(jh);const Ba=class extends id{constructor(i){super(),this.type=gh.WEBGL,i=Object.assign({},B.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ye({projectionMatrix:new ot},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ba.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&(j("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha),this._plugin.rendererPlugins=Ba.__plugins,this.options=i,this.startup.run(this.options)}static test(i){return i!=null&&i.forceCanvas?!1:yc()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return j("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return j("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return j("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return j("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){j("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return j("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(i){j("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return j("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let ss=Ba;ss.extension={type:L.Renderer,priority:1};ss.__plugins={};ss.__systems={};z.handleByMap(L.RendererPlugin,ss.__plugins);z.handleByMap(L.RendererSystem,ss.__systems);z.add(ss);class Yh extends Rs{constructor(t,e){const{width:s,height:r}=e||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new Y;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof Rs?this.addResourceAt(t[s],s):this.addResourceAt(bh(t[s],e),s))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(e).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class od extends Yh{constructor(t,e){const{width:s,height:r}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:s,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Vi.TEXTURE_2D_ARRAY}upload(t,e,s){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;s.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,e.format,s.type,null);for(let h=0;h<r;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,s.type,l.resource.source))}return!0}}class ad extends hi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const sr=class extends Yh{constructor(i,t){const{width:e,height:s,autoLoad:r,linkBaseTexture:n}=t||{};if(i&&i.length!==sr.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:s});for(let o=0;o<sr.SIDES;o++)this.items[o].target=Vi.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,i&&this.initFromArray(i,t),r!==!1&&this.load()}bind(i){super.bind(i),i.target=Vi.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=Vi.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const s=this.itemDirtyIds;for(let r=0;r<sr.SIDES;r++){const n=this.items[r];(s[r]<n.dirtyId||e.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(i,n,e),s[r]=n.dirtyId):s[r]<-1&&(i.gl.texImage2D(n.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),s[r]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===sr.SIDES}};let qh=sr;qh.SIDES=6;class Gi extends hi{constructor(t,e){e=e||{};let s,r;typeof t=="string"?(s=Gi.EMPTY,r=t):(s=t,r=null),super(s),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const s=await B.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===we.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(s){if(this.destroyed)return;e(s),this.onError.emit(s)}}),this._load)}upload(t,e,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Gi._EMPTY=Gi._EMPTY??B.ADAPTER.createCanvas(0,0),Gi._EMPTY}}const Rn=class extends hi{constructor(i,t){t=t||{},super(B.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},Rn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;hi.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),s=Math.round(s),r=Math.round(r);const n=this.source;n.width=s,n.height=r,n._pixiId=`canvas_${wi()}`,n.getContext("2d").drawImage(i,0,0,t,e,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(i){const t=Rn.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&Rn.SVG_XML.test(i)}};let Ds=Rn;Ds.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Ds.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const ka=class extends hi{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const s=i[0].src||i[0];hi.crossOrigin(e,s,t.crossorigin);for(let r=0;r<i.length;++r){const n=document.createElement("source");let{src:o,mime:a}=i[r];o=o||i[r];const h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||ka.MIME_TYPES[l]||`video/${l}`,n.src=o,n.type=a,e.appendChild(n)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=vt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(vt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(vt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(vt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(vt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(vt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||ka.TYPES.includes(t)}};let So=ka;So.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];So.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};$n.push(Gi,Ah,ad,So,Ds,$s,qh,od);class Xg{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new ie("disposeTransformFeedback")}bindBuffer(t,e){this.buffers[t]=e}destroy(){this.disposeRunner.emit(this,!1)}}const Wg="7.2.4",uu={loader:L.LoadParser,resolver:L.ResolveParser,cache:L.CacheParser,detection:L.DetectionParser};z.handle(L.Asset,i=>{const t=i.ref;Object.entries(uu).filter(([e])=>!!t[e]).forEach(([e,s])=>z.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(uu).filter(e=>!!t[e]).forEach(e=>z.remove(t[e]))});class jg{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Xs(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function Pi(i,t){const e=i.split("?")[0],s=Bt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const je=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i),Yn=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i};function hd(i,t,e,s,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?hd(i.replace(s[e],a),t,e+1,s,r):r.push(i.replace(s[e],a))}}function ld(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),hd(i,r,0,e,s)}else s.push(i);return s}const Tr=i=>!Array.isArray(i);class Yg{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=je(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(s,e);break}}r||(r={},s.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:s};if(s.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof N){const a=e;s.forEach(h=>{a.baseTexture!==N.EMPTY.baseTexture&&Y.addToCache(a.baseTexture,h),N.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const ps=new Yg;let qg=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var o,a;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),s.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,s.parser=l)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},n=Tr(t),o=je(t,l=>({src:l})),a=o.length,h=o.map(async l=>{const u=Bt.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,l)),r[l.src]=await this.promiseCache[u].promise,e&&e(++s/a)}catch(c){throw delete this.promiseCache[u],delete r[l.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const s=je(t,r=>({src:r})).map(async r=>{var a,h;const n=Bt.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}};var Le=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Le||{});const Kg=".json",Zg="application/json",ud={extension:{type:L.LoadParser,priority:Le.Low},name:"loadJson",test(i){return Xs(i,Zg)||Pi(i,Kg)},async load(i){return await(await B.ADAPTER.fetch(i)).json()}};z.add(ud);const Qg=".txt",Jg="text/plain",cd={name:"loadTxt",extension:{type:L.LoadParser,priority:Le.Low},test(i){return Xs(i,Jg)||Pi(i,Qg)},async load(i){return await(await B.ADAPTER.fetch(i)).text()}};z.add(cd);const t_=["normal","bold","100","200","300","400","500","600","700","800","900"],e_=[".ttf",".otf",".woff",".woff2"],i_=["font/ttf","font/otf","font/woff","font/woff2"],s_=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function dd(i){const t=Bt.extname(i),r=Bt.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let n=r.length>0;for(const a of r)if(!a.match(s_)){n=!1;break}let o=r.join(" ");return n||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const fd={extension:{type:L.LoadParser,priority:Le.Low},name:"loadWebFont",test(i){return Xs(i,i_)||Pi(i,e_)},async load(i,t){var s,r,n;const e=B.ADAPTER.getFontFaceSet();if(e){const o=[],a=((s=t.data)==null?void 0:s.family)??dd(i),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(u=>t_.includes(u)))??["normal"],l=t.data??{};for(let u=0;u<h.length;u++){const c=h[u],d=new FontFace(a,`url(${encodeURI(i)})`,{...l,weight:c});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>B.ADAPTER.getFontFaceSet().delete(t))}};z.add(fd);let cu=0,Qo;const r_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",n_={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${r_}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},o_={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Jo;class a_{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([n_.code],{type:"application/javascript"})),s=new Worker(e);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Qo===void 0&&(Qo=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Qo&&(Jo||(Jo=URL.createObjectURL(new Blob([o_.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Jo),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[cu]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:cu++,id:s})}}const du=new a_;function Yr(i,t,e){const s=new N(i);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),s}const h_=[".jpeg",".jpg",".png",".webp",".avif"],l_=["image/jpeg","image/png","image/webp","image/avif"];async function pd(i){const t=await B.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const qr={name:"loadTextures",extension:{type:L.LoadParser,priority:Le.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return Xs(i,l_)||Pi(i,h_)},async load(i,t,e){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await du.isImageBitmapSupported()?s=await du.loadImageBitmap(i):s=await pd(i):s=await new Promise(n=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?n(s):s.onload=()=>{n(s)}});const r=new Y(s,{resolution:oi(i),...t.data});return r.resource.src=i,Yr(r,e,i)},unload(i){i.destroy(!0)}};z.add(qr);const u_=".svg",c_="image/svg+xml",md={extension:{type:L.LoadParser,priority:Le.High},name:"loadSVG",test(i){return Xs(i,c_)||Pi(i,u_)},async testParse(i){return Ds.test(i)},async parse(i,t,e){var o;const s=new Ds(i,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions);await s.load();const r=new Y(s,{resolution:oi(i),...t==null?void 0:t.data});return r.resource.src=i,Yr(r,e,i)},async load(i,t){return(await B.ADAPTER.fetch(i)).text()},unload:qr.unload};z.add(md);class d_{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(t,r.name);s.push(n),this.add([r.name,n],r.srcs,r.data)}else{const n=r.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{s.push(o)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(e).forEach(r=>{s.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=s}add(t,e,s){const r=je(t);r.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=ld(e):e=[e]);const n=e.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){const u=this._parsers[l];if(u.test(o)){a=u.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=Bt.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??s,a});r.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const e=Tr(t);t=je(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}s[r]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=Tr(t);t=je(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(l=>{const u=n.filter(c=>c[h]?c[h]===l:!1);u.length&&(n=u)})}),this._resolverHash[r]=n[0]??a}else{let n=r;(this._basePath||this._rootPath)&&(n=Bt.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class gd{constructor(){this._detections=[],this._initialized=!1,this.resolver=new d_,this.loader=new qg,this.cache=ps,this._backgroundLoader=new jg(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,s){this.resolver.add(t,e,s)}async load(t,e){this._initialized||await this.init();const s=Tr(t),r=je(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},u=o.map(c=>{const d=r[c];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[c]=f})});return await Promise.all(u),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return ps.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=ps.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const l=n[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[r[h]]=l,ps.set(u,l)}),o}async unload(t){this._initialized||await this.init();const e=je(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=je(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{ps.remove(s.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return qr.config.preferWorkers}set preferWorkers(t){j("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const zi=new gd;z.handleByList(L.LoadParser,zi.loader.parsers).handleByList(L.ResolveParser,zi.resolver.parsers).handleByList(L.CacheParser,zi.cache.parsers).handleByList(L.DetectionParser,zi.detections);const _d={extension:L.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof N),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,n)=>{e[s+(n===0?"":n+1)]=r})}),e}};z.add(_d);const xd={extension:{type:L.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await B.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};z.add(xd);const vd={extension:{type:L.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await B.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};z.add(vd);const fu=["png","jpg","jpeg"],yd={extension:{type:L.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...fu],remove:async i=>i.filter(t=>!fu.includes(t))};z.add(yd);const bd={extension:L.ResolveParser,test:qr.test,parse:i=>{var t;return{resolution:parseFloat(((t=B.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};z.add(bd);class Er{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Z.EMPTY:(t=t||new Z(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:s,b:r,c:n,d:o,tx:a,ty:h}=t,l=s*e.x+n*e.y+a,u=r*e.x+o*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,s=this.minY,r=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[2],a=t[3],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[4],a=t[5],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[6],a=t[7],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,this.minX=e,this.minY=s,this.maxX=r,this.maxY=n}addFrame(t,e,s,r,n){this.addFrameMatrix(t.worldTransform,e,s,r,n)}addFrameMatrix(t,e,s,r,n){const o=t.a,a=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*e+h*s+u,x=a*e+l*s+c;d=g<d?g:d,f=x<f?x:f,p=g>p?g:p,m=x>m?x:m,g=o*r+h*s+u,x=a*r+l*s+c,d=g<d?g:d,f=x<f?x:f,p=g>p?g:p,m=x>m?x:m,g=o*e+h*n+u,x=a*e+l*n+c,d=g<d?g:d,f=x<f?x:f,p=g>p?g:p,m=x>m?x:m,g=o*r+h*n+u,x=a*r+l*n+c,d=g<d?g:d,f=x<f?x:f,p=g>p?g:p,m=x>m?x:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(t,e,s){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=e;h<s;h+=2){const l=t[h],u=t[h+1];r=l<r?l:r,n=u<n?u:n,o=l>o?l:o,a=u>a?u:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,e,s,r){this.addVerticesMatrix(t.worldTransform,e,s,r)}addVerticesMatrix(t,e,s,r,n=0,o=n){const a=t.a,h=t.b,l=t.c,u=t.d,c=t.tx,d=t.ty;let f=this.minX,p=this.minY,m=this.maxX,g=this.maxY;for(let x=s;x<r;x+=2){const v=e[x],_=e[x+1],y=a*v+l*_+c,b=u*_+h*v+d;f=Math.min(f,y-n),m=Math.max(m,y+n),p=Math.min(p,b-o),g=Math.max(g,b+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=g}addBounds(t){const e=this.minX,s=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const s=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(s<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=s<a?s:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const s=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(s<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=s<a?s:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,s,r,n,o){t-=n,e-=o,s+=n,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class lt extends Vs{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Hr,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Er,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let s=0;s<e.length;++s){const r=e[s];Object.defineProperty(lt.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Z),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Er);const e=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=s,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,e,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,s,r){return e&&(t=e.toGlobal(t,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,s=1,r=1,n=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=s||1,this.scale.y=r||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new wd),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Fc}set angle(t){this.transform.rotation=t*Ms}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class wd extends lt{constructor(){super(...arguments),this.sortDirty=null}}lt.prototype.displayObjectUpdateTransform=lt.prototype.updateTransform;const f_=new ot;function p_(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const Oa=class extends lt{constructor(){super(),this.children=[],this.sortableChildren=Oa.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.addChild(i[t]);else{const t=i[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return i[0]}addChildAt(i,t){if(t<0||t>this.children.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(t,0,i),this._boundsID++,this.onChildrenChange(t),i.emit("added",this),this.emit("childAdded",i,this,t),i}swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i,this.onChildrenChange(e<s?e:s)}getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(i);$i(this.children,e,1),this.children.splice(t,0,i),this.onChildrenChange(t)}getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.removeChild(i[t]);else{const t=i[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,$i(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return i[0]}removeChildAt(i){const t=this.getChildAt(i);return t.parent=null,t.transform._parentID=-1,$i(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i),t}removeChildren(i=0,t=this.children.length){const e=i,s=t,r=s-e;let n;if(r>0&&r<=s){n=this.children.splice(e,r);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let t=0,e=this.children.length;t<e;++t){const s=this.children[t];s._lastSortedIndex=t,!i&&s.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort(p_),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,t=this.children.length;i<t;++i){const e=this.children[i];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){const t=this.children[i];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(i,t=!1){const e=super.getLocalBounds(i);if(!t)for(let s=0,r=this.children.length;s<r;++s){const n=this.children[s];n.visible&&n.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(i){const t=i.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,s;this.cullArea?(e=this.cullArea,s=this.worldTransform):this._render!==Oa.prototype._render&&(e=this.getBounds(!0));const r=i.projection.transform;if(r&&(s?(s=f_.copyFrom(s),s.prepend(r)):s=r),e&&t.intersects(e,s))this._render(i);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){const a=this.children[n],h=a.cullable;a.cullable=h||!this.cullArea,a.render(i),a.cullable=h}}render(i){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let e=0,s=this.children.length;e<s;++e)this.children[e].render(i)}}renderAdvanced(i){var r,n,o;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const s=t&&((r=this._enabledFilters)==null?void 0:r.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==wt.NONE));if(s&&i.batch.flush(),t&&((n=this._enabledFilters)!=null&&n.length)&&i.filter.push(this,this._enabledFilters),e&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let a=0,h=this.children.length;a<h;++a)this.children[a].render(i)}s&&i.batch.flush(),e&&i.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;const t=typeof i=="boolean"?i:i==null?void 0:i.children,e=this.removeChildren(0,this.children.length);if(t)for(let s=0;s<e.length;++s)e[s].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){const t=this.getLocalBounds().width;t!==0?this.scale.x=i/t:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){const t=this.getLocalBounds().height;t!==0?this.scale.y=i/t:this.scale.y=1,this._height=i}};let Ut=Oa;Ut.defaultSortableChildren=!1;Ut.prototype.containerUpdateTransform=Ut.prototype.updateTransform;Object.defineProperties(B,{SORTABLE_CHILDREN:{get(){return Ut.defaultSortableChildren},set(i){j("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ut.defaultSortableChildren=i}}});const Qs=new K,m_=new Uint16Array([0,1,2,0,2,3]);class Je extends Ut{constructor(t){super(),this._anchor=new $e(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new tt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=$.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||N.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=m_,this.pluginName="batch",this.isSprite=!0,this._roundPixels=B.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ni(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ni(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,s=e.a,r=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this.vertexData,u=t.trim,c=t.orig,d=this._anchor;let f=0,p=0,m=0,g=0;if(u?(p=u.x-d._x*c.width,f=p+u.width,g=u.y-d._y*c.height,m=g+u.height):(p=-d._x*c.width,f=p+c.width,g=-d._y*c.height,m=g+c.height),l[0]=s*p+n*g+a,l[1]=o*g+r*p+h,l[2]=s*f+n*g+a,l[3]=o*g+r*f+h,l[4]=s*f+n*m+a,l[5]=o*m+r*f+h,l[6]=s*p+n*m+a,l[7]=o*m+r*p+h,this._roundPixels){const x=B.RESOLUTION;for(let v=0;v<l.length;++v)l[v]=Math.round(l[v]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,s=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,l=n.d,u=n.tx,c=n.ty,d=-r._x*s.width,f=d+s.width,p=-r._y*s.height,m=p+s.height;e[0]=o*d+h*p+u,e[1]=l*p+a*d+c,e[2]=o*f+h*p+u,e[3]=l*p+a*f+c,e[4]=o*f+h*m+u,e[5]=l*m+a*f+c,e[6]=o*d+h*m+u,e[7]=l*m+a*d+c}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Er),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Qs);const e=this._texture.orig.width,s=this._texture.orig.height,r=-e*this.anchor.x;let n=0;return Qs.x>=r&&Qs.x<r+e&&(n=-s*this.anchor.y,Qs.y>=n&&Qs.y<n+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(t,e){const s=t instanceof N?t:N.from(t,e);return new Je(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=ni(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=ni(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||N.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Td=new ot;lt.prototype._cacheAsBitmap=!1;lt.prototype._cacheData=null;lt.prototype._cacheAsBitmapResolution=null;lt.prototype._cacheAsBitmapMultisample=null;class g_{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(lt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new g_),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});lt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};lt.prototype._initCachedDisplayObject=function(t){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const s=this.getLocalBounds(null,!0).clone();if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;s.pad(p)}s.ceil(B.RESOLUTION);const r=t.renderTexture.current,n=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,h=Ci.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),l=`cacheAsBitmap_${wi()}`;this._cacheData.textureCacheId=l,Y.addToCache(h.baseTexture,l),N.addToCache(h,l);const u=this.transform.localTransform.copyTo(Td).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:h,clear:!0,transform:u,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(r,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const c=new Je(h);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(s.x/s.width),c.anchor.y=-(s.y/s.height),c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)};lt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};lt.prototype._initCachedDisplayObjectCanvas=function(t){var u;if((u=this._cacheData)!=null&&u.sprite)return;const e=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,n=t._projTransform;e.ceil(B.RESOLUTION);const o=Ci.create({width:e.width,height:e.height}),a=`cacheAsBitmap_${wi()}`;this._cacheData.textureCacheId=a,Y.addToCache(o.baseTexture,a),N.addToCache(o,a);const h=Td;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=e.x,h.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const l=new Je(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(e.x/e.width),l.anchor.y=-(e.y/e.height),l.alpha=s,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};lt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};lt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};lt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Y.removeFromCache(this._cacheData.textureCacheId),N.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};lt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};lt.prototype.name=null;Ut.prototype.getChildByName=function(t,e){for(let s=0,r=this.children.length;s<r;s++)if(this.children[s].name===t)return this.children[s];if(e)for(let s=0,r=this.children.length;s<r;s++){const n=this.children[s];if(!n.getChildByName)continue;const o=n.getChildByName(t,!0);if(o)return o}return null};lt.prototype.getGlobalPosition=function(t=new K,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var __=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class Ed extends Q{constructor(t=1){super(nd,__,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const x_={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},v_=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function y_(i){const t=x_[i],e=t.length;let s=v_,r="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<i;a++){let h=n.replace("%index%",a.toString());o=a,a>=e&&(o=i-a-1),h=h.replace("%value%",t[o].toString()),r+=h,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",i.toString()),s}const b_=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function w_(i,t){const e=Math.ceil(i/2);let s=b_,r="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<i;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(e-1)}.0`),r+=a,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",i.toString()),s}class qn extends Q{constructor(t,e=8,s=4,r=Q.defaultResolution,n=5){const o=w_(n,t),a=y_(n);super(o,a),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=s,this.blur=e}apply(t,e,s,r){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/e.width):this.uniforms.strength=1/s.height*(s.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,s,r);else{const n=t.getFilterTexture(),o=t.renderer;let a=e,h=n;this.state.blend=!1,t.applyFilter(this,a,h,Pe.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,Pe.BLIT),this.uniforms.uSampler=h;const u=h;h=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,s,r),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Ad extends Q{constructor(t=8,e=4,s=Q.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new qn(!0,t,e,s,r),this.blurYFilter=new qn(!1,t,e,s,r),this.resolution=s,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,s,r){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,Pe.CLEAR),this.blurYFilter.apply(t,a,s,r),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,s,r):this.blurXFilter.apply(t,e,s,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var T_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Kn extends Q{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super($h,T_,t),this.alpha=1}_loadMatrix(t,e=!1){let s=t;e&&(this._multiply(s,this.uniforms.m,t),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(t,e,s){return t[0]=e[0]*s[0]+e[1]*s[5]+e[2]*s[10]+e[3]*s[15],t[1]=e[0]*s[1]+e[1]*s[6]+e[2]*s[11]+e[3]*s[16],t[2]=e[0]*s[2]+e[1]*s[7]+e[2]*s[12]+e[3]*s[17],t[3]=e[0]*s[3]+e[1]*s[8]+e[2]*s[13]+e[3]*s[18],t[4]=e[0]*s[4]+e[1]*s[9]+e[2]*s[14]+e[3]*s[19]+e[4],t[5]=e[5]*s[0]+e[6]*s[5]+e[7]*s[10]+e[8]*s[15],t[6]=e[5]*s[1]+e[6]*s[6]+e[7]*s[11]+e[8]*s[16],t[7]=e[5]*s[2]+e[6]*s[7]+e[7]*s[12]+e[8]*s[17],t[8]=e[5]*s[3]+e[6]*s[8]+e[7]*s[13]+e[8]*s[18],t[9]=e[5]*s[4]+e[6]*s[9]+e[7]*s[14]+e[8]*s[19]+e[9],t[10]=e[10]*s[0]+e[11]*s[5]+e[12]*s[10]+e[13]*s[15],t[11]=e[10]*s[1]+e[11]*s[6]+e[12]*s[11]+e[13]*s[16],t[12]=e[10]*s[2]+e[11]*s[7]+e[12]*s[12]+e[13]*s[17],t[13]=e[10]*s[3]+e[11]*s[8]+e[12]*s[13]+e[13]*s[18],t[14]=e[10]*s[4]+e[11]*s[9]+e[12]*s[14]+e[13]*s[19]+e[14],t[15]=e[15]*s[0]+e[16]*s[5]+e[17]*s[10]+e[18]*s[15],t[16]=e[15]*s[1]+e[16]*s[6]+e[17]*s[11]+e[18]*s[16],t[17]=e[15]*s[2]+e[16]*s[7]+e[17]*s[12]+e[18]*s[17],t[18]=e[15]*s[3]+e[16]*s[8]+e[17]*s[13]+e[18]*s[18],t[19]=e[15]*s[4]+e[16]*s[9]+e[17]*s[14]+e[18]*s[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}tint(t,e){const[s,r,n]=tt.shared.setValue(t).toArray(),o=[s,0,0,0,0,0,r,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const s=Math.cos(t),r=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),h=s+(1-s)*o,l=o*(1-s)-a*r,u=o*(1-s)+a*r,c=o*(1-s)+a*r,d=s+o*(1-s),f=o*(1-s)-a*r,p=o*(1-s)-a*r,m=o*(1-s)+a*r,g=s+o*(1-s),x=[h,l,u,0,0,c,d,f,0,0,p,m,g,0,0,0,0,0,1,0];this._loadMatrix(x,e)}contrast(t,e){const s=(t||0)+1,r=-.5*(s-1),n=[s,0,0,0,r,0,s,0,0,r,0,0,s,0,r,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const s=t*2/3+1,r=(s-1)*-.5,n=[s,r,r,0,0,r,s,r,0,0,r,r,s,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,s,r,n){t=t||.2,e=e||.15,s=s||16770432,r=r||3375104;const o=tt.shared,[a,h,l]=o.setValue(s).toArray(),[u,c,d]=o.setValue(r).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,u,c,d,e,0,a-u,h-c,l-d,0,0];this._loadMatrix(f,n)}night(t,e){t=t||.1;const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,e)}predator(t,e){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Kn.prototype.grayscale=Kn.prototype.greyscale;var E_=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,A_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class Sd extends Q{constructor(t,e){const s=new ot;t.renderable=!1,super(A_,E_,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=s,e==null&&(e=20),this.scale=new K(e,e)}apply(t,e,s,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,s,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var S_=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,C_=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Cd extends Q{constructor(){super(C_,S_)}}var P_=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Pd extends Q{constructor(t=.5,e=Math.random()){super($h,P_,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const La={AlphaFilter:Ed,BlurFilter:Ad,BlurFilterPass:qn,ColorMatrixFilter:Kn,DisplacementFilter:Sd,FXAAFilter:Cd,NoiseFilter:Pd};Object.entries(La).forEach(([i,t])=>{Object.defineProperty(La,i,{get(){return j("7.1.0",`filters.${i} has moved to ${i}`),t}})});class I_{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(vt.system.add(this.tickerUpdate,this,li.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(vt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const fi=new I_;class Ws{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ws.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new K,this.page=new K,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ar extends Ws{constructor(){super(...arguments),this.client=new K,this.movement=new K,this.offset=new K,this.global=new K,this.screen=new K}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,r,n,o,a,h,l,u,c,d,f,p,m){throw new Error("Method not implemented.")}}class ne extends Ar{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Ji extends Ar{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Ji.DOM_DELTA_PIXEL=0;Ji.DOM_DELTA_LINE=1;Ji.DOM_DELTA_PAGE=2;const R_=2048,M_=new K,ta=new K;class Id{constructor(t){this.dispatch=new Vs,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((s,r)=>s.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,r=e.length;s<r;s++)e[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){fi.pauseUpdate=!0;const r=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[r](this.rootTarget,this.rootTarget.eventMode,M_.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=s.length-1;r<n;r++)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let n=s.length-1;n>=0;n--)r.forEach(o=>{t.currentTarget=s[n],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let s=0;s<R_&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,s,r,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(fi.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let c=u.length-1;c>=0;c--){const d=u[c],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,s,r,n,o||n(t,s));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const h=this._isInteractive(e),l=t.isInteractive();return l&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!n(t,s)&&r(t,s)?l?[t]:[]:null}hitTestRecursive(t,e,s,r,n){if(this._interactivePrune(t)||n(t,s))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(fi.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const u=h[l],c=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,s,r,n);if(c){if(c.length>0&&!c[c.length-1].parent)continue;const d=t.isInteractive();return(c.length>0||d)&&c.push(t),c}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&r(t,s)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var s;if(t.hitArea&&(t.worldTransform.applyInverse(e,ta),!t.hitArea.contains(ta.x,ta.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,o;e=e??t.type;const s=`on${e}`;(o=(n=t.currentTarget)[s])==null||o.call(n,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var h,l;if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.overTargets);if(((h=r.overTargets)==null?void 0:h.length)>0&&n!==e.target){const u=t.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(t,u,n);if(this.dispatchEvent(c,"pointerout"),s&&this.dispatchEvent(c,"mouseout"),!e.composedPath().includes(n)){const d=this.createPointerEvent(t,"pointerleave",n);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),s&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(c)}if(n!==e.target){const u=t.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(e,u);this.dispatchEvent(c,"pointerover"),s&&this.dispatchEvent(c,"mouseover");let d=n==null?void 0:n.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const p=this.clonePointerEvent(e,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==n&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),s&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(c)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(o=s.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.dispatchEvent(s,a?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[t.button]);let o=n;if(n&&!s.composedPath().includes(n)){let a=n;for(;a&&!s.composedPath().includes(a);){if(s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const h=s.button===2;this.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(s,"click");a.target=o,a.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=r.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof ne)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(s){let n=s;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof Ji)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const r=this.allocateEvent(ne);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=s??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(Ji);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(ne);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ne&&e instanceof ne&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Ar&&e instanceof Ar&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const s=t.currentTarget._events[e];if(s&&t.currentTarget.isInteractive())if("fn"in s)s.once&&t.currentTarget.removeListener(e,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let r=0,n=s.length;r<n&&!t.propagationImmediatelyStopped;r++)s[r].once&&t.currentTarget.removeListener(e,s[r].fn,void 0,!0),s[r].fn.call(s[r].context,t)}}const D_=1,F_={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Na=class{constructor(i){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=i,this.rootBoundary=new Id(null),fi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ne(null),this.rootWheelEvent=new Ji(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Na.defaultEventFeatures},{set:(t,e,s)=>(e==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),t[e]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(i){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e,Na._defaultEventMode=i.eventMode??"auto",Object.assign(this.features,i.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(i){this.resolution=i}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(i){i=i||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===i)return;this.currentCursor=i;const e=this.cursorStyles[i];if(e)switch(typeof e){case"string":t&&(this.domElement.style.cursor=e);break;case"function":e(i);break;case"object":t&&Object.assign(this.domElement.style,e);break}else t&&typeof i=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,i)&&(this.domElement.style.cursor=i)}get pointer(){return this.rootPointerEvent}onPointerDown(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;const t=this.normalizeToPointerData(i);this.autoPreventDefault&&t[0].isNormalized&&(i.cancelable||!("cancelable"in i))&&i.preventDefault();for(let e=0,s=t.length;e<s;e++){const r=t[e],n=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(i){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;fi.pointerMoved();const t=this.normalizeToPointerData(i);for(let e=0,s=t.length;e<s;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;let t=i.target;i.composedPath&&i.composedPath().length>0&&(t=i.composedPath()[0]);const e=t!==this.domElement?"outside":"",s=this.normalizeToPointerData(i);for(let r=0,n=s.length;r<n;r++){const o=this.bootstrapEvent(this.rootPointerEvent,s[r]);o.type+=e,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;const t=this.normalizeToPointerData(i);for(let e=0,s=t.length;e<s;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(i){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(i);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(i){this.removeEvents(),this.domElement=i,fi.domElement=i,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;fi.addTickerListener();const i=this.domElement.style;i&&(globalThis.navigator.msPointerEnabled?(i.msContentZooming="none",i.msTouchAction="none"):this.supportsPointerEvents&&(i.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;fi.removeTickerListener();const i=this.domElement.style;globalThis.navigator.msPointerEnabled?(i.msContentZooming="",i.msTouchAction=""):this.supportsPointerEvents&&(i.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(i,t,e){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const r=1/this.resolution;i.x=(t-s.left)*(this.domElement.width/s.width)*r,i.y=(e-s.top)*(this.domElement.height/s.height)*r}normalizeToPointerData(i){const t=[];if(this.supportsTouchEvents&&i instanceof TouchEvent)for(let e=0,s=i.changedTouches.length;e<s;e++){const r=i.changedTouches[e];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=i.touches.length===1&&i.type==="touchstart"),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=i.type,t.push(r)}else if(!globalThis.MouseEvent||i instanceof MouseEvent&&(!this.supportsPointerEvents||!(i instanceof globalThis.PointerEvent))){const e=i;typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=D_),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0,t.push(e)}else t.push(i);return t}normalizeWheelEvent(i){const t=this.rootWheelEvent;return this.transferMouseData(t,i),t.deltaX=i.deltaX,t.deltaY=i.deltaY,t.deltaZ=i.deltaZ,t.deltaMode=i.deltaMode,this.mapPositionToPoint(t.screen,i.clientX,i.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=i,t.type=i.type,t}bootstrapEvent(i,t){return i.originalEvent=null,i.nativeEvent=t,i.pointerId=t.pointerId,i.width=t.width,i.height=t.height,i.isPrimary=t.isPrimary,i.pointerType=t.pointerType,i.pressure=t.pressure,i.tangentialPressure=t.tangentialPressure,i.tiltX=t.tiltX,i.tiltY=t.tiltY,i.twist=t.twist,this.transferMouseData(i,t),this.mapPositionToPoint(i.screen,t.clientX,t.clientY),i.global.copyFrom(i.screen),i.offset.copyFrom(i.screen),i.isTrusted=t.isTrusted,i.type==="pointerleave"&&(i.type="pointerout"),i.type.startsWith("mouse")&&(i.type=i.type.replace("mouse","pointer")),i.type.startsWith("touch")&&(i.type=F_[i.type]||i.type),i}transferMouseData(i,t){i.isTrusted=t.isTrusted,i.srcElement=t.srcElement,i.timeStamp=performance.now(),i.type=t.type,i.altKey=t.altKey,i.button=t.button,i.buttons=t.buttons,i.client.x=t.clientX,i.client.y=t.clientY,i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.movement.x=t.movementX,i.movement.y=t.movementY,i.page.x=t.pageX,i.page.y=t.pageY,i.relatedTarget=null,i.shiftKey=t.shiftKey}};let Fs=Na;Fs.extension={name:"events",type:[L.RendererSystem,L.CanvasRendererSystem]};Fs.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};z.add(Fs);function pu(i){return i==="dynamic"||i==="static"}const Rd={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??pu(Fs.defaultEventMode)},set interactive(i){j("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=i,this.eventMode=i?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Fs.defaultEventMode},set eventMode(i){this._internalInteractive=pu(i),this._internalEventMode=i},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=s?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.on(i,t,r)},removeEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=s?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,r)},dispatchEvent(i){if(!(i instanceof Ws))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};lt.mixin(Rd);const Md={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};lt.mixin(Md);const B_=9,gn=100,k_=0,O_=0,mu=2,gu=1,L_=-1e3,N_=-1e3,U_=2;class Kh{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Me.tablet||Me.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${gn}px`,e.style.height=`${gn}px`,e.style.position="absolute",e.style.top=`${k_}px`,e.style.left=`${O_}px`,e.style.zIndex=mu.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${gu}px`,t.style.height=`${gu}px`,t.style.position="absolute",t.style.top=`${L_}px`,t.style.left=`${N_}px`,t.style.zIndex=U_.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let s=0;s<e.length;s++)this.updateAccessibleObjects(e[s])}update(){const t=performance.now();if(Me.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:s,width:r,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=r/o*h,u=n/a*h;let c=this.div;c.style.left=`${e}px`,c.style.top=`${s}px`,c.style.width=`${o}px`,c.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,$i(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{c=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(c.style.left=`${(m.tx+p.x*m.a)*l}px`,c.style.top=`${(m.ty+p.y*m.d)*u}px`,c.style.width=`${p.width*m.a*l}px`,c.style.height=`${p.height*m.d*u}px`):(p=f.getBounds(),this.capHitArea(p),c.style.left=`${p.x*l}px`,c.style.top=`${p.y*u}px`,c.style.width=`${p.width*l}px`,c.style.height=`${p.height*u}px`,c.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(c.title=f.accessibleTitle),c.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&c.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==c.title||f.tabIndex!==c.tabIndex)&&(c.title=f.accessibleTitle,c.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:s}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>s&&(t.height=s-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${gn}px`,e.style.height=`${gn}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=mu.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:s}=t.target,r=this.renderer.events.rootBoundary,n=Object.assign(new Ws(r),{target:s});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>r.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===B_&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Kh.extension={name:"accessibility",type:[L.RendererPlugin,L.CanvasRendererPlugin]};z.add(Kh);const Ua=class{constructor(i){this.stage=new Ut,i=Object.assign({forceCanvas:!1},i),this.renderer=rd(i),Ua._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(i,t){const e=Ua._plugins.slice(0);e.reverse(),e.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(i),this.renderer=null}};let Co=Ua;Co._plugins=[];z.handleByList(L.Application,Co._plugins);class Zh{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,s;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,s=n}this.renderer.resize(e,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Zh.extension=L.Application;z.add(Zh);var Ht=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i))(Ht||{});const Sr={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let ii,ms;function _u(){ms={s3tc:ii.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ii.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ii.getExtension("WEBGL_compressed_texture_etc"),etc1:ii.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ii.getExtension("WEBGL_compressed_texture_pvrtc")||ii.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ii.getExtension("WEBGL_compressed_texture_atc"),astc:ii.getExtension("WEBGL_compressed_texture_astc")}}const Dd={extension:{type:L.DetectionParser,priority:2},test:async()=>{const t=B.ADAPTER.createCanvas().getContext("webgl");return t?(ii=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{ms||_u();const t=[];for(const e in ms)ms[e]&&t.push(e);return[...t,...i]},remove:async i=>(ms||_u(),i.filter(t=>!(t in ms)))};z.add(Dd);class Fd extends $s{constructor(t,e={width:1,height:1,autoLoad:!0}){let s,r;typeof t=="string"?(s=t,r=new Uint8Array):(s=null,r=t),super(r,e),this.origin=s,this.buffer=r?new Vn(r):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Vn(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class vi extends Fd{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=vi._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||vi._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,s){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){const{levelID:h,levelWidth:l,levelHeight:u,levelBuffer:c}=this._levelBuffers[o];r.compressedTexImage2D(r.TEXTURE_2D,h,this.format,l,u,0,c)}return!0}onBlobLoaded(){this._levelBuffers=vi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,s,r,n,o,a){const h=new Array(s);let l=t.byteOffset,u=o,c=a,d=u+r-1&~(r-1),f=c+n-1&~(n-1),p=d*f*Sr[e];for(let m=0;m<s;m++)h[m]={levelID:m,levelWidth:s>1?u:d,levelHeight:s>1?c:f,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,u=u>>1||1,c=c>>1||1,d=u+r-1&~(r-1),f=c+n-1&~(n-1),p=d*f*Sr[e];return h}}const ea=4,_n=124,G_=32,xu=20,z_=542327876,xn={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},H_={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},vn={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},V_=1,$_=2,X_=4,W_=64,j_=512,Y_=131072,q_=827611204,K_=861165636,Z_=894720068,Q_=808540228,J_=4,t0={[q_]:Ht.COMPRESSED_RGBA_S3TC_DXT1_EXT,[K_]:Ht.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Z_]:Ht.COMPRESSED_RGBA_S3TC_DXT5_EXT},e0={70:Ht.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ht.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ht.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ht.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ht.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ht.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ht.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ht.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ht.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Bd(i){const t=new Uint32Array(i);if(t[0]!==z_)throw new Error("Invalid DDS file magic word");const s=new Uint32Array(i,0,_n/Uint32Array.BYTES_PER_ELEMENT),r=s[xn.HEIGHT],n=s[xn.WIDTH],o=s[xn.MIPMAP_COUNT],a=new Uint32Array(i,xn.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,G_/Uint32Array.BYTES_PER_ELEMENT),h=a[V_];if(h&X_){const l=a[H_.FOURCC];if(l!==Q_){const _=t0[l],y=ea+_n,b=new Uint8Array(i,y);return[new vi(b,{format:_,width:n,height:r,levels:o})]}const u=ea+_n,c=new Uint32Array(t.buffer,u,xu/Uint32Array.BYTES_PER_ELEMENT),d=c[vn.DXGI_FORMAT],f=c[vn.RESOURCE_DIMENSION],p=c[vn.MISC_FLAG],m=c[vn.ARRAY_SIZE],g=e0[d];if(g===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(p===J_)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,v=ea+_n+xu;if(m===1)x.push(new Uint8Array(i,v));else{const _=Sr[g];let y=0,b=n,A=r;for(let w=0;w<o;w++){const E=Math.max(1,b+3&-4),M=Math.max(1,A+3&-4),I=E*M*_;y+=I,b=b>>>1,A=A>>>1}let T=v;for(let w=0;w<m;w++)x.push(new Uint8Array(i,T,y)),T+=y}return x.map(_=>new vi(_,{format:g,width:n,height:r,levels:o}))}throw h&W_?new Error("DDSParser does not support uncompressed texture data."):h&j_?new Error("DDSParser does not supported YUV uncompressed texture data."):h&Y_?new Error("DDSParser does not support single-channel (lumninance) texture data!"):h&$_?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const vu=[171,75,84,88,32,49,49,187,13,10,26,10],i0=67305985,Ee={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Ga=64,za={[V.UNSIGNED_BYTE]:1,[V.UNSIGNED_SHORT]:2,[V.INT]:4,[V.UNSIGNED_INT]:4,[V.FLOAT]:4,[V.HALF_FLOAT]:8},kd={[F.RGBA]:4,[F.RGB]:3,[F.RG]:2,[F.RED]:1,[F.LUMINANCE]:1,[F.LUMINANCE_ALPHA]:2,[F.ALPHA]:1},Od={[V.UNSIGNED_SHORT_4_4_4_4]:2,[V.UNSIGNED_SHORT_5_5_5_1]:2,[V.UNSIGNED_SHORT_5_6_5]:2};function Ld(i,t,e=!1){const s=new DataView(t);if(!s0(i,s))return null;const r=s.getUint32(Ee.ENDIANNESS,!0)===i0,n=s.getUint32(Ee.GL_TYPE,r),o=s.getUint32(Ee.GL_FORMAT,r),a=s.getUint32(Ee.GL_INTERNAL_FORMAT,r),h=s.getUint32(Ee.PIXEL_WIDTH,r),l=s.getUint32(Ee.PIXEL_HEIGHT,r)||1,u=s.getUint32(Ee.PIXEL_DEPTH,r)||1,c=s.getUint32(Ee.NUMBER_OF_ARRAY_ELEMENTS,r)||1,d=s.getUint32(Ee.NUMBER_OF_FACES,r),f=s.getUint32(Ee.NUMBER_OF_MIPMAP_LEVELS,r),p=s.getUint32(Ee.BYTES_OF_KEY_VALUE_DATA,r);if(l===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,x=h+3&-4,v=l+3&-4,_=new Array(c);let y=h*l;n===0&&(y=x*v);let b;if(n!==0?za[n]?b=za[n]*kd[o]:b=Od[n]:b=Sr[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const A=e?n0(s,p,r):null;let w=y*b,E=h,M=l,I=x,D=v,P=Ga+p;for(let S=0;S<f;S++){const O=s.getUint32(P,r);let G=P+4;for(let C=0;C<c;C++){let k=_[C];k||(k=_[C]=new Array(f)),k[S]={levelID:S,levelWidth:f>1||n!==0?E:I,levelHeight:f>1||n!==0?M:D,levelBuffer:new Uint8Array(t,G,w)},G+=w}P+=O+4,P=P%4!==0?P+4-P%4:P,E=E>>1||1,M=M>>1||1,I=E+m-1&~(m-1),D=M+g-1&~(g-1),w=I*D*b}return n!==0?{uncompressed:_.map(S=>{let O=S[0].levelBuffer,G=!1;return n===V.FLOAT?O=new Float32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4):n===V.UNSIGNED_INT?(G=!0,O=new Uint32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4)):n===V.INT&&(G=!0,O=new Int32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4)),{resource:new $s(O,{width:S[0].levelWidth,height:S[0].levelHeight}),type:n,format:G?r0(o):o}}),kvData:A}:{compressed:_.map(S=>new vi(null,{format:a,width:h,height:l,levels:f,levelBuffers:S})),kvData:A}}function s0(i,t){for(let e=0;e<vu.length;e++)if(t.getUint8(e)!==vu[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function r0(i){switch(i){case F.RGBA:return F.RGBA_INTEGER;case F.RGB:return F.RGB_INTEGER;case F.RG:return F.RG_INTEGER;case F.RED:return F.RED_INTEGER;default:return i}}function n0(i,t,e){const s=new Map;let r=0;for(;r<t;){const n=i.getUint32(Ga+r,e),o=Ga+r+4,a=3-(n+3)%4;if(n===0||n>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<n&&i.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=new TextDecoder().decode(new Uint8Array(i.buffer,o,h)),u=new DataView(i.buffer,o+h+1,n-h-1);s.set(l,u),r+=4+n+a}return s}const Nd={extension:{type:L.LoadParser,priority:Le.High},name:"loadDDS",test(i){return Pi(i,".dds")},async load(i,t,e){const r=await(await B.ADAPTER.fetch(i)).arrayBuffer(),o=Bd(r).map(a=>{const h=new Y(a,{mipmap:Oe.OFF,alphaMode:we.NO_PREMULTIPLIED_ALPHA,resolution:oi(i),...t.data});return Yr(h,e,i)});return o.length===1?o[0]:o},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};z.add(Nd);const Ud={extension:{type:L.LoadParser,priority:Le.High},name:"loadKTX",test(i){return Pi(i,".ktx")},async load(i,t,e){const r=await(await B.ADAPTER.fetch(i)).arrayBuffer(),{compressed:n,uncompressed:o,kvData:a}=Ld(i,r),h=n??o,l={mipmap:Oe.OFF,alphaMode:we.NO_PREMULTIPLIED_ALPHA,resolution:oi(i),...t.data},u=h.map(c=>{h===o&&Object.assign(l,{type:c.type,format:c.format});const d=new Y(c,l);return d.ktxKeyValueData=a,Yr(d,e,i)});return u.length===1?u[0]:u},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};z.add(Ud);const Gd={extension:L.ResolveParser,test:i=>{const e=i.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:i=>{var s,r;if(i.split("?")[0].split(".").pop()==="ktx"){const n=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(n.some(o=>i.endsWith(o)))return{resolution:parseFloat(((s=B.RETINA_PREFIX.exec(i))==null?void 0:s[1])??"1"),format:n.find(o=>i.endsWith(o)),src:i}}return{resolution:parseFloat(((r=B.RETINA_PREFIX.exec(i))==null?void 0:r[1])??"1"),format:i.split(".").pop(),src:i}}};z.add(Gd);const o0=new Z,a0=4,rr=class{constructor(i){this.renderer=i}async image(i,t,e){const s=new Image;return s.src=await this.base64(i,t,e),s}async base64(i,t,e){const s=this.canvas(i);if(s.toBlob!==void 0)return new Promise((r,n)=>{s.toBlob(o=>{if(!o){n(new Error("ICanvas.toBlob failed!"));return}const a=new FileReader;a.onload=()=>r(a.result),a.onerror=n,a.readAsDataURL(o)},t,e)});if(s.toDataURL!==void 0)return s.toDataURL(t,e);if(s.convertToBlob!==void 0){const r=await s.convertToBlob({type:t,quality:e});return new Promise((n,o)=>{const a=new FileReader;a.onload=()=>n(a.result),a.onerror=o,a.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(i,t){const{pixels:e,width:s,height:r,flipY:n}=this._rawPixels(i,t);n&&rr._flipY(e,s,r),rr._unpremultiplyAlpha(e);const o=new Pc(s,r,1),a=new ImageData(new Uint8ClampedArray(e.buffer),s,r);return o.context.putImageData(a,0,0),o.canvas}pixels(i,t){const{pixels:e,width:s,height:r,flipY:n}=this._rawPixels(i,t);return n&&rr._flipY(e,s,r),rr._unpremultiplyAlpha(e),e}_rawPixels(i,t){const e=this.renderer;if(!e)throw new Error("The Extract has already been destroyed");let s,r=!1,n,o=!1;if(i&&(i instanceof Ci?n=i:(n=e.generateTexture(i,{resolution:e.resolution,multisample:e.multisample}),o=!0)),n){if(s=n.baseTexture.resolution,t=t??n.frame,r=!1,!o){e.renderTexture.bind(n);const c=n.framebuffer.glFramebuffers[e.CONTEXT_UID];c.blitFramebuffer&&e.framebuffer.bind(c.blitFramebuffer)}}else s=e.resolution,t||(t=o0,t.width=e.width/s,t.height=e.height/s),r=!0,e.renderTexture.bind();const a=Math.round(t.width*s),h=Math.round(t.height*s),l=new Uint8Array(a0*a*h),u=e.gl;return u.readPixels(Math.round(t.x*s),Math.round(t.y*s),a,h,u.RGBA,u.UNSIGNED_BYTE,l),o&&(n==null||n.destroy(!0)),{pixels:l,width:a,height:h,flipY:r}}destroy(){this.renderer=null}static _flipY(i,t,e){const s=t<<2,r=e>>1,n=new Uint8Array(s);for(let o=0;o<r;o++){const a=o*s,h=(e-o-1)*s;n.set(i.subarray(a,a+s)),i.copyWithin(a,h,h+s),i.set(n,h)}}static _unpremultiplyAlpha(i){i instanceof Uint8ClampedArray&&(i=new Uint8Array(i.buffer));const t=i.length;for(let e=0;e<t;e+=4){const s=i[e+3];if(s!==0){const r=255.001/s;i[e]=i[e]*r+.5,i[e+1]=i[e+1]*r+.5,i[e+2]=i[e+2]*r+.5}}}};let Qh=rr;Qh.extension={name:"extract",type:L.RendererSystem};z.add(Qh);const Cr={build(i){const t=i.points;let e,s,r,n,o,a;if(i.type===Rt.CIRC){const p=i.shape;e=p.x,s=p.y,o=a=p.radius,r=n=0}else if(i.type===Rt.ELIP){const p=i.shape;e=p.x,s=p.y,o=p.width,a=p.height,r=n=0}else{const p=i.shape,m=p.width/2,g=p.height/2;e=p.x+m,s=p.y+g,o=a=Math.max(0,Math.min(p.radius,Math.min(m,g))),r=m-o,n=g-a}if(!(o>=0&&a>=0&&r>=0&&n>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(r?4:0)+(n?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=s+n,t[2]=t[4]=e-r,t[5]=t[7]=s-n;return}let u=0,c=h*4+(r?2:0)+2,d=c,f=l;{const p=r+o,m=n,g=e+p,x=e-p,v=s+m;if(t[u++]=g,t[u++]=v,t[--c]=v,t[--c]=x,n){const _=s-m;t[d++]=x,t[d++]=_,t[--f]=_,t[--f]=g}}for(let p=1;p<h;p++){const m=Math.PI/2*(p/h),g=r+Math.cos(m)*o,x=n+Math.sin(m)*a,v=e+g,_=e-g,y=s+x,b=s-x;t[u++]=v,t[u++]=y,t[--c]=y,t[--c]=_,t[d++]=_,t[d++]=b,t[--f]=b,t[--f]=v}{const p=r,m=n+a,g=e+p,x=e-p,v=s+m,_=s-m;t[u++]=g,t[u++]=v,t[--f]=_,t[--f]=g,r&&(t[u++]=x,t[u++]=v,t[--f]=_,t[--f]=x)}},triangulate(i,t){const e=i.points,s=t.points,r=t.indices;if(e.length===0)return;let n=s.length/2;const o=n;let a,h;if(i.type!==Rt.RREC){const u=i.shape;a=u.x,h=u.y}else{const u=i.shape;a=u.x+u.width/2,h=u.y+u.height/2}const l=i.matrix;s.push(i.matrix?l.a*a+l.c*h+l.tx:a,i.matrix?l.b*a+l.d*h+l.ty:h),n++,s.push(e[0],e[1]);for(let u=2;u<e.length;u+=2)s.push(e[u],e[u+1]),r.push(n++,o,n);r.push(o+1,o,n)}};function yu(i,t=!1){const e=i.length;if(e<6)return;let s=0;for(let r=0,n=i[e-2],o=i[e-1];r<e;r+=2){const a=i[r],h=i[r+1];s+=(a-n)*(h+o),n=a,o=h}if(!t&&s>0||t&&s<=0){const r=e/2;for(let n=r+r%2;n<e;n+=2){const o=e-n-2,a=e-n-1,h=n,l=n+1;[i[o],i[h]]=[i[h],i[o]],[i[a],i[l]]=[i[l],i[a]]}}}const Jh={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const s=i.holes,r=t.points,n=t.indices;if(e.length>=6){yu(e,!1);const o=[];for(let l=0;l<s.length;l++){const u=s[l];yu(u.points,!0),o.push(e.length/2),e=e.concat(u.points)}const a=xc(e,o,2);if(!a)return;const h=r.length/2;for(let l=0;l<a.length;l+=3)n.push(a[l]+h),n.push(a[l+1]+h),n.push(a[l+2]+h);for(let l=0;l<e.length;l++)r.push(e[l])}}},zd={build(i){const t=i.shape,e=t.x,s=t.y,r=t.width,n=t.height,o=i.points;o.length=0,r>=0&&n>=0&&o.push(e,s,e+r,s,e+r,s+n,e,s+n)},triangulate(i,t){const e=i.points,s=t.points;if(e.length===0)return;const r=s.length/2;s.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},Hd={build(i){Cr.build(i)},triangulate(i,t){Cr.triangulate(i,t)}};var he=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(he||{}),pi=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(pi||{});const Ti={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},h0=Ti;class Ha{static curveTo(t,e,s,r,n,o){const a=o[o.length-2],l=o[o.length-1]-e,u=a-t,c=r-e,d=s-t,f=Math.abs(l*d-u*c);if(f<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const p=l*l+u*u,m=c*c+d*d,g=l*c+u*d,x=n*Math.sqrt(p)/f,v=n*Math.sqrt(m)/f,_=x*g/p,y=v*g/m,b=x*d+v*u,A=x*c+v*l,T=u*(v+_),w=l*(v+_),E=d*(x+y),M=c*(x+y),I=Math.atan2(w-A,T-b),D=Math.atan2(M-A,E-b);return{cx:b+t,cy:A+e,radius:n,startAngle:I,endAngle:D,anticlockwise:u*c>d*l}}static arc(t,e,s,r,n,o,a,h,l){const u=a-o,c=Ti._segmentsCount(Math.abs(u)*n,Math.ceil(Math.abs(u)/wr)*40),d=u/(c*2),f=d*2,p=Math.cos(d),m=Math.sin(d),g=c-1,x=g%1/g;for(let v=0;v<=g;++v){const _=v+x*v,y=d+o+f*_,b=Math.cos(y),A=-Math.sin(y);l.push((p*b+m*A)*n+s,(p*-A+m*b)*n+r)}}}class Vd{constructor(){this.reset()}begin(t,e,s){this.reset(),this.style=t,this.start=e,this.attribStart=s}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Po{static curveLength(t,e,s,r,n,o,a,h){let u=0,c=0,d=0,f=0,p=0,m=0,g=0,x=0,v=0,_=0,y=0,b=t,A=e;for(let T=1;T<=10;++T)c=T/10,d=c*c,f=d*c,p=1-c,m=p*p,g=m*p,x=g*t+3*m*c*s+3*p*d*n+f*a,v=g*e+3*m*c*r+3*p*d*o+f*h,_=b-x,y=A-v,b=x,A=v,u+=Math.sqrt(_*_+y*y);return u}static curveTo(t,e,s,r,n,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const u=Ti._segmentsCount(Po.curveLength(h,l,t,e,s,r,n,o));let c=0,d=0,f=0,p=0,m=0;a.push(h,l);for(let g=1,x=0;g<=u;++g)x=g/u,c=1-x,d=c*c,f=d*c,p=x*x,m=p*x,a.push(f*h+3*d*x*t+3*c*p*s+m*n,f*l+3*d*x*e+3*c*p*r+m*o)}}function bu(i,t,e,s,r,n,o,a){const h=i-e*r,l=t-s*r,u=i+e*n,c=t+s*n;let d,f;o?(d=s,f=-e):(d=-s,f=e);const p=h+d,m=l+f,g=u+d,x=c+f;return a.push(p,m,g,x),2}function Mi(i,t,e,s,r,n,o,a){const h=e-i,l=s-t;let u=Math.atan2(h,l),c=Math.atan2(r-i,n-t);a&&u<c?u+=Math.PI*2:!a&&u>c&&(c+=Math.PI*2);let d=u;const f=c-u,p=Math.abs(f),m=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,x=f/g;if(d+=x,a){o.push(i,t,e,s);for(let v=1,_=d;v<g;v++,_+=x)o.push(i,t,i+Math.sin(_)*m,t+Math.cos(_)*m);o.push(i,t,r,n)}else{o.push(e,s,i,t);for(let v=1,_=d;v<g;v++,_+=x)o.push(i+Math.sin(_)*m,t+Math.cos(_)*m,i,t);o.push(r,n,i,t)}return g*2}function l0(i,t){const e=i.shape;let s=i.points||e.points.slice();const r=t.closePointEps;if(s.length===0)return;const n=i.lineStyle,o=new K(s[0],s[1]),a=new K(s[s.length-2],s[s.length-1]),h=e.type!==Rt.POLY||e.closeStroke,l=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(h){s=s.slice(),l&&(s.pop(),s.pop(),a.set(s[s.length-2],s[s.length-1]));const C=(o.x+a.x)*.5,k=(a.y+o.y)*.5;s.unshift(C,k),s.push(C,k)}const u=t.points,c=s.length/2;let d=s.length;const f=u.length/2,p=n.width/2,m=p*p,g=n.miterLimit*n.miterLimit;let x=s[0],v=s[1],_=s[2],y=s[3],b=0,A=0,T=-(v-y),w=x-_,E=0,M=0,I=Math.sqrt(T*T+w*w);T/=I,w/=I,T*=p,w*=p;const D=n.alignment,P=(1-D)*2,S=D*2;h||(n.cap===pi.ROUND?d+=Mi(x-T*(P-S)*.5,v-w*(P-S)*.5,x-T*P,v-w*P,x+T*S,v+w*S,u,!0)+2:n.cap===pi.SQUARE&&(d+=bu(x,v,T,w,P,S,!0,u))),u.push(x-T*P,v-w*P,x+T*S,v+w*S);for(let C=1;C<c-1;++C){x=s[(C-1)*2],v=s[(C-1)*2+1],_=s[C*2],y=s[C*2+1],b=s[(C+1)*2],A=s[(C+1)*2+1],T=-(v-y),w=x-_,I=Math.sqrt(T*T+w*w),T/=I,w/=I,T*=p,w*=p,E=-(y-A),M=_-b,I=Math.sqrt(E*E+M*M),E/=I,M/=I,E*=p,M*=p;const k=_-x,X=v-y,R=_-b,H=A-y,q=k*R+X*H,it=X*R-H*k,J=it<0;if(Math.abs(it)<.001*Math.abs(q)){u.push(_-T*P,y-w*P,_+T*S,y+w*S),q>=0&&(n.join===he.ROUND?d+=Mi(_,y,_-T*P,y-w*P,_-E*P,y-M*P,u,!1)+4:d+=2,u.push(_-E*S,y-M*S,_+E*P,y+M*P));continue}const nt=(-T+x)*(-w+y)-(-T+_)*(-w+v),yt=(-E+b)*(-M+y)-(-E+_)*(-M+A),At=(k*yt-R*nt)/it,kt=(H*nt-X*yt)/it,Yt=(At-_)*(At-_)+(kt-y)*(kt-y),Dt=_+(At-_)*P,at=y+(kt-y)*P,bt=_-(At-_)*S,Et=y-(kt-y)*S,Ne=Math.min(k*k+X*X,R*R+H*H),Ue=J?P:S,js=Ne+Ue*Ue*m,Dp=Yt<=js;let en=n.join;if(en===he.MITER&&Yt/m>g&&(en=he.BEVEL),Dp)switch(en){case he.MITER:{u.push(Dt,at,bt,Et);break}case he.BEVEL:{J?u.push(Dt,at,_+T*S,y+w*S,Dt,at,_+E*S,y+M*S):u.push(_-T*P,y-w*P,bt,Et,_-E*P,y-M*P,bt,Et),d+=2;break}case he.ROUND:{J?(u.push(Dt,at,_+T*S,y+w*S),d+=Mi(_,y,_+T*S,y+w*S,_+E*S,y+M*S,u,!0)+4,u.push(Dt,at,_+E*S,y+M*S)):(u.push(_-T*P,y-w*P,bt,Et),d+=Mi(_,y,_-T*P,y-w*P,_-E*P,y-M*P,u,!1)+4,u.push(_-E*P,y-M*P,bt,Et));break}}else{switch(u.push(_-T*P,y-w*P,_+T*S,y+w*S),en){case he.MITER:{J?u.push(bt,Et,bt,Et):u.push(Dt,at,Dt,at),d+=2;break}case he.ROUND:{J?d+=Mi(_,y,_+T*S,y+w*S,_+E*S,y+M*S,u,!0)+2:d+=Mi(_,y,_-T*P,y-w*P,_-E*P,y-M*P,u,!1)+2;break}}u.push(_-E*P,y-M*P,_+E*S,y+M*S),d+=2}}x=s[(c-2)*2],v=s[(c-2)*2+1],_=s[(c-1)*2],y=s[(c-1)*2+1],T=-(v-y),w=x-_,I=Math.sqrt(T*T+w*w),T/=I,w/=I,T*=p,w*=p,u.push(_-T*P,y-w*P,_+T*S,y+w*S),h||(n.cap===pi.ROUND?d+=Mi(_-T*(P-S)*.5,y-w*(P-S)*.5,_-T*P,y-w*P,_+T*S,y+w*S,u,!1)+2:n.cap===pi.SQUARE&&(d+=bu(_,y,T,w,P,S,!1,u)));const O=t.indices,G=Ti.epsilon*Ti.epsilon;for(let C=f;C<d+f-2;++C)x=u[C*2],v=u[C*2+1],_=u[(C+1)*2],y=u[(C+1)*2+1],b=u[(C+2)*2],A=u[(C+2)*2+1],!(Math.abs(x*(y-A)+_*(A-v)+b*(v-y))<G)&&O.push(C,C+1,C+2)}function u0(i,t){let e=0;const s=i.shape,r=i.points||s.points,n=s.type!==Rt.POLY||s.closeStroke;if(r.length===0)return;const o=t.points,a=t.indices,h=r.length/2,l=o.length/2;let u=l;for(o.push(r[0],r[1]),e=1;e<h;e++)o.push(r[e*2],r[e*2+1]),a.push(u,u+1),u++;n&&a.push(u,l)}function Va(i,t){i.lineStyle.native?u0(i,t):l0(i,t)}class Io{static curveLength(t,e,s,r,n,o){const a=t-2*s+n,h=e-2*r+o,l=2*s-2*t,u=2*r-2*e,c=4*(a*a+h*h),d=4*(a*l+h*u),f=l*l+u*u,p=2*Math.sqrt(c+d+f),m=Math.sqrt(c),g=2*c*m,x=2*Math.sqrt(f),v=d/m;return(g*p+m*d*(p-x)+(4*f*c-d*d)*Math.log((2*m+v+p)/(v+x)))/(4*g)}static curveTo(t,e,s,r,n){const o=n[n.length-2],a=n[n.length-1],h=Ti._segmentsCount(Io.curveLength(o,a,t,e,s,r));let l=0,u=0;for(let c=1;c<=h;++c){const d=c/h;l=o+(t-o)*d,u=a+(e-a)*d,n.push(l+(t+(s-t)*d-l)*d,u+(e+(r-e)*d-u)*d)}}}const Mn={[Rt.POLY]:Jh,[Rt.CIRC]:Cr,[Rt.ELIP]:Cr,[Rt.RECT]:zd,[Rt.RREC]:Hd},$a=[],nr=[];class Pr{constructor(t,e=null,s=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Pr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const ls=new K,$d=class extends wh{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Er,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),nr.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t.reset(),$a.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,t=null,e=null,s=null){const r=new Pr(i,t,e,s);return this.graphicsData.push(r),this.dirty++,this}drawHole(i,t=null){if(!this.graphicsData.length)return null;const e=new Pr(i,null,null,t),s=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=s.lineStyle,s.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){const t=this.graphicsData;for(let e=0;e<t.length;++e){const s=t[e];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(i,ls):ls.copyFrom(i),s.shape.contains(ls.x,ls.y))){let r=!1;if(s.holes){for(let n=0;n<s.holes.length;n++)if(s.holes[n].shape.contains(ls.x,ls.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const i=this.uvs,t=this.graphicsData;let e=null,s=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],s=e.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const h=t[a],l=h.fillStyle,u=h.lineStyle;Mn[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(l.visible||u.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){const f=d===0?l:u;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,g=this.points.length/2;p.wrapMode=We.REPEAT,d===0?this.processFill(h):this.processLine(h);const x=this.points.length/2-g;x!==0&&(e&&!this._compareStyles(s,f)&&(e.end(m,g),e=null),e||(e=$a.pop()||new Vd,e.begin(f,m,g),this.batches.push(e),s=f),this.addUvs(this.points,i,f.texture,g,x,f.matrix))}}const r=this.indices.length,n=this.points.length/2;if(e&&e.end(r,n),this.batches.length===0){this.batchable=!0;return}const o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,t){return!(!i||!t||i.texture.baseTexture!==t.texture.baseTexture||i.color+i.alpha!==t.color+t.alpha||!!i.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,t=this.graphicsData.length;i<t;i++){const e=this.graphicsData[i],s=e.fillStyle,r=e.lineStyle;if(s&&!s.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const i=this.batches;for(let t=0,e=i.length;t<e;t++){const s=i[t];for(let r=0;r<s.size;r++){const n=s.start+r;this.indicesUint16[n]=this.indicesUint16[n]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const i=this.batches;for(let t=0;t<i.length;t++)if(i[t].style.native)return!1;return this.points.length<$d.BATCHABLE_SIZE*2}buildDrawCalls(){let i=++Y._globalBatch;for(let u=0;u<this.drawCalls.length;u++)this.drawCalls[u].texArray.clear(),nr.push(this.drawCalls[u]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let s=nr.pop();s||(s=new Xn,s.texArray=new Wn),s.texArray.count=0,s.start=0,s.size=0,s.type=Ie.TRIANGLES;let r=0,n=null,o=0,a=!1,h=Ie.TRIANGLES,l=0;this.drawCalls.push(s);for(let u=0;u<this.batches.length;u++){const c=this.batches[u],d=8,f=c.style,p=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,h=a?Ie.LINES:Ie.TRIANGLES,n=null,r=d,i++),n!==p&&(n=p,p._batchEnabled!==i&&(r===d&&(i++,r=0,s.size>0&&(s=nr.pop(),s||(s=new Xn,s.texArray=new Wn),this.drawCalls.push(s)),s.start=l,s.size=0,s.texArray.count=0,s.type=h),p.touched=1,p._batchEnabled=i,p._batchLocation=r,p.wrapMode=We.REPEAT,s.texArray.elements[s.texArray.count++]=p,r++)),s.size+=c.size,l+=c.size,o=p._batchLocation,this.addColors(t,f.color,f.alpha,c.attribSize,c.attribStart),this.addTextureIds(e,o,c.attribSize,c.attribStart)}Y._globalBatch=i,this.packAttributes()}packAttributes(){const i=this.points,t=this.uvs,e=this.colors,s=this.textureIds,r=new ArrayBuffer(i.length*3*4),n=new Float32Array(r),o=new Uint32Array(r);let a=0;for(let h=0;h<i.length/2;h++)n[a++]=i[h*2],n[a++]=i[h*2+1],n[a++]=t[h*2],n[a++]=t[h*2+1],o[a++]=e[h],n[a++]=s[h];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?Jh.triangulate(i,this):Mn[i.type].triangulate(i,this)}processLine(i){Va(i,this);for(let t=0;t<i.holes.length;t++)Va(i.holes[t],this)}processHoles(i){for(let t=0;t<i.length;t++){const e=i[t];Mn[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,t){for(let e=0;e<i.length/2;e++){const s=i[e*2],r=i[e*2+1];i[e*2]=t.a*s+t.c*r+t.tx,i[e*2+1]=t.b*s+t.d*r+t.ty}}addColors(i,t,e,s,r=0){const n=tt.shared.setValue(t).toLittleEndianNumber(),o=tt.shared.setValue(n).toPremultiplied(e);i.length=Math.max(i.length,r+s);for(let a=0;a<s;a++)i[r+a]=o}addTextureIds(i,t,e,s=0){i.length=Math.max(i.length,s+e);for(let r=0;r<e;r++)i[s+r]=t}addUvs(i,t,e,s,r,n=null){let o=0;const a=t.length,h=e.frame;for(;o<r;){let u=i[(s+o)*2],c=i[(s+o)*2+1];if(n){const d=n.a*u+n.c*c+n.tx;c=n.b*u+n.d*c+n.ty,u=d}o++,t.push(u/h.width,c/h.height)}const l=e.baseTexture;(h.width<l.width||h.height<l.height)&&this.adjustUvs(t,e,a,r)}adjustUvs(i,t,e,s){const r=t.baseTexture,n=1e-6,o=e+s*2,a=t.frame,h=a.width/r.width,l=a.height/r.height;let u=a.x/a.width,c=a.y/a.height,d=Math.floor(i[e]+n),f=Math.floor(i[e+1]+n);for(let p=e+2;p<o;p+=2)d=Math.min(d,Math.floor(i[p]+n)),f=Math.min(f,Math.floor(i[p+1]+n));u-=d,c-=f;for(let p=e;p<o;p+=2)i[p]=(i[p]+u)*h,i[p+1]=(i[p+1]+c)*l}};let tl=$d;tl.BATCHABLE_SIZE=100;class Kr{constructor(){this.color=16777215,this.alpha=1,this.texture=N.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Kr;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=N.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Ro extends Kr{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=pi.BUTT,this.join=he.MITER,this.miterLimit=10}clone(){const t=new Ro;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const ia={},Dn=class extends Ut{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Kr,this._lineStyle=new Ro,this._matrix=null,this._holeMode=!1,this.state=Qe.for2d(),this._geometry=i||new tl,this._geometry.refCount++,this._transformID=-1,this._tintColor=new tt(16777215),this.blendMode=$.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Dn(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(i){this._tintColor.setValue(i)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,t=0,e,s=.5,r=!1){return typeof i=="number"&&(i={width:i,color:t,alpha:e,alignment:s,native:r}),this.lineTextureStyle(i)}lineTextureStyle(i){const t={width:0,texture:N.WHITE,color:i!=null&&i.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:pi.BUTT,join:he.MITER,miterLimit:10};i=Object.assign(t,i),this.normalizeColor(i),this.currentPath&&this.startPoly();const e=i.width>0&&i.alpha>0;return e?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:e},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const i=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Xi,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[t-2],i[t-1]))}else this.currentPath=new Xi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,t){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=t,this}lineTo(i,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,s=e[e.length-2],r=e[e.length-1];return(s!==i||r!==t)&&e.push(i,t),this}_initCurve(i=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[i,t]):this.moveTo(i,t)}quadraticCurveTo(i,t,e,s){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),Io.curveTo(i,t,e,s,r),this}bezierCurveTo(i,t,e,s,r,n){return this._initCurve(),Po.curveTo(i,t,e,s,r,n,this.currentPath.points),this}arcTo(i,t,e,s,r){this._initCurve(i,t);const n=this.currentPath.points,o=Ha.curveTo(i,t,e,s,r,n);if(o){const{cx:a,cy:h,radius:l,startAngle:u,endAngle:c,anticlockwise:d}=o;this.arc(a,h,l,u,c,d)}return this}arc(i,t,e,s,r,n=!1){if(s===r)return this;if(!n&&r<=s?r+=wr:n&&s<=r&&(s+=wr),r-s===0)return this;const a=i+Math.cos(s)*e,h=t+Math.sin(s)*e,l=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-h);c<l&&d<l||u.push(a,h)}else this.moveTo(a,h),u=this.currentPath.points;return Ha.arc(a,h,i,t,e,s,r,n,u),this}beginFill(i=0,t){return this.beginTextureFill({texture:N.WHITE,color:i,alpha:t})}normalizeColor(i){const t=tt.shared.setValue(i.color??0);i.color=t.toNumber(),i.alpha??(i.alpha=t.alpha)}beginTextureFill(i){const t={texture:N.WHITE,color:16777215,matrix:null};i=Object.assign(t,i),this.normalizeColor(i),this.currentPath&&this.startPoly();const e=i.alpha>0;return e?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:e},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,t,e,s){return this.drawShape(new Z(i,t,e,s))}drawRoundedRect(i,t,e,s,r){return this.drawShape(new Eo(i,t,e,s,r))}drawCircle(i,t,e){return this.drawShape(new wo(i,t,e))}drawEllipse(i,t,e,s){return this.drawShape(new To(i,t,e,s))}drawPolygon(...i){let t,e=!0;const s=i[0];s.points?(e=s.closeStroke,t=s.points):Array.isArray(i[0])?t=i[0]:t=i;const r=new Xi(t);return r.closeStroke=e,this.drawShape(r),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const i=this._geometry.graphicsData;return i.length===1&&i[0].shape.type===Rt.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){const i=this._geometry,t=this.blendMode,e=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(i.points);for(let s=0;s<e;s++){const r=i.batches[s],n=r.style.color,o=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),a=new Float32Array(i.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),h=new Uint16Array(i.indicesUint16.buffer,r.start*2,r.size),l={vertexData:o,blendMode:t,indices:h,uvs:a,_batchRGB:tt.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[s]=l}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const s=this.batches[t];s.worldAlpha=this.worldAlpha*s.alpha,i.plugins[this.pluginName].render(s)}}}_renderDirect(i){const t=this._resolveDirectShader(i),e=this._geometry,s=this.worldAlpha,r=t.uniforms,n=e.drawCalls;r.translationMatrix=this.transform.worldTransform,tt.shared.setValue(this._tintColor).premultiply(s).toArray(r.tint),i.shader.bind(t),i.geometry.bind(e,t),i.state.set(this.state);for(let o=0,a=n.length;o<a;o++)this._renderDrawCallDirect(i,e.drawCalls[o])}_renderDrawCallDirect(i,t){const{texArray:e,type:s,size:r,start:n}=t,o=e.count;for(let a=0;a<o;a++)i.texture.bind(e.elements[a],a);i.geometry.draw(s,r,n)}_resolveDirectShader(i){let t=this.shader;const e=this.pluginName;if(!t){if(!ia[e]){const{maxTextures:s}=i.plugins[e],r=new Int32Array(s);for(let a=0;a<s;a++)r[a]=a;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new ot,default:ye.from({uSamplers:r},!0)},o=i.plugins[e]._shader.program;ia[e]=new Be(o,n)}t=ia[e]}return t}_calculateBounds(){this.finishPoly();const i=this._geometry;if(!i.graphicsData.length)return;const{minX:t,minY:e,maxX:s,maxY:r}=i.bounds;this._bounds.addFrame(this.transform,t,e,s,r)}containsPoint(i){return this.worldTransform.applyInverse(i,Dn._TEMP_POINT),this._geometry.containsPoint(Dn._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t._tintRGB=tt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;const t=this.transform.worldTransform,e=t.a,s=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty,h=this._geometry.points,l=this.vertexData;let u=0;for(let c=0;c<h.length;c+=2){const d=h[c],f=h[c+1];l[u++]=e*d+r*f+o,l[u++]=n*f+s*d+a}}closePath(){const i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};let rs=Dn;rs.curves=Ti;rs._TEMP_POINT=new K;const c0={buildPoly:Jh,buildCircle:Cr,buildRectangle:zd,buildRoundedRectangle:Hd,buildLine:Va,ArcUtils:Ha,BezierUtils:Po,QuadraticUtils:Io,BatchPart:Vd,FILL_COMMANDS:Mn,BATCH_POOL:$a,DRAW_CALL_POOL:nr};class Xd{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const sa=new K,wu=new Xi,Wd=class extends Ut{constructor(i,t,e,s=Ie.TRIANGLES){super(),this.geometry=i,this.shader=t,this.state=e||Qe.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=B.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(i){this._geometry!==i&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=i,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(i){this.shader=i}get material(){return this.shader}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(i){this.shader.tint=i}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(i){this.shader.texture=i}_render(i){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ie.TRIANGLES&&t.length<Wd.BATCHABLE_SIZE*2?this._renderToBatch(i):this._renderDefault(i)}_renderDefault(i){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),i.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),i.shader.bind(t),i.state.set(this.state),i.geometry.bind(this.geometry,t),i.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(i){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const s=this.material.pluginName;i.batch.setObjectRenderer(i.plugins[s]),i.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,s=t._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,n=r.a,o=r.b,a=r.c,h=r.d,l=r.tx,u=r.ty,c=this.vertexData;for(let d=0;d<c.length/2;d++){const f=e[d*2],p=e[d*2+1];c[d*2]=n*f+a*p+l,c[d*2+1]=o*f+h*p+u}if(this._roundPixels){const d=B.RESOLUTION;for(let f=0;f<c.length;++f)c[f]=Math.round(c[f]*d)/d}this.vertexDirty=s}calculateUvs(){const i=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=i.data:(this.batchUvs||(this.batchUvs=new Xd(i,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(i){if(!this.getBounds().contains(i.x,i.y))return!1;this.worldTransform.applyInverse(i,sa);const t=this.geometry.getBuffer("aVertexPosition").data,e=wu.points,s=this.geometry.getIndex().data,r=s.length,n=this.drawMode===4?3:1;for(let o=0;o+2<r;o+=n){const a=s[o]*2,h=s[o+1]*2,l=s[o+2]*2;if(e[0]=t[a],e[1]=t[a+1],e[2]=t[h],e[3]=t[h+1],e[4]=t[l],e[5]=t[l+1],wu.contains(sa.x,sa.y))return!0}return!1}destroy(i){super.destroy(i),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let ts=Wd;ts.BATCHABLE_SIZE=100;class Zr extends ai{constructor(t,e,s){super();const r=new pt(t),n=new pt(e,!0),o=new pt(s,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,V.FLOAT).addAttribute("aTextureCoord",n,2,!1,V.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var d0=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,f0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Bs extends Be{constructor(t,e){const s={uSampler:t,alpha:1,uTextureMatrix:ot.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(s,e.uniforms),super(e.program||ge.from(f0,d0),s),this._colorDirty=!1,this.uvMatrix=new Ao(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new tt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;tt.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class jd extends Zr{constructor(t=100,e=100,s=10,r=10){super(),this.segWidth=s,this.segHeight=r,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],s=[],r=[],n=this.segWidth-1,o=this.segHeight-1,a=this.width/n,h=this.height/o;for(let u=0;u<t;u++){const c=u%this.segWidth,d=u/this.segWidth|0;e.push(c*a,d*h),s.push(c/n,d/o)}const l=n*o;for(let u=0;u<l;u++){const c=u%n,d=u/n|0,f=d*this.segWidth+c,p=d*this.segWidth+c+1,m=(d+1)*this.segWidth+c,g=(d+1)*this.segWidth+c+1;r.push(f,p,m,p,g,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class Yd extends Zr{constructor(t=200,e,s=0){super(new Float32Array(e.length*4),new Float32Array(e.length*4),new Uint16Array((e.length-1)*6)),this.points=e,this._width=t,this.textureScale=s,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),s=this.getBuffer("aTextureCoord"),r=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),s.data=new Float32Array(t.length*4),r.data=new Uint16Array((t.length-1)*6));const n=s.data,o=r.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let a=0,h=t[0];const l=this._width*this.textureScale,u=t.length;for(let d=0;d<u;d++){const f=d*4;if(this.textureScale>0){const p=h.x-t[d].x,m=h.y-t[d].y,g=Math.sqrt(p*p+m*m);h=t[d],a+=g/l}else a=d/(u-1);n[f]=a,n[f+1]=0,n[f+2]=a,n[f+3]=1}let c=0;for(let d=0;d<u-1;d++){const f=d*2;o[c++]=f,o[c++]=f+1,o[c++]=f+2,o[c++]=f+2,o[c++]=f+1,o[c++]=f+3}s.update(),r.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],s,r=0,n=0;const o=this.buffers[0].data,a=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let l=0;l<a;l++){const u=t[l],c=l*4;l<t.length-1?s=t[l+1]:s=u,n=-(s.x-e.x),r=s.y-e.y;const d=Math.sqrt(r*r+n*n);d<1e-6?(r=0,n=0):(r/=d,n/=d,r*=h,n*=h),o[c]=u.x+r,o[c+1]=u.y+n,o[c+2]=u.x-r,o[c+3]=u.y-n,e=u}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class qd extends ts{constructor(t,e,s){const r=new jd(t.width,t.height,e,s),n=new Bs(N.WHITE);super(r,n),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:s}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==s)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const yn=10;class p0 extends qd{constructor(t,e,s,r,n){var o,a,h,l;super(N.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e??((o=t.defaultBorders)==null?void 0:o.left)??yn,this._rightWidth=r??((a=t.defaultBorders)==null?void 0:a.right)??yn,this._topHeight=s??((h=t.defaultBorders)==null?void 0:h.top)??yn,this._bottomHeight=n??((l=t.defaultBorders)==null?void 0:l.bottom)??yn,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,s=this._topHeight+this._bottomHeight,r=this._height>s?1:this._height/s;return Math.min(e,r)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const s=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=s*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-s*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class m0 extends ts{constructor(t=N.EMPTY,e,s,r,n){const o=new Zr(e,s,r);o.getBuffer("aVertexPosition").static=!1;const a=new Bs(t);super(o,a,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class g0 extends ts{constructor(t,e,s=0){const r=new Yd(t.height,e,s),n=new Bs(t);s>0&&(t.baseTexture.wrapMode=We.REPEAT),super(r,n),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}class _0 extends Ut{constructor(t=1500,e,s=16384,r=!1){super();const n=16384;s>n&&(s=n),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=s,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=$.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new tt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class Tu{constructor(t,e,s){this.geometry=new ai,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||V.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new pt(Sc(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=e,e+=a.size,this.dynamicStride+=a.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new pt(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=r,r+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new pt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===V.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===V.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,e,s){for(let r=0;r<this.dynamicProperties.length;r++){const n=this.dynamicProperties[r];n.uploadFunction(t,e,s,n.type===V.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,s){for(let r=0;r<this.staticProperties.length;r++){const n=this.staticProperties[r];n.uploadFunction(t,e,s,n.type===V.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var x0=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,v0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class el extends Vr{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new ot,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:V.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Be.from(v0,x0,{}),this.state=Qe.for2d()}render(t){const e=t.children,s=t._maxSize,r=t._batchSize,n=this.renderer;let o=e.length;if(o===0)return;o>s&&!t.autoResize&&(o=s);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=e[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=yh(t.blendMode,l),n.state.set(this.state);const u=n.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=tt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=r,p+=1){let m=o-f;m>r&&(m=r),p>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[p];g.uploadDynamic(e,f,m);const x=t._bufferUpdateIDs[p]||0;d=d||g._updateID<x,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,m)),n.geometry.bind(g.geometry),u.drawElements(u.TRIANGLES,m*6,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],s=t._maxSize,r=t._batchSize,n=t._properties;for(let o=0;o<s;o+=r)e.push(new Tu(this.properties,n,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,s=t._properties;return new Tu(this.properties,s,e)}uploadVertices(t,e,s,r,n,o){let a=0,h=0,l=0,u=0;for(let c=0;c<s;++c){const d=t[e+c],f=d._texture,p=d.scale.x,m=d.scale.y,g=f.trim,x=f.orig;g?(h=g.x-d.anchor.x*x.width,a=h+g.width,u=g.y-d.anchor.y*x.height,l=u+g.height):(a=x.width*(1-d.anchor.x),h=x.width*-d.anchor.x,l=x.height*(1-d.anchor.y),u=x.height*-d.anchor.y),r[o]=h*p,r[o+1]=u*m,r[o+n]=a*p,r[o+n+1]=u*m,r[o+n*2]=a*p,r[o+n*2+1]=l*m,r[o+n*3]=h*p,r[o+n*3+1]=l*m,o+=n*4}}uploadPosition(t,e,s,r,n,o){for(let a=0;a<s;a++){const h=t[e+a].position;r[o]=h.x,r[o+1]=h.y,r[o+n]=h.x,r[o+n+1]=h.y,r[o+n*2]=h.x,r[o+n*2+1]=h.y,r[o+n*3]=h.x,r[o+n*3+1]=h.y,o+=n*4}}uploadRotation(t,e,s,r,n,o){for(let a=0;a<s;a++){const h=t[e+a].rotation;r[o]=h,r[o+n]=h,r[o+n*2]=h,r[o+n*3]=h,o+=n*4}}uploadUvs(t,e,s,r,n,o){for(let a=0;a<s;++a){const h=t[e+a]._texture._uvs;h?(r[o]=h.x0,r[o+1]=h.y0,r[o+n]=h.x1,r[o+n+1]=h.y1,r[o+n*2]=h.x2,r[o+n*2+1]=h.y2,r[o+n*3]=h.x3,r[o+n*3+1]=h.y3,o+=n*4):(r[o]=0,r[o+1]=0,r[o+n]=0,r[o+n+1]=0,r[o+n*2]=0,r[o+n*2+1]=0,r[o+n*3]=0,r[o+n*3+1]=0,o+=n*4)}}uploadTint(t,e,s,r,n,o){for(let a=0;a<s;++a){const h=t[e+a],l=tt.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);r[o]=l,r[o+n]=l,r[o+n*2]=l,r[o+n*3]=l,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}el.extension={name:"particle",type:L.RendererPlugin};z.add(el);var Qr=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(Qr||{});const bn={willReadFrequently:!0},U=class{static get experimentalLetterSpacingSupported(){let i=U._experimentalLetterSpacingSupported;if(i!==void 0){const t=B.ADAPTER.getCanvasRenderingContext2D().prototype;i=U._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,s,r,n,o,a,h){this.text=i,this.style=t,this.width=e,this.height=s,this.lines=r,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(i,t,e,s=U._canvas){e=e??t.wordWrap;const r=t.toFontString(),n=U.measureFont(r);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);const o=s.getContext("2d",bn);o.font=r;const h=(e?U.wordWrap(i,t,s):i).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let u=0;for(let p=0;p<h.length;p++){const m=U._measureText(h[p],t.letterSpacing,o);l[p]=m,u=Math.max(u,m)}let c=u+t.strokeThickness;t.dropShadow&&(c+=t.dropShadowDistance);const d=t.lineHeight||n.fontSize+t.strokeThickness;let f=Math.max(d,n.fontSize+t.strokeThickness*2)+(h.length-1)*(d+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new U(i,t,c,f,h,l,d+t.leading,u,n)}static _measureText(i,t,e){let s=!1;U.experimentalLetterSpacingSupported&&(U.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,s=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(i).width;return r>0&&(s?r-=t:r+=(U.graphemeSegmenter(i).length-1)*t),r}static wordWrap(i,t,e=U._canvas){const s=e.getContext("2d",bn);let r=0,n="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,u=U.collapseSpaces(l),c=U.collapseNewlines(l);let d=!u;const f=t.wordWrapWidth+h,p=U.tokenize(i);for(let m=0;m<p.length;m++){let g=p[m];if(U.isNewline(g)){if(!c){o+=U.addLine(n),d=!u,n="",r=0;continue}g=" "}if(u){const v=U.isBreakingSpace(g),_=U.isBreakingSpace(n[n.length-1]);if(v&&_)continue}const x=U.getFromCache(g,h,a,s);if(x>f)if(n!==""&&(o+=U.addLine(n),n="",r=0),U.canBreakWords(g,t.breakWords)){const v=U.wordWrapSplit(g);for(let _=0;_<v.length;_++){let y=v[_],b=y,A=1;for(;v[_+A];){const w=v[_+A];if(!U.canBreakChars(b,w,g,_,t.breakWords))y+=w;else break;b=w,A++}_+=A-1;const T=U.getFromCache(y,h,a,s);T+r>f&&(o+=U.addLine(n),d=!1,n="",r=0),n+=y,r+=T}}else{n.length>0&&(o+=U.addLine(n),n="",r=0);const v=m===p.length-1;o+=U.addLine(g,!v),d=!1,n="",r=0}else x+r>f&&(d=!1,o+=U.addLine(n),n="",r=0),(n.length>0||!U.isBreakingSpace(g)||d)&&(n+=g,r+=x)}return o+=U.addLine(n,!1),o}static addLine(i,t=!0){return i=U.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,s){let r=e[i];return typeof r!="number"&&(r=U._measureText(i,t,s)+t,e[i]=r),r}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!U.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:U._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:U._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let s=0;s<i.length;s++){const r=i[s],n=i[s+1];if(U.isBreakingSpace(r,n)||U.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,s,r){return!0}static wordWrapSplit(i){return U.graphemeSegmenter(i)}static measureFont(i){if(U._fonts[i])return U._fonts[i];const t={ascent:0,descent:0,fontSize:0},e=U._canvas,s=U._context;s.font=i;const r=U.METRICS_STRING+U.BASELINE_SYMBOL,n=Math.ceil(s.measureText(r).width);let o=Math.ceil(s.measureText(U.BASELINE_SYMBOL).width);const a=Math.ceil(U.HEIGHT_MULTIPLIER*o);if(o=o*U.BASELINE_MULTIPLIER|0,n===0||a===0)return U._fonts[i]=t,t;e.width=n,e.height=a,s.fillStyle="#f00",s.fillRect(0,0,n,a),s.font=i,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,o);const h=s.getImageData(0,0,n,a).data,l=h.length,u=n*4;let c=0,d=0,f=!1;for(c=0;c<o;++c){for(let p=0;p<u;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d+=u;else break}for(t.ascent=o-c,d=l-u,f=!1,c=a;c>o;--c){for(let p=0;p<u;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d-=u;else break}return t.descent=c-o,t.fontSize=t.ascent+t.descent,U._fonts[i]=t,t}static clearMetrics(i=""){i?delete U._fonts[i]:U._fonts={}}static get _canvas(){if(!U.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",bn);if(e!=null&&e.measureText)return U.__canvas=t,t;i=B.ADAPTER.createCanvas()}catch{i=B.ADAPTER.createCanvas()}i.width=i.height=10,U.__canvas=i}return U.__canvas}static get _context(){return U.__context||(U.__context=U._canvas.getContext("2d",bn)),U.__context}};let It=U;It.METRICS_STRING="|q";It.BASELINE_SYMBOL="M";It.BASELINE_MULTIPLIER=1.4;It.HEIGHT_MULTIPLIER=2;It.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();It.experimentalLetterSpacing=!1;It._fonts={};It._newlines=[10,13];It._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const y0=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],or=class{constructor(i){this.styleID=0,this.reset(),na(this,i,i)}clone(){const i={};return na(i,this,or.defaultStyle),new or(i)}reset(){na(this,or.defaultStyle,or.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){const t=ra(i);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){const t=ra(i);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){b0(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){const t=ra(i);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){const i=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let s=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!y0.includes(s)&&(s=`"${s}"`),t[e]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${t.join(",")}`}};let Ke=or;Ke.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Qr.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function ra(i){const t=tt.shared;return Array.isArray(i)?i.map(e=>t.setValue(e).toHex()):t.setValue(i).toHex()}function b0(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function na(i,t,e){for(const s in e)Array.isArray(t[s])?i[s]=t[s].slice():i[s]=t[s]}const w0={texture:!0,children:!1,baseTexture:!0},Xa=class extends Je{constructor(i,t,e){let s=!1;e||(e=B.ADAPTER.createCanvas(),s=!0),e.width=3,e.height=3;const r=N.from(e);r.orig=new Z,r.trim=new Z,super(r),this._ownCanvas=s,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=Xa.defaultResolution??B.RESOLUTION,this._autoResolution=Xa.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return It.experimentalLetterSpacing}static set experimentalLetterSpacing(i){j("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),It.experimentalLetterSpacing=i}updateText(i){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();const e=this.context,s=It.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=s.width,n=s.height,o=s.lines,a=s.lineHeight,h=s.lineWidths,l=s.maxLineWidth,u=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let c,d;const f=t.dropShadow?2:1;for(let p=0;p<f;++p){const m=t.dropShadow&&p===0,g=m?Math.ceil(Math.max(1,n)+t.padding*2):0,x=g*this._resolution;if(m){e.fillStyle="black",e.strokeStyle="black";const _=t.dropShadowColor,y=t.dropShadowBlur*this._resolution,b=t.dropShadowDistance*this._resolution;e.shadowColor=tt.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),e.shadowBlur=y,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*b,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*b+x}else e.fillStyle=this._generateFillStyle(t,o,s),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let v=(a-u.fontSize)/2;a-u.fontSize<0&&(v=0);for(let _=0;_<o.length;_++)c=t.strokeThickness/2,d=t.strokeThickness/2+_*a+u.ascent+v,t.align==="right"?c+=l-h[_]:t.align==="center"&&(c+=(l-h[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[_],c+t.padding,d+t.padding-g,!0),t.fill&&this.drawLetterSpacing(o[_],c+t.padding,d+t.padding-g)}this.updateTexture()}drawLetterSpacing(i,t,e,s=!1){const n=this._style.letterSpacing;let o=!1;if(It.experimentalLetterSpacingSupported&&(It.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){s?this.context.strokeText(i,t,e):this.context.fillText(i,t,e);return}let a=t;const h=It.graphemeSegmenter(i);let l=this.context.measureText(i).width,u=0;for(let c=0;c<h.length;++c){const d=h[c];s?this.context.strokeText(d,a,e):this.context.fillText(d,a,e);let f="";for(let p=c+1;p<h.length;++p)f+=h[p];u=this.context.measureText(f).width,a+=l-u+n,l=u}}updateTexture(){const i=this.canvas;if(this._style.trim){const n=Rc(i);n.data&&(i.width=n.width,i.height=n.height,this.context.putImageData(n.data,0,0))}const t=this._texture,e=this._style,s=e.trim?0:e.padding,r=t.baseTexture;t.trim.width=t._frame.width=i.width/this._resolution,t.trim.height=t._frame.height=i.height/this._resolution,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),r.setRealSize(i.width,i.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,t){return this.updateText(!0),this._textureID===-1&&(i=!1),super.getBounds(i,t)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,t,e){const s=i.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let r;const n=i.dropShadow?i.dropShadowDistance:0,o=i.padding||0,a=this.canvas.width/this._resolution-n-o*2,h=this.canvas.height/this._resolution-n-o*2,l=s.slice(),u=i.fillGradientStops.slice();if(!u.length){const c=l.length+1;for(let d=1;d<c;++d)u.push(d/c)}if(l.unshift(s[0]),u.unshift(0),l.push(s[s.length-1]),u.push(1),i.fillGradientType===Qr.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,o,a/2,h+o);const c=e.fontProperties.fontSize+i.strokeThickness;for(let d=0;d<t.length;d++){const f=e.lineHeight*(d-1)+c,p=e.lineHeight*d;let m=p;d>0&&f>p&&(m=(p+f)/2);const g=p+c,x=e.lineHeight*(d+1);let v=g;d+1<t.length&&x<g&&(v=(g+x)/2);const _=(v-m)/h;for(let y=0;y<l.length;y++){let b=0;typeof u[y]=="number"?b=u[y]:b=y/l.length;let A=Math.min(1,Math.max(0,m/h+b*_));A=Number(A.toFixed(5)),r.addColorStop(A,l[y])}}}else{r=this.context.createLinearGradient(o,h/2,a+o,h/2);const c=l.length+1;let d=1;for(let f=0;f<l.length;f++){let p;typeof u[f]=="number"?p=u[f]:p=d/c,r.addColorStop(p,l[f]),d++}}return r}destroy(i){typeof i=="boolean"&&(i={children:i}),i=Object.assign({},w0,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);const t=ni(this.scale.x)||1;this.scale.x=t*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);const t=ni(this.scale.y)||1;this.scale.y=t*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){i=i||{},i instanceof Ke?this._style=i:this._style=new Ke(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};let ji=Xa;ji.defaultAutoResolution=!0;class Kd{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function T0(i,t){var s;let e=!1;if((s=i==null?void 0:i._textures)!=null&&s.length){for(let r=0;r<i._textures.length;r++)if(i._textures[r]instanceof N){const n=i._textures[r].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function E0(i,t){if(i.baseTexture instanceof Y){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function A0(i,t){if(i._texture&&i._texture instanceof N){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function S0(i,t){return t instanceof ji?(t.updateText(!0),!0):!1}function C0(i,t){if(t instanceof Ke){const e=t.toFontString();return It.measureFont(e),!0}return!1}function P0(i,t){if(i instanceof ji){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function I0(i,t){return i instanceof Ke?(t.includes(i)||t.push(i),!0):!1}const Zd=class{constructor(i){this.limiter=new Kd(Zd.uploadsPerFrame),this.renderer=i,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(P0),this.registerFindHook(I0),this.registerFindHook(T0),this.registerFindHook(E0),this.registerFindHook(A0),this.registerUploadHook(S0),this.registerUploadHook(C0)}upload(i){return new Promise(t=>{i&&this.add(i),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,vt.system.addOnce(this.tick,this,li.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const i=this.queue[0];let t=!1;if(i&&!i._destroyed){for(let e=0,s=this.uploadHooks.length;e<s;e++)if(this.uploadHooks[e](this.uploadHookHelper,i)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)vt.system.addOnce(this.tick,this,li.UTILITY);else{this.ticking=!1;const i=this.completes.slice(0);this.completes.length=0;for(let t=0,e=i.length;t<e;t++)i[t]()}}registerFindHook(i){return i&&this.addHooks.push(i),this}registerUploadHook(i){return i&&this.uploadHooks.push(i),this}add(i){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](i,this.queue);t++);if(i instanceof Ut)for(let t=i.children.length-1;t>=0;t--)this.add(i.children[t]);return this}destroy(){this.ticking&&vt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Ir=Zd;Ir.uploadsPerFrame=4;Object.defineProperties(B,{UPLOADS_PER_FRAME:{get(){return Ir.uploadsPerFrame},set(i){j("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Ir.uploadsPerFrame=i}}});function Qd(i,t){return t instanceof Y?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function R0(i,t){if(!(t instanceof rs))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:s}=e;for(let r=0;r<s.length;r++){const{texture:n}=s[r].style;n&&Qd(i,n.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function M0(i,t){return i instanceof rs?(t.push(i),!0):!1}class il extends Ir{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(M0),this.registerUploadHook(Qd),this.registerUploadHook(R0)}}il.extension={name:"prepare",type:L.RendererSystem};z.add(il);class D0{constructor(t){this.maxMilliseconds=t,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class Zn extends Je{constructor(t,e=!0){super(t[0]instanceof N?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(vt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(vt.shared.add(this.update,this,li.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,s=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):s!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<s||this.animationSpeed<0&&this.currentFrame>s)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let s=0;s<t.length;++s)e.push(N.from(t[s]));return new Zn(e)}static fromImages(t){const e=[];for(let s=0;s<t.length;++s)e.push(N.from(t[s]));return new Zn(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof N)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(vt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(vt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const Js=new K;class sl extends Je{constructor(t,e=100,s=100){super(t),this.tileTransform=new Hr,this._width=e,this._height=s,this.uvMatrix=this.texture.uvMatrix||new Ao(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;!e||!e.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,s=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,s,r)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Js);const e=this._width,s=this._height,r=-e*this.anchor._x;if(Js.x>=r&&Js.x<r+e){const n=-s*this.anchor._y;if(Js.y>=n&&Js.y<n+s)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const s=t instanceof N?t:N.from(t,e);return new sl(s,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var F0=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,B0=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,k0=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Eu=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,O0=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const wn=new ot;class rl extends Vr{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Ph,this.state=Qe.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Be.from(Eu,O0,e),this.shader=t.context.webGLVersion>1?Be.from(B0,F0,e):Be.from(Eu,k0,e)}render(t){const e=this.renderer,s=this.quad;let r=s.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;r=s.uvs,r[0]=r[6]=-n,r[1]=r[3]=-o,r[2]=r[4]=1-n,r[5]=r[7]=1-o,s.invalidate();const a=t._texture,h=a.baseTexture,l=h.alphaMode>0,u=t.tileTransform.localTransform,c=t.uvMatrix;let d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[e.CONTEXT_UID]?d=h.wrapMode!==We.CLAMP:h.wrapMode===We.CLAMP&&(h.wrapMode=We.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,g=t._width,x=t._height;wn.set(u.a*p/g,u.b*p/x,u.c*m/g,u.d*m/x,u.tx/g,u.ty/x),wn.invert(),d?wn.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=wn.toArray(!0),f.uniforms.uColor=tt.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(s),this.state.blendMode=yh(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}rl.extension={name:"tilingSprite",type:L.RendererPlugin};z.add(rl);const ar=class{constructor(i,t,e=null){this.linkedSheets=[],this._texture=i instanceof N?i:null,this.baseTexture=i instanceof Y?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const s=this.baseTexture.resource;this.resolution=this._updateResolution(e||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(i=null){const{scale:t}=this.data.meta;let e=oi(i,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(i=>{this._callback=i,this._batchIndex=0,this._frameKeys.length<=ar.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(i){let t=i;const e=ar.BATCH_SIZE;for(;t-i<e&&t<this._frameKeys.length;){const s=this._frameKeys[t],r=this._frames[s],n=r.frame;if(n){let o=null,a=null;const h=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,l=new Z(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);r.rotated?o=new Z(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):o=new Z(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(a=new Z(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[s]=new N(this.baseTexture,o,l,a,r.rotated?2:0,r.anchor,r.borders),N.addToCache(this.textures[s],s)}t++}}_processAnimations(){const i=this.data.animations||{};for(const t in i){this.animations[t]=[];for(let e=0;e<i[t].length;e++){const s=i[t][e];this.animations[t].push(this.textures[s])}}}_parseComplete(){const i=this._callback;this._callback=null,this._batchIndex=0,i.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ar.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ar.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(i=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,i&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Qn=ar;Qn.BATCH_SIZE=1e3;const L0=["jpg","png","jpeg","avif","webp"];function Jd(i,t,e){const s={};if(i.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[r]=t.textures[r]}),!e){const r=Bt.dirname(i[0]);t.linkedSheets.forEach((n,o)=>{const a=Jd([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(s,a)})}return s}const tf={extension:L.Asset,cache:{test:i=>i instanceof Qn,getCacheableAssets:(i,t)=>Jd(i,t,!1)},resolver:{test:i=>{const e=i.split("?")[0].split("."),s=e.pop(),r=e.pop();return s==="json"&&L0.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=B.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:L.LoadParser,priority:Le.Normal},async testParse(i,t){return Bt.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var l,u;let s=Bt.dirname(t.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let r=s+i.meta.image;r=Yn(r,t.src);const o=(await e.load([r]))[r],a=new Qn(o.baseTexture,i,t.src);await a.parse();const h=(l=i==null?void 0:i.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(h)){const c=[];for(const f of h){if(typeof f!="string")continue;let p=s+f;(u=t.data)!=null&&u.ignoreMultiPack||(p=Yn(p,t.src),c.push(e.load({src:p,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(c);a.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[a].concat(a.linkedSheets.filter(p=>p!==f))})}return a},unload(i){i.destroy(!0)}}};z.add(tf);class Rr{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class cr{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const o=e[n].match(/^[a-z]+/gm)[0],a=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const l in a){const u=a[l].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;h[c]=p}s[o].push(h)}const r=new Rr;return s.info.forEach(n=>r.info.push({face:n.face,size:parseInt(n.size,10)})),s.common.forEach(n=>r.common.push({lineHeight:parseInt(n.lineHeight,10)})),s.page.forEach(n=>r.page.push({id:parseInt(n.id,10),file:n.file})),s.char.forEach(n=>r.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),s.kerning.forEach(n=>r.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),s.distanceField.forEach(n=>r.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),r}}class Jn{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Rr,s=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<s.length;l++)e.info.push({face:s[l].getAttribute("face"),size:parseInt(s[l].getAttribute("size"),10)});for(let l=0;l<r.length;l++)e.common.push({lineHeight:parseInt(r[l].getAttribute("lineHeight"),10)});for(let l=0;l<n.length;l++)e.page.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});for(let l=0;l<o.length;l++){const u=o[l];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)e.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)e.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return e}}class to{static test(t){return typeof t=="string"&&t.includes("<font>")?Jn.test(B.ADAPTER.parseXML(t)):!1}static parse(t){return Jn.parse(B.ADAPTER.parseXML(t))}}const oa=[cr,Jn,to];function ef(i){for(let t=0;t<oa.length;t++)if(oa[t].test(i))return oa[t];return null}function N0(i,t,e,s,r,n){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,u=i.width/s-h-l*2,c=i.height/s-h-l*2,d=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),e.fillGradientType===Qr.LINEAR_VERTICAL){a=t.createLinearGradient(u/2,l,u/2,c+l);let p=0;const g=(n.fontProperties.fontSize+e.strokeThickness)/c;for(let x=0;x<r.length;x++){const v=n.lineHeight*x;for(let _=0;_<d.length;_++){let y=0;typeof f[_]=="number"?y=f[_]:y=_/d.length;const b=v/c+y*g;let A=Math.max(p,b);A=Math.min(A,1),a.addColorStop(A,d[_]),p=A}}}else{a=t.createLinearGradient(l,c/2,u+l,c/2);const p=d.length+1;let m=1;for(let g=0;g<d.length;g++){let x;typeof f[g]=="number"?x=f[g]:x=m/p,a.addColorStop(x,d[g]),m++}}return a}function U0(i,t,e,s,r,n,o){const a=e.text,h=e.fontProperties;t.translate(s,r),t.scale(n,n);const l=o.strokeThickness/2,u=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=N0(i,t,o,n,[a],e),t.strokeStyle=o.stroke,o.dropShadow){const c=o.dropShadowColor,d=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=tt.shared.setValue(c).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,u+e.lineHeight-h.descent),o.fill&&t.fillText(a,l,u+e.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Fn(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function sf(i){return Array.from?Array.from(i):i.split("")}function G0(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,s=i.length;e<s;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...sf(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Se=class{constructor(i,t,e){var l;const[s]=i.info,[r]=i.common,[n]=i.page,[o]=i.distanceField,a=oi(n.file),h={};this._ownsTextures=e,this.font=s.face,this.size=s.size,this.lineHeight=r.lineHeight/a,this.chars={},this.pageTextures=h;for(let u=0;u<i.page.length;u++){const{id:c,file:d}=i.page[u];h[c]=t instanceof Array?t[u]:t[d],o!=null&&o.fieldType&&o.fieldType!=="none"&&(h[c].baseTexture.alphaMode=we.NO_PREMULTIPLIED_ALPHA,h[c].baseTexture.mipmap=Oe.OFF)}for(let u=0;u<i.char.length;u++){const{id:c,page:d}=i.char[u];let{x:f,y:p,width:m,height:g,xoffset:x,yoffset:v,xadvance:_}=i.char[u];f/=a,p/=a,m/=a,g/=a,x/=a,v/=a,_/=a;const y=new Z(f+h[d].frame.x/a,p+h[d].frame.y/a,m,g);this.chars[c]={xOffset:x,yOffset:v,xAdvance:_,kerning:{},texture:new N(h[d].baseTexture,y),page:d}}for(let u=0;u<i.kerning.length;u++){let{first:c,second:d,amount:f}=i.kerning[u];c/=a,d/=a,f/=a,this.chars[d]&&(this.chars[d].kerning[c]=f)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((l=o==null?void 0:o.fieldType)==null?void 0:l.toLowerCase())??"none"}destroy(){for(const i in this.chars)this.chars[i].texture.destroy(),this.chars[i].texture=null;for(const i in this.pageTextures)this._ownsTextures&&this.pageTextures[i].destroy(!0),this.pageTextures[i]=null;this.chars=null,this.pageTextures=null}static install(i,t,e){let s;if(i instanceof Rr)s=i;else{const n=ef(i);if(!n)throw new Error("Unrecognized data format for font.");s=n.parse(i)}t instanceof N&&(t=[t]);const r=new Se(s,t,e);return Se.available[r.font]=r,r}static uninstall(i){const t=Se.available[i];if(!t)throw new Error(`No font found named '${i}'`);t.destroy(),delete Se.available[i]}static from(i,t,e){if(!i)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:r,resolution:n,textureWidth:o,textureHeight:a,...h}=Object.assign({},Se.defaultOptions,e),l=G0(s),u=t instanceof Ke?t:new Ke(t),c=o,d=new Rr;d.info[0]={face:u.fontFamily,size:u.fontSize},d.common[0]={lineHeight:u.fontSize};let f=0,p=0,m,g,x,v=0;const _=[];for(let b=0;b<l.length;b++){m||(m=B.ADAPTER.createCanvas(),m.width=o,m.height=a,g=m.getContext("2d"),x=new Y(m,{resolution:n,...h}),_.push(new N(x)),d.page.push({id:_.length-1,file:""}));const A=l[b],T=It.measureText(A,u,!1,m),w=T.width,E=Math.ceil(T.height),M=Math.ceil((u.fontStyle==="italic"?2:1)*w);if(p>=a-E*n){if(p===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${A}')`);--b,m=null,g=null,x=null,p=0,f=0,v=0;continue}if(v=Math.max(E+T.fontProperties.descent,v),M*n+f>=c){if(f===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${A}')`);--b,p+=v*n,p=Math.ceil(p),f=0,v=0;continue}U0(m,g,T,f,p,n,u);const I=Fn(T.text);d.char.push({id:I,page:_.length-1,x:f/n,y:p/n,width:M,height:E,xoffset:0,yoffset:0,xadvance:w-(u.dropShadow?u.dropShadowDistance:0)-(u.stroke?u.strokeThickness:0)}),f+=(M+2*r)*n,f=Math.ceil(f)}for(let b=0,A=l.length;b<A;b++){const T=l[b];for(let w=0;w<A;w++){const E=l[w],M=g.measureText(T).width,I=g.measureText(E).width,P=g.measureText(T+E).width-(M+I);P&&d.kerning.push({first:Fn(T),second:Fn(E),amount:P})}}const y=new Se(d,_,!0);return Se.available[i]!==void 0&&Se.uninstall(i),Se.available[i]=y,y}};let zt=Se;zt.ALPHA=[["a","z"],["A","Z"]," "];zt.NUMERIC=[["0","9"]];zt.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];zt.ASCII=[[" ","~"]];zt.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Se.ALPHANUMERIC};zt.available={};var z0=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,H0=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Au=[],Su=[],Cu=[],rf=class extends Ut{constructor(i,t={}){super();const{align:e,tint:s,maxWidth:r,letterSpacing:n,fontName:o,fontSize:a}=Object.assign({},rf.styleDefaults,t);if(!zt.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tintColor=new tt(s),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=i,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new $e(()=>{this.dirty=!0},this,0,0),this._roundPixels=B.ROUND_PIXELS,this.dirty=!0,this._resolution=B.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var M;const i=zt.available[this._fontName],t=this.fontSize,e=t/i.size,s=new K,r=[],n=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=sf(a),l=this._maxWidth*i.size/t,u=i.distanceFieldType==="none"?Au:Su;let c=null,d=0,f=0,p=0,m=-1,g=0,x=0,v=0,_=0;for(let I=0;I<h.length;I++){const D=h[I],P=Fn(D);if(/(?:\s)/.test(D)&&(m=I,g=d,_++),D==="\r"||D===`
`){n.push(d),o.push(-1),f=Math.max(f,d),++p,++x,s.x=0,s.y+=i.lineHeight,c=null,_=0;continue}const S=i.chars[P];if(!S)continue;c&&S.kerning[c]&&(s.x+=S.kerning[c]);const O=Cu.pop()||{texture:N.EMPTY,line:0,charCode:0,prevSpaces:0,position:new K};O.texture=S.texture,O.line=p,O.charCode=P,O.position.x=Math.round(s.x+S.xOffset+this._letterSpacing/2),O.position.y=Math.round(s.y+S.yOffset),O.prevSpaces=_,r.push(O),d=O.position.x+Math.max(S.xAdvance-S.xOffset,S.texture.orig.width),s.x+=S.xAdvance+this._letterSpacing,v=Math.max(v,S.yOffset+S.texture.height),c=P,m!==-1&&l>0&&s.x>l&&(++x,$i(r,1+m-x,1+I-m),I=m,m=-1,n.push(g),o.push(r.length>0?r[r.length-1].prevSpaces:0),f=Math.max(f,g),p++,s.x=0,s.y+=i.lineHeight,c=null,_=0)}const y=h[h.length-1];y!=="\r"&&y!==`
`&&(/(?:\s)/.test(y)&&(d=g),n.push(d),f=Math.max(f,d),o.push(-1));const b=[];for(let I=0;I<=p;I++){let D=0;this._align==="right"?D=f-n[I]:this._align==="center"?D=(f-n[I])/2:this._align==="justify"&&(D=o[I]<0?0:(f-n[I])/o[I]),b.push(D)}const A=r.length,T={},w=[],E=this._activePagesMeshData;u.push(...E);for(let I=0;I<A;I++){const D=r[I].texture,P=D.baseTexture.uid;if(!T[P]){let S=u.pop();if(!S){const G=new Zr;let C,k;i.distanceFieldType==="none"?(C=new Bs(N.EMPTY),k=$.NORMAL):(C=new Bs(N.EMPTY,{program:ge.from(H0,z0),uniforms:{uFWidth:0}}),k=$.NORMAL_NPM);const X=new ts(G,C);X.blendMode=k,S={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:X,vertices:null,uvs:null,indices:null}}S.index=0,S.indexCount=0,S.vertexCount=0,S.uvsCount=0,S.total=0;const{_textureCache:O}=this;O[P]=O[P]||new N(D.baseTexture),S.mesh.texture=O[P],S.mesh.tint=this._tintColor.value,w.push(S),T[P]=S}T[P].total++}for(let I=0;I<E.length;I++)w.includes(E[I])||this.removeChild(E[I].mesh);for(let I=0;I<w.length;I++)w[I].mesh.parent!==this&&this.addChild(w[I].mesh);this._activePagesMeshData=w;for(const I in T){const D=T[I],P=D.total;if(!(((M=D.indices)==null?void 0:M.length)>6*P)||D.vertices.length<ts.BATCHABLE_SIZE*2)D.vertices=new Float32Array(4*2*P),D.uvs=new Float32Array(4*2*P),D.indices=new Uint16Array(6*P);else{const S=D.total,O=D.vertices;for(let G=S*4*2;G<O.length;G++)O[G]=0}D.mesh.size=6*P}for(let I=0;I<A;I++){const D=r[I];let P=D.position.x+b[D.line]*(this._align==="justify"?D.prevSpaces:1);this._roundPixels&&(P=Math.round(P));const S=P*e,O=D.position.y*e,G=D.texture,C=T[G.baseTexture.uid],k=G.frame,X=G._uvs,R=C.index++;C.indices[R*6+0]=0+R*4,C.indices[R*6+1]=1+R*4,C.indices[R*6+2]=2+R*4,C.indices[R*6+3]=0+R*4,C.indices[R*6+4]=2+R*4,C.indices[R*6+5]=3+R*4,C.vertices[R*8+0]=S,C.vertices[R*8+1]=O,C.vertices[R*8+2]=S+k.width*e,C.vertices[R*8+3]=O,C.vertices[R*8+4]=S+k.width*e,C.vertices[R*8+5]=O+k.height*e,C.vertices[R*8+6]=S,C.vertices[R*8+7]=O+k.height*e,C.uvs[R*8+0]=X.x0,C.uvs[R*8+1]=X.y0,C.uvs[R*8+2]=X.x1,C.uvs[R*8+3]=X.y1,C.uvs[R*8+4]=X.x2,C.uvs[R*8+5]=X.y2,C.uvs[R*8+6]=X.x3,C.uvs[R*8+7]=X.y3}this._textWidth=f*e,this._textHeight=(s.y+i.lineHeight)*e;for(const I in T){const D=T[I];if(this.anchor.x!==0||this.anchor.y!==0){let G=0;const C=this._textWidth*this.anchor.x,k=this._textHeight*this.anchor.y;for(let X=0;X<D.total;X++)D.vertices[G++]-=C,D.vertices[G++]-=k,D.vertices[G++]-=C,D.vertices[G++]-=k,D.vertices[G++]-=C,D.vertices[G++]-=k,D.vertices[G++]-=C,D.vertices[G++]-=k}this._maxLineHeight=v*e;const P=D.mesh.geometry.getBuffer("aVertexPosition"),S=D.mesh.geometry.getBuffer("aTextureCoord"),O=D.mesh.geometry.getIndex();P.data=D.vertices,S.data=D.uvs,O.data=D.indices,P.update(),S.update(),O.update()}for(let I=0;I<r.length;I++)Cu.push(r[I]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:s}=zt.available[this._fontName];if(e!=="none"){const{a:r,b:n,c:o,d:a}=this.worldTransform,h=Math.sqrt(r*r+n*n),l=Math.sqrt(o*o+a*a),u=(Math.abs(h)+Math.abs(l))/2,c=this.fontSize/s,d=i._view.resolution;for(const f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=u*t*c*d}super._render(i)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const i=zt.available[this._fontName];if(!i)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==i&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(i){if(this.tint!==i){this._tintColor.setValue(i);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=i}}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.dirty=!0)}get fontName(){return this._fontName}set fontName(i){if(!zt.available[i])throw new Error(`Missing BitmapFont "${i}"`);this._fontName!==i&&(this._fontName=i,this.dirty=!0)}get fontSize(){return this._fontSize??zt.available[this._fontName].size}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.dirty=!0)}get anchor(){return this._anchor}set anchor(i){typeof i=="number"?this._anchor.set(i):this._anchor.copyFrom(i)}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(i){this._maxWidth!==i&&(this._maxWidth=i,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(i){i!==this._roundPixels&&(this._roundPixels=i,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}destroy(i){const{_textureCache:t}=this,s=zt.available[this._fontName].distanceFieldType==="none"?Au:Su;s.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],s.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=N.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(i)}};let nf=rf;nf.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const V0=[".xml",".fnt"],of={extension:{type:L.LoadParser,priority:Le.Normal},name:"loadBitmapFont",test(i){return V0.includes(Bt.extname(i).toLowerCase())},async testParse(i){return cr.test(i)||to.test(i)},async parse(i,t,e){const s=cr.test(i)?cr.parse(i):to.parse(i),{src:r}=t,{page:n}=s,o=[];for(let l=0;l<n.length;++l){const u=n[l].file;let c=Bt.join(Bt.dirname(r),u);c=Yn(c,r),o.push(c)}const a=await e.load(o),h=o.map(l=>a[l]);return zt.install(s,h,!0)},async load(i,t){return(await B.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};z.add(of);const gs=class extends Ke{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(i){return new gs(Object.keys(gs.defaultOptions).reduce((t,e)=>({...t,[e]:i[e]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(i=>{URL.revokeObjectURL(i.src),i.refs--,i.refs===0&&(i.fontFace&&document.fonts.delete(i.fontFace),delete gs.availableFonts[i.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(i,t={}){const{availableFonts:e}=gs;if(e[i]){const s=e[i];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return B.ADAPTER.fetch(i).then(s=>s.blob()).then(async s=>new Promise((r,n)=>{const o=URL.createObjectURL(s),a=new FileReader;a.onload=()=>r([o,a.result]),a.onerror=n,a.readAsDataURL(s)})).then(async([s,r])=>{const n=Object.assign({family:Bt.basename(i,Bt.extname(i)),weight:"normal",style:"normal",src:s,dataSrc:r,refs:1,originalUrl:i,fontFace:null},t);e[i]=n,this._fonts.push(n),this.styleID++;const o=new FontFace(n.family,`url(${n.src})`,{weight:n.weight,style:n.style});n.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...i){const t=i.filter(e=>!this._overrides.includes(e));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...i){const t=i.filter(e=>this._overrides.includes(e));t.length>0&&(this._overrides=this._overrides.filter(e=>!t.includes(e)),this.styleID++)}toCSS(i){return[`transform: scale(${i})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((i,t)=>`${i}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(i){this._stylesheet!==i&&(this._stylesheet=i,this.styleID++)}normalizeColor(i){return Array.isArray(i)&&(i=zr(i)),typeof i=="number"?Ec(i):i}dropShadowToCSS(){let i=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,e=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);i.startsWith("#")&&t<1&&(i+=(t*255|0).toString(16).padStart(2,"0"));const r=`${e}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${r} ${this.dropShadowBlur}px ${i}`:`text-shadow: ${r} ${i}`}reset(){Object.assign(this,gs.defaultOptions)}onBeforeDraw(){const{fontsDirty:i}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&i?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:i}=B.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(i)}set fillGradientStops(i){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(i){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(i){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(i){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(i){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(i){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(i){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Ss=gs;Ss.availableFonts={};Ss.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const _s=class extends Je{constructor(i="",t={}){super(N.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const e=new Image,s=N.from(e,{scaleMode:B.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new Z,s.trim=new Z,this.texture=s;const r="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xhtml",o=document.createElementNS(r,"svg"),a=document.createElementNS(r,"foreignObject"),h=document.createElementNS(n,"div"),l=document.createElementNS(n,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=_s.defaultMaxWidth,this.maxHeight=_s.defaultMaxHeight,this._domElement=h,this._styleElement=l,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(l),this._foreignObject.appendChild(h),this._image=e,this._loadImage=new Image,this._autoResolution=_s.defaultAutoResolution,this._resolution=_s.defaultResolution??B.RESOLUTION,this.text=i,this.style=t}measureText(i){var a,h;const{text:t,style:e,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},i);Object.assign(this._domElement,{innerHTML:t,style:e.toCSS(s)}),this._styleElement.textContent=e.toGlobalCSS(),document.body.appendChild(this._svgRoot);const r=this._domElement.getBoundingClientRect();this._svgRoot.remove();const n=Math.min(this.maxWidth,Math.ceil(r.width)),o=Math.min(this.maxHeight,Math.ceil(r.height));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",o.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),e!==this._style&&(Object.assign(this._domElement,{style:(a=this._style)==null?void 0:a.toCSS(s)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:n+e.padding*2,height:o+e.padding*2}}async updateText(i=!0){const{style:t,_image:e,_loadImage:s}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;const{width:r,height:n}=this.measureText();e.width=s.width=Math.ceil(Math.max(1,r)),e.height=s.height=Math.ceil(Math.max(1,n)),this._loading||(this._loading=!0,await new Promise(o=>{s.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,e.src=s.src,s.onload=null,s.src="",this.updateTexture(),o()};const a=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){const{style:i,texture:t,_image:e,resolution:s}=this,{padding:r}=i,{baseTexture:n}=t;t.trim.width=t._frame.width=e.width/s,t.trim.height=t._frame.height=e.height/s,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,s),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}_renderCanvas(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(i)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds(i)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(i){var e,s,r,n,o;typeof i=="boolean"&&(i={children:i}),i=Object.assign({},_s.defaultDestroyOptions,i),super.destroy(i);const t=null;this.ownsStyle&&((e=this._style)==null||e.cleanFonts()),this._style=t,(s=this._svgRoot)==null||s.remove(),this._svgRoot=t,(r=this._domElement)==null||r.remove(),this._domElement=t,(n=this._foreignObject)==null||n.remove(),this._foreignObject=t,(o=this._styleElement)==null||o.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(i){this.updateText(!0);const t=ni(this.scale.x)||1;this.scale.x=t*i/this._image.width/this.resolution,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(i){this.updateText(!0);const t=ni(this.scale.y)||1;this.scale.y=t*i/this._image.height/this.resolution,this._height=i}get style(){return this._style}set style(i){this._style!==i&&(i=i||{},i instanceof Ss?(this.ownsStyle=!1,this._style=i):i instanceof Ke?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ss.from(i)):(this.ownsStyle=!0,this._style=new Ss(i)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(i){i=String(i===""||i===null||i===void 0?" ":i),i=this.sanitiseText(i),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}sanitiseText(i){return i.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let Jr=_s;Jr.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};Jr.defaultMaxWidth=2024;Jr.defaultMaxHeight=2024;Jr.defaultAutoResolution=!0;const $0=Object.freeze(Object.defineProperty({__proto__:null,ALPHA_MODES:we,AbstractMultiResource:Yh,AccessibilityManager:Kh,AlphaFilter:Ed,AnimatedSprite:Zn,Application:Co,ArrayResource:od,Assets:zi,AssetsClass:gd,Attribute:br,BLEND_MODES:$,BUFFER_BITS:Un,BUFFER_TYPE:De,BackgroundSystem:$r,BaseImageResource:hi,BasePrepare:Ir,BaseRenderTexture:Eh,BaseTexture:Y,BatchDrawCall:Xn,BatchGeometry:wh,BatchRenderer:de,BatchShaderGenerator:Vc,BatchSystem:Th,BatchTextureArray:Wn,BitmapFont:zt,BitmapFontData:Rr,BitmapText:nf,BlobResource:Fd,BlurFilter:Ad,BlurFilterPass:qn,Bounds:Er,BrowserAdapter:fc,Buffer:pt,BufferResource:$s,BufferSystem:Wh,CLEAR_MODES:Pe,COLOR_MASK_BITS:dc,Cache:ps,CanvasResource:ad,Circle:wo,Color:tt,ColorMatrixFilter:Kn,CompressedTextureResource:vi,Container:Ut,ContextSystem:Xr,CountLimiter:Kd,CubeResource:qh,DEG_TO_RAD:Ms,DRAW_MODES:Ie,DisplacementFilter:Sd,DisplayObject:lt,ENV:Si,Ellipse:To,EventBoundary:Id,EventSystem:Fs,ExtensionType:L,Extract:Qh,FORMATS:F,FORMATS_TO_COMPONENTS:kd,FXAAFilter:Cd,FederatedDisplayObject:Rd,FederatedEvent:Ws,FederatedMouseEvent:Ar,FederatedPointerEvent:ne,FederatedWheelEvent:Ji,FillStyle:Kr,Filter:Q,FilterState:Xc,FilterSystem:Ih,Framebuffer:jn,FramebufferSystem:Rh,GC_MODES:_o,GLFramebuffer:Wc,GLProgram:Kc,GLTexture:In,GRAPHICS_CURVES:h0,GenerateTextureSystem:Lh,Geometry:ai,GeometrySystem:Mh,Graphics:rs,GraphicsData:Pr,GraphicsGeometry:tl,HTMLText:Jr,HTMLTextStyle:Ss,IGLUniformData:Pg,INSTALLED:$n,INTERNAL_FORMATS:Ht,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:Sr,ImageBitmapResource:Gi,ImageResource:Ah,LINE_CAP:pi,LINE_JOIN:he,LineStyle:Ro,LoaderParserPriority:Le,MASK_TYPES:wt,MIPMAP_MODES:Oe,MSAA_QUALITY:xt,MaskData:Yc,MaskSystem:Dh,Matrix:ot,Mesh:ts,MeshBatchUvs:Xd,MeshGeometry:Zr,MeshMaterial:Bs,MultisampleSystem:Xh,NineSlicePlane:p0,NoiseFilter:Pd,ObjectRenderer:Vr,ObjectRendererSystem:jh,ObservablePoint:$e,PI_2:wr,PRECISION:ee,ParticleContainer:_0,ParticleRenderer:el,PlaneGeometry:jd,PluginSystem:kh,Point:K,Polygon:Xi,Prepare:il,Program:ge,ProjectionSystem:Oh,Quad:$c,QuadUv:Ph,RAD_TO_DEG:Fc,RENDERER_TYPE:gh,Rectangle:Z,RenderTexture:Ci,RenderTexturePool:Ch,RenderTextureSystem:Nh,Renderer:ss,ResizePlugin:Zh,Resource:Rs,RopeGeometry:Yd,RoundedRectangle:Eo,Runner:ie,SAMPLER_TYPES:Gn,SCALE_MODES:Re,SHAPES:Rt,SVGResource:Ds,ScissorSystem:Fh,Shader:Be,ShaderSystem:Uh,SimpleMesh:m0,SimplePlane:qd,SimpleRope:g0,Sprite:Je,SpriteMaskFilter:jc,Spritesheet:Qn,StartupSystem:Wr,State:Qe,StateSystem:Gh,StencilSystem:Bh,SystemManager:id,TARGETS:Vi,TEXT_GRADIENT:Qr,TYPES:V,TYPES_TO_BYTES_PER_COMPONENT:za,TYPES_TO_BYTES_PER_PIXEL:Od,TemporaryDisplayObject:wd,Text:ji,TextFormat:cr,TextMetrics:It,TextStyle:Ke,Texture:N,TextureGCSystem:fe,TextureMatrix:Ao,TextureSystem:zh,TextureUvs:Sh,Ticker:vt,TickerPlugin:Vh,TilingSprite:sl,TilingSpriteRenderer:rl,TimeLimiter:D0,Transform:Hr,TransformFeedback:Xg,TransformFeedbackSystem:Hh,UPDATE_PRIORITY:li,UniformGroup:ye,VERSION:Wg,VideoResource:So,ViewSystem:jr,ViewableBuffer:Vn,WRAP_MODES:We,XMLFormat:Jn,XMLStringFormat:to,accessibleTarget:Md,autoDetectFormat:ef,autoDetectRenderer:rd,autoDetectResource:bh,cacheTextureArray:_d,checkDataUrl:Xs,checkExtension:Pi,checkMaxIfStatementsInShader:Dc,convertToList:je,copySearchParams:Yn,createStringVariations:ld,createTexture:Yr,createUBOElements:Jc,curves:Ti,defaultFilterVertex:$h,defaultVertex:nd,detectAvif:xd,detectCompressedTextures:Dd,detectDefaults:yd,detectWebp:vd,extensions:z,filters:La,generateProgram:Zc,generateUniformBufferSync:ed,getFontFamilyName:dd,getTestContext:Uc,getUBOData:td,graphicsUtils:c0,groupD8:ht,isMobile:Me,isSingleItem:Tr,loadBitmapFont:of,loadDDS:Nd,loadImageBitmap:pd,loadJson:ud,loadKTX:Ud,loadSVG:md,loadTextures:qr,loadTxt:cd,loadWebFont:fd,parseDDS:Bd,parseKTX:Ld,resolveCompressedTextureUrl:Gd,resolveTextureUrl:bd,settings:B,spritesheetAsset:tf,uniformParsers:Wi,unsafeEvalSupported:Hc,utils:Zm},Symbol.toStringTag,{value:"Module"}));function si(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function af(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.__proto__=t}/*!
 * GSAP 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var se={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ks={duration:.5,overwrite:!1,delay:0},nl,Lt,mt,_e=1e8,rt=1/_e,Wa=Math.PI*2,X0=Wa/4,W0=0,hf=Math.sqrt,j0=Math.cos,Y0=Math.sin,Mt=function(t){return typeof t=="string"},gt=function(t){return typeof t=="function"},ui=function(t){return typeof t=="number"},ol=function(t){return typeof t>"u"},Ze=function(t){return typeof t=="object"},$t=function(t){return t!==!1},al=function(){return typeof window<"u"},Tn=function(t){return gt(t)||Mt(t)},lf=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Nt=Array.isArray,ja=/(?:-?\.?\d|\.)+/gi,uf=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,vs=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,aa=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,cf=/[+-]=-?[.\d]+/,df=/[^,'"\[\]\s]+/gi,q0=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ut,ae,Ya,hl,re={},eo={},ff,pf=function(t){return(eo=es(t,re))&&jt},ll=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},io=function(t,e){return!e&&console.warn(t)},mf=function(t,e){return t&&(re[t]=e)&&eo&&(eo[t]=e)||re},Mr=function(){return 0},K0={suppressEvents:!0,isStart:!0,kill:!1},Bn={suppressEvents:!0,kill:!1},Z0={suppressEvents:!0},ul={},yi=[],qa={},gf,Qt={},ha={},Pu=30,kn=[],cl="",dl=function(t){var e=t[0],s,r;if(Ze(e)||gt(e)||(t=[t]),!(s=(e._gsap||{}).harness)){for(r=kn.length;r--&&!kn[r].targetTest(e););s=kn[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new Gf(t[r],s)))||t.splice(r,1);return t},Yi=function(t){return t._gsap||dl(xe(t))[0]._gsap},_f=function(t,e,s){return(s=t[e])&&gt(s)?t[e]():ol(s)&&t.getAttribute&&t.getAttribute(e)||s},Xt=function(t,e){return(t=t.split(",")).forEach(e)||t},_t=function(t){return Math.round(t*1e5)/1e5||0},Ft=function(t){return Math.round(t*1e7)/1e7||0},Cs=function(t,e){var s=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),s==="+"?t+r:s==="-"?t-r:s==="*"?t*r:t/r},Q0=function(t,e){for(var s=e.length,r=0;t.indexOf(e[r])<0&&++r<s;);return r<s},so=function(){var t=yi.length,e=yi.slice(0),s,r;for(qa={},yi.length=0,s=0;s<t;s++)r=e[s],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},xf=function(t,e,s,r){yi.length&&!Lt&&so(),t.render(e,s,r||Lt&&e<0&&(t._initted||t._startAt)),yi.length&&!Lt&&so()},vf=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(df).length<2?e:Mt(t)?t.trim():t},yf=function(t){return t},be=function(t,e){for(var s in e)s in t||(t[s]=e[s]);return t},J0=function(t){return function(e,s){for(var r in s)r in e||r==="duration"&&t||r==="ease"||(e[r]=s[r])}},es=function(t,e){for(var s in e)t[s]=e[s];return t},Iu=function i(t,e){for(var s in e)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=Ze(e[s])?i(t[s]||(t[s]={}),e[s]):e[s]);return t},ro=function(t,e){var s={},r;for(r in t)r in e||(s[r]=t[r]);return s},dr=function(t){var e=t.parent||ut,s=t.keyframes?J0(Nt(t.keyframes)):be;if($t(t.inherit))for(;e;)s(t,e.vars.defaults),e=e.parent||e._dp;return t},tx=function(t,e){for(var s=t.length,r=s===e.length;r&&s--&&t[s]===e[s];);return s<0},bf=function(t,e,s,r,n){s===void 0&&(s="_first"),r===void 0&&(r="_last");var o=t[r],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[s],t[s]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},Mo=function(t,e,s,r){s===void 0&&(s="_first"),r===void 0&&(r="_last");var n=e._prev,o=e._next;n?n._next=o:t[s]===e&&(t[s]=o),o?o._prev=n:t[r]===e&&(t[r]=n),e._next=e._prev=e.parent=null},Ei=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},qi=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},ex=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Ka=function(t,e,s,r){return t._startAt&&(Lt?t._startAt.revert(Bn):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},ix=function i(t){return!t||t._ts&&i(t.parent)},Ru=function(t){return t._repeat?Os(t._tTime,t=t.duration()+t._rDelay)*t:0},Os=function(t,e){var s=Math.floor(t/=e);return t&&s===t?s-1:s},no=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Do=function(t){return t._end=Ft(t._start+(t._tDur/Math.abs(t._ts||t._rts||rt)||0))},Fo=function(t,e){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=Ft(s._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Do(t),s._dirty||qi(s,t)),t},wf=function(t,e){var s;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(s=no(t.rawTime(),e),(!e._dur||tn(0,e.totalDuration(),s)-e._tTime>rt)&&e.render(s,!0)),qi(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-rt}},Ve=function(t,e,s,r){return e.parent&&Ei(e),e._start=Ft((ui(s)?s:s||t!==ut?oe(t,s,e):t._time)+e._delay),e._end=Ft(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),bf(t,e,"_first","_last",t._sort?"_start":0),Za(e)||(t._recent=e),r||wf(t,e),t._ts<0&&Fo(t,t._tTime),t},Tf=function(t,e){return(re.ScrollTrigger||ll("scrollTrigger",e))&&re.ScrollTrigger.create(e,t)},Ef=function(t,e,s,r,n){if(pl(t,e,n),!t._initted)return 1;if(!s&&t._pt&&!Lt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&gf!==Jt.frame)return yi.push(t),t._lazy=[n,r],1},sx=function i(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||i(e))},Za=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},rx=function(t,e,s,r){var n=t.ratio,o=e<0||!e&&(!t._start&&sx(t)&&!(!t._initted&&Za(t))||(t._ts<0||t._dp._ts<0)&&!Za(t))?0:1,a=t._rDelay,h=0,l,u,c;if(a&&t._repeat&&(h=tn(0,t._tDur,e),u=Os(h,a),t._yoyo&&u&1&&(o=1-o),u!==Os(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||Lt||r||t._zTime===rt||!e&&t._zTime){if(!t._initted&&Ef(t,e,r,s,h))return;for(c=t._zTime,t._zTime=e||(s?rt:0),s||(s=e&&!c),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&Ka(t,e,s,!0),t._onUpdate&&!s&&ve(t,"onUpdate"),h&&t._repeat&&!s&&t.parent&&ve(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&Ei(t,1),!s&&!Lt&&(ve(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},nx=function(t,e,s){var r;if(s>e)for(r=t._first;r&&r._start<=s;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=s;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},Ls=function(t,e,s,r){var n=t._repeat,o=Ft(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:Ft(o*(n+1)+t._rDelay*n):o,a>0&&!r&&Fo(t,t._tTime=t._tDur*a),t.parent&&Do(t),s||qi(t.parent,t),t},Mu=function(t){return t instanceof Vt?qi(t):Ls(t,t._dur)},ox={_start:0,endTime:Mr,totalDuration:Mr},oe=function i(t,e,s){var r=t.labels,n=t._recent||ox,o=t.duration()>=_e?n.endTime(!1):t._dur,a,h,l;return Mt(e)&&(isNaN(e)||e in r)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:s).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&s&&(h=h/100*(Nt(s)?s[0]:s).totalDuration()),a>1?i(t,e.substr(0,a-1),s)+h:o+h)):e==null?o:+e},fr=function(t,e,s){var r=ui(e[1]),n=(r?2:1)+(t<2?0:1),o=e[n],a,h;if(r&&(o.duration=e[1]),o.parent=s,t){for(a=o,h=s;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=$t(h.vars.inherit)&&h.parent;o.immediateRender=$t(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new Tt(e[0],o,e[n+1])},Ii=function(t,e){return t||t===0?e(t):e},tn=function(t,e,s){return s<t?t:s>e?e:s},Ot=function(t,e){return!Mt(t)||!(e=q0.exec(t))?"":e[1]},ax=function(t,e,s){return Ii(s,function(r){return tn(t,e,r)})},Qa=[].slice,Af=function(t,e){return t&&Ze(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Ze(t[0]))&&!t.nodeType&&t!==ae},hx=function(t,e,s){return s===void 0&&(s=[]),t.forEach(function(r){var n;return Mt(r)&&!e||Af(r,1)?(n=s).push.apply(n,xe(r)):s.push(r)})||s},xe=function(t,e,s){return mt&&!e&&mt.selector?mt.selector(t):Mt(t)&&!s&&(Ya||!Ns())?Qa.call((e||hl).querySelectorAll(t),0):Nt(t)?hx(t,s):Af(t)?Qa.call(t,0):t?[t]:[]},Ja=function(t){return t=xe(t)[0]||io("Invalid scope")||{},function(e){var s=t.current||t.nativeElement||t;return xe(e,s.querySelectorAll?s:s===t?io("Invalid scope")||hl.createElement("div"):t)}},Sf=function(t){return t.sort(function(){return .5-Math.random()})},Cf=function(t){if(gt(t))return t;var e=Ze(t)?t:{each:t},s=Ki(e.ease),r=e.from||0,n=parseFloat(e.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,l=e.axis,u=r,c=r;return Mt(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(u=r[0],c=r[1]),function(d,f,p){var m=(p||e).length,g=o[m],x,v,_,y,b,A,T,w,E;if(!g){if(E=e.grid==="auto"?0:(e.grid||[1,_e])[1],!E){for(T=-_e;T<(T=p[E++].getBoundingClientRect().left)&&E<m;);E--}for(g=o[m]=[],x=h?Math.min(E,m)*u-.5:r%E,v=E===_e?0:h?m*c/E-.5:r/E|0,T=0,w=_e,A=0;A<m;A++)_=A%E-x,y=v-(A/E|0),g[A]=b=l?Math.abs(l==="y"?y:_):hf(_*_+y*y),b>T&&(T=b),b<w&&(w=b);r==="random"&&Sf(g),g.max=T-w,g.min=w,g.v=m=(parseFloat(e.amount)||parseFloat(e.each)*(E>m?m-1:l?l==="y"?m/E:E:Math.max(E,m/E))||0)*(r==="edges"?-1:1),g.b=m<0?n-m:n,g.u=Ot(e.amount||e.each)||0,s=s&&m<0?Lf(s):s}return m=(g[d]-g.min)/g.max||0,Ft(g.b+(s?s(m):m)*g.v)+g.u}},th=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var r=Ft(Math.round(parseFloat(s)/t)*t*e);return(r-r%1)/e+(ui(s)?0:Ot(s))}},Pf=function(t,e){var s=Nt(t),r,n;return!s&&Ze(t)&&(r=s=t.radius||_e,t.values?(t=xe(t.values),(n=!ui(t[0]))&&(r*=r)):t=th(t.increment)),Ii(e,s?gt(t)?function(o){return n=t(o),Math.abs(n-o)<=r?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=_e,u=0,c=t.length,d,f;c--;)n?(d=t[c].x-a,f=t[c].y-h,d=d*d+f*f):d=Math.abs(t[c]-a),d<l&&(l=d,u=c);return u=!r||l<=r?t[u]:o,n||u===o||ui(o)?u:u+Ot(o)}:th(t))},If=function(t,e,s,r){return Ii(Nt(t)?!e:s===!0?!!(s=0):!r,function(){return Nt(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(r=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(e-t+s*.99))/s)*s*r)/r})},lx=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return function(r){return e.reduce(function(n,o){return o(n)},r)}},ux=function(t,e){return function(s){return t(parseFloat(s))+(e||Ot(s))}},cx=function(t,e,s){return Mf(t,e,0,1,s)},Rf=function(t,e,s){return Ii(s,function(r){return t[~~e(r)]})},dx=function i(t,e,s){var r=e-t;return Nt(t)?Rf(t,i(0,t.length),e):Ii(s,function(n){return(r+(n-t)%r)%r+t})},fx=function i(t,e,s){var r=e-t,n=r*2;return Nt(t)?Rf(t,i(0,t.length-1),e):Ii(s,function(o){return o=(n+(o-t)%n)%n||0,t+(o>r?n-o:o)})},Dr=function(t){for(var e=0,s="",r,n,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",n=t.substr(r+7,o-r-7).match(a?df:ja),s+=t.substr(e,r-e)+If(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return s+t.substr(e,t.length-e)},Mf=function(t,e,s,r,n){var o=e-t,a=r-s;return Ii(n,function(h){return s+((h-t)/o*a||0)})},px=function i(t,e,s,r){var n=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!n){var o=Mt(t),a={},h,l,u,c,d;if(s===!0&&(r=1)&&(s=null),o)t={p:t},e={p:e};else if(Nt(t)&&!Nt(e)){for(u=[],c=t.length,d=c-2,l=1;l<c;l++)u.push(i(t[l-1],t[l]));c--,n=function(p){p*=c;var m=Math.min(d,~~p);return u[m](p-m)},s=e}else r||(t=es(Nt(t)?[]:{},t));if(!u){for(h in e)fl.call(a,t,h,"get",e[h]);n=function(p){return _l(p,a)||(o?t.p:t)}}}return Ii(s,n)},Du=function(t,e,s){var r=t.labels,n=_e,o,a,h;for(o in r)a=r[o]-e,a<0==!!s&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},ve=function(t,e,s){var r=t.vars,n=r[e],o=mt,a=t._ctx,h,l,u;if(n)return h=r[e+"Params"],l=r.callbackScope||t,s&&yi.length&&so(),a&&(mt=a),u=h?n.apply(l,h):n.call(l),mt=o,u},hr=function(t){return Ei(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Lt),t.progress()<1&&ve(t,"onInterrupt"),t},ys,Df=[],Ff=function(t){if(al()&&t){t=!t.name&&t.default||t;var e=t.name,s=gt(t),r=e&&!s&&t.init?function(){this._props=[]}:t,n={init:Mr,render:_l,add:fl,kill:Rx,modifier:Ix,rawVars:0},o={targetTest:0,get:0,getSetter:gl,aliases:{},register:0};if(Ns(),t!==r){if(Qt[e])return;be(r,be(ro(t,n),o)),es(r.prototype,es(n,ro(t,o))),Qt[r.prop=e]=r,t.targetTest&&(kn.push(r),ul[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}mf(e,r),t.register&&t.register(jt,r,Wt)}else t&&Df.push(t)},st=255,lr={aqua:[0,st,st],lime:[0,st,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,st],navy:[0,0,128],white:[st,st,st],olive:[128,128,0],yellow:[st,st,0],orange:[st,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[st,0,0],pink:[st,192,203],cyan:[0,st,st],transparent:[st,st,st,0]},la=function(t,e,s){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(s-e)*t*6:t<.5?s:t*3<2?e+(s-e)*(2/3-t)*6:e)*st+.5|0},Bf=function(t,e,s){var r=t?ui(t)?[t>>16,t>>8&st,t&st]:0:lr.black,n,o,a,h,l,u,c,d,f,p;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),lr[t])r=lr[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&st,r&st,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&st,t&st]}else if(t.substr(0,3)==="hsl"){if(r=p=t.match(ja),!e)h=+r[0]%360/360,l=+r[1]/100,u=+r[2]/100,o=u<=.5?u*(l+1):u+l-u*l,n=u*2-o,r.length>3&&(r[3]*=1),r[0]=la(h+1/3,n,o),r[1]=la(h,n,o),r[2]=la(h-1/3,n,o);else if(~t.indexOf("="))return r=t.match(uf),s&&r.length<4&&(r[3]=1),r}else r=t.match(ja)||lr.transparent;r=r.map(Number)}return e&&!p&&(n=r[0]/st,o=r[1]/st,a=r[2]/st,c=Math.max(n,o,a),d=Math.min(n,o,a),u=(c+d)/2,c===d?h=l=0:(f=c-d,l=u>.5?f/(2-c-d):f/(c+d),h=c===n?(o-a)/f+(o<a?6:0):c===o?(a-n)/f+2:(n-o)/f+4,h*=60),r[0]=~~(h+.5),r[1]=~~(l*100+.5),r[2]=~~(u*100+.5)),s&&r.length<4&&(r[3]=1),r},kf=function(t){var e=[],s=[],r=-1;return t.split(bi).forEach(function(n){var o=n.match(vs)||[];e.push.apply(e,o),s.push(r+=o.length+1)}),e.c=s,e},Fu=function(t,e,s){var r="",n=(t+r).match(bi),o=e?"hsla(":"rgba(",a=0,h,l,u,c;if(!n)return t;if(n=n.map(function(d){return(d=Bf(d,e,1))&&o+(e?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),s&&(u=kf(t),h=s.c,h.join(r)!==u.c.join(r)))for(l=t.replace(bi,"1").split(vs),c=l.length-1;a<c;a++)r+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(u.length?u:n.length?n:s).shift());if(!l)for(l=t.split(bi),c=l.length-1;a<c;a++)r+=l[a]+n[a];return r+l[c]},bi=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in lr)i+="|"+t+"\\b";return new RegExp(i+")","gi")}(),mx=/hsl[a]?\(/,Of=function(t){var e=t.join(" "),s;if(bi.lastIndex=0,bi.test(e))return s=mx.test(e),t[1]=Fu(t[1],s),t[0]=Fu(t[0],s,kf(t[1])),!0},Fr,Jt=function(){var i=Date.now,t=500,e=33,s=i(),r=s,n=1e3/240,o=n,a=[],h,l,u,c,d,f,p=function m(g){var x=i()-r,v=g===!0,_,y,b,A;if(x>t&&(s+=x-e),r+=x,b=r-s,_=b-o,(_>0||v)&&(A=++c.frame,d=b-c.time*1e3,c.time=b=b/1e3,o+=_+(_>=n?4:n-_),y=1),v||(h=l(m)),y)for(f=0;f<a.length;f++)a[f](b,d,A,g)};return c={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){ff&&(!Ya&&al()&&(ae=Ya=window,hl=ae.document||{},re.gsap=jt,(ae.gsapVersions||(ae.gsapVersions=[])).push(jt.version),pf(eo||ae.GreenSockGlobals||!ae.gsap&&ae||{}),u=ae.requestAnimationFrame,Df.forEach(Ff)),h&&c.sleep(),l=u||function(g){return setTimeout(g,o-c.time*1e3+1|0)},Fr=1,p(2))},sleep:function(){(u?ae.cancelAnimationFrame:clearTimeout)(h),Fr=0,l=Mr},lagSmoothing:function(g,x){t=g||1/0,e=Math.min(x||33,t)},fps:function(g){n=1e3/(g||240),o=c.time*1e3+n},add:function(g,x,v){var _=x?function(y,b,A,T){g(y,b,A,T),c.remove(_)}:g;return c.remove(g),a[v?"unshift":"push"](_),Ns(),_},remove:function(g,x){~(x=a.indexOf(g))&&a.splice(x,1)&&f>=x&&f--},_listeners:a},c}(),Ns=function(){return!Fr&&Jt.wake()},et={},gx=/^[\d.\-M][\d.\-,\s]/,_x=/["']/g,xx=function(t){for(var e={},s=t.substr(1,t.length-3).split(":"),r=s[0],n=1,o=s.length,a,h,l;n<o;n++)h=s[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[r]=isNaN(l)?l.replace(_x,"").trim():+l,r=h.substr(a+1).trim();return e},vx=function(t){var e=t.indexOf("(")+1,s=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<s?t.indexOf(")",s+1):s)},yx=function(t){var e=(t+"").split("("),s=et[e[0]];return s&&e.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[xx(e[1])]:vx(t).split(",").map(vf)):et._CE&&gx.test(t)?et._CE("",t):s},Lf=function(t){return function(e){return 1-t(1-e)}},Nf=function i(t,e){for(var s=t._first,r;s;)s instanceof Vt?i(s,e):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==e&&(s.timeline?i(s.timeline,e):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=e)),s=s._next},Ki=function(t,e){return t&&(gt(t)?t:et[t]||yx(t))||e},ns=function(t,e,s,r){s===void 0&&(s=function(h){return 1-e(1-h)}),r===void 0&&(r=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:s,easeInOut:r},o;return Xt(t,function(a){et[a]=re[a]=n,et[o=a.toLowerCase()]=s;for(var h in n)et[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=et[a+"."+h]=n[h]}),n},Uf=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},ua=function i(t,e,s){var r=e>=1?e:1,n=(s||(t?.3:.45))/(e<1?e:1),o=n/Wa*(Math.asin(1/r)||0),a=function(u){return u===1?1:r*Math.pow(2,-10*u)*Y0((u-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:Uf(a);return n=Wa/n,h.config=function(l,u){return i(t,l,u)},h},ca=function i(t,e){e===void 0&&(e=1.70158);var s=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?s:t==="in"?function(n){return 1-s(1-n)}:Uf(s);return r.config=function(n){return i(t,n)},r};Xt("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,t){var e=t<5?t+1:t;ns(i+",Power"+(e-1),t?function(s){return Math.pow(s,e)}:function(s){return s},function(s){return 1-Math.pow(1-s,e)},function(s){return s<.5?Math.pow(s*2,e)/2:1-Math.pow((1-s)*2,e)/2})});et.Linear.easeNone=et.none=et.Linear.easeIn;ns("Elastic",ua("in"),ua("out"),ua());(function(i,t){var e=1/t,s=2*e,r=2.5*e,n=function(a){return a<e?i*a*a:a<s?i*Math.pow(a-1.5/t,2)+.75:a<r?i*(a-=2.25/t)*a+.9375:i*Math.pow(a-2.625/t,2)+.984375};ns("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);ns("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});ns("Circ",function(i){return-(hf(1-i*i)-1)});ns("Sine",function(i){return i===1?1:-j0(i*X0)+1});ns("Back",ca("in"),ca("out"),ca());et.SteppedEase=et.steps=re.SteppedEase={config:function(t,e){t===void 0&&(t=1);var s=1/t,r=t+(e?0:1),n=e?1:0,o=1-rt;return function(a){return((r*tn(0,o,a)|0)+n)*s}}};ks.ease=et["quad.out"];Xt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return cl+=i+","+i+"Params,"});var Gf=function(t,e){this.id=W0++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:_f,this.set=e?e.getSetter:gl},Br=function(){function i(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Ls(this,+e.duration,1,1),this.data=e.data,mt&&(this._ctx=mt,mt.data.push(this)),Fr||Jt.wake()}var t=i.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,Ls(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,r){if(Ns(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Fo(this,s),!n._dp||n.parent||wf(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Ve(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===rt||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),xf(this,s,r)),this},t.time=function(s,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+Ru(this))%(this._dur+this._rDelay)||(s?this._dur:0),r):this._time},t.totalProgress=function(s,r){return arguments.length?this.totalTime(this.totalDuration()*s,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(s,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+Ru(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(s,r){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*n,r):this._repeat?Os(this._tTime,n)+1:1},t.timeScale=function(s){if(!arguments.length)return this._rts===-rt?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?no(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-rt?0:this._rts,this.totalTime(tn(-Math.abs(this._delay),this._tDur,r),!0),Do(this),ex(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ns(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==rt&&(this._tTime-=rt)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Ve(r,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+($t(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var r=this.parent||this._dp;return r?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?no(r.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=Z0);var r=Lt;return Lt=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),Lt=r,this},t.globalTime=function(s){for(var r=this,n=arguments.length?s:r.rawTime();r;)n=r._start+n/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(s):n},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,Mu(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var r=this._time;return this._rDelay=s,Mu(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,r){return this.totalTime(oe(this,s),$t(r))},t.restart=function(s,r){return this.play().totalTime(s?-this._delay:0,$t(r))},t.play=function(s,r){return s!=null&&this.seek(s,r),this.reversed(!1).paused(!1)},t.reverse=function(s,r){return s!=null&&this.seek(s||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(s,r){return s!=null&&this.seek(s,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-rt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-rt,this},t.isActive=function(){var s=this.parent||this._dp,r=this._start,n;return!!(!s||this._ts&&this._initted&&s.isActive()&&(n=s.rawTime(!0))>=r&&n<this.endTime(!0)-rt)},t.eventCallback=function(s,r,n){var o=this.vars;return arguments.length>1?(r?(o[s]=r,n&&(o[s+"Params"]=n),s==="onUpdate"&&(this._onUpdate=r)):delete o[s],this):o[s]},t.then=function(s){var r=this;return new Promise(function(n){var o=gt(s)?s:yf,a=function(){var l=r.then;r.then=null,gt(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),n(o),r.then=l};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){hr(this)},i}();be(Br.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-rt,_prom:0,_ps:!1,_rts:1});var Vt=function(i){af(t,i);function t(s,r){var n;return s===void 0&&(s={}),n=i.call(this,s)||this,n.labels={},n.smoothChildTiming=!!s.smoothChildTiming,n.autoRemoveChildren=!!s.autoRemoveChildren,n._sort=$t(s.sortChildren),ut&&Ve(s.parent||ut,si(n),r),s.reversed&&n.reverse(),s.paused&&n.paused(!0),s.scrollTrigger&&Tf(si(n),s.scrollTrigger),n}var e=t.prototype;return e.to=function(r,n,o){return fr(0,arguments,this),this},e.from=function(r,n,o){return fr(1,arguments,this),this},e.fromTo=function(r,n,o,a){return fr(2,arguments,this),this},e.set=function(r,n,o){return n.duration=0,n.parent=this,dr(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Tt(r,n,oe(this,o),1),this},e.call=function(r,n,o){return Ve(this,Tt.delayedCall(0,r,n),o)},e.staggerTo=function(r,n,o,a,h,l,u){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new Tt(r,o,oe(this,h)),this},e.staggerFrom=function(r,n,o,a,h,l,u){return o.runBackwards=1,dr(o).immediateRender=$t(o.immediateRender),this.staggerTo(r,n,o,a,h,l,u)},e.staggerFromTo=function(r,n,o,a,h,l,u,c){return a.startAt=o,dr(a).immediateRender=$t(a.immediateRender),this.staggerTo(r,n,a,h,l,u,c)},e.render=function(r,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=r<=0?0:Ft(r),c=this._zTime<0!=r<0&&(this._initted||!l),d,f,p,m,g,x,v,_,y,b,A,T;if(this!==ut&&u>h&&r>=0&&(u=h),u!==this._tTime||o||c){if(a!==this._time&&l&&(u+=this._time-a,r+=this._time-a),d=u,y=this._start,_=this._ts,x=!_,c&&(l||(a=this._zTime),(r||!n)&&(this._zTime=r)),this._repeat){if(A=this._yoyo,g=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(g*100+r,n,o);if(d=Ft(u%g),u===h?(m=this._repeat,d=l):(m=~~(u/g),m&&m===u/g&&(d=l,m--),d>l&&(d=l)),b=Os(this._tTime,g),!a&&this._tTime&&b!==m&&this._tTime-b*g-this._dur<=0&&(b=m),A&&m&1&&(d=l-d,T=1),m!==b&&!this._lock){var w=A&&b&1,E=w===(A&&m&1);if(m<b&&(w=!w),a=w?0:u%l?l:u,this._lock=1,this.render(a||(T?0:Ft(m*g)),n,!l)._lock=0,this._tTime=u,!n&&this.parent&&ve(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,E&&(this._lock=2,a=w?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;Nf(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=nx(this,Ft(a),Ft(d)),v&&(u-=d-(d=v._start))),this._tTime=u,this._time=d,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!n&&!m&&(ve(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,o),d!==this._time||!this._ts&&!x){v=0,p&&(u+=this._zTime=-rt);break}}f=p}else{f=this._last;for(var M=r<0?r:d;f;){if(p=f._prev,(f._act||M<=f._end)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(M-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(M-f._start)*f._ts,n,o||Lt&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!x){v=0,p&&(u+=this._zTime=M?-rt:rt);break}}f=p}}if(v&&!n&&(this.pause(),v.render(d>=a?0:-rt)._zTime=d>=a?1:-1,this._ts))return this._start=y,Do(this),this.render(r,n,o);this._onUpdate&&!n&&ve(this,"onUpdate",!0),(u===h&&this._tTime>=this.totalDuration()||!u&&a)&&(y===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(u===h&&this._ts>0||!u&&this._ts<0)&&Ei(this,1),!n&&!(r<0&&!a)&&(u||a||!h)&&(ve(this,u===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,n){var o=this;if(ui(n)||(n=oe(this,n,r)),!(r instanceof Br)){if(Nt(r))return r.forEach(function(a){return o.add(a,n)}),this;if(Mt(r))return this.addLabel(r,n);if(gt(r))r=Tt.delayedCall(0,r);else return this}return this!==r?Ve(this,r,n):this},e.getChildren=function(r,n,o,a){r===void 0&&(r=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-_e);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof Tt?n&&h.push(l):(o&&h.push(l),r&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(r){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===r)return n[o]},e.remove=function(r){return Mt(r)?this.removeLabel(r):gt(r)?this.killTweensOf(r):(Mo(this,r),r===this._recent&&(this._recent=this._last),qi(this))},e.totalTime=function(r,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ft(Jt.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,n),this._forcing=0,this):this._tTime},e.addLabel=function(r,n){return this.labels[r]=oe(this,n),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,n,o){var a=Tt.delayedCall(0,n||Mr,o);return a.data="isPause",this._hasPause=1,Ve(this,a,oe(this,r))},e.removePause=function(r){var n=this._first;for(r=oe(this,r);n;)n._start===r&&n.data==="isPause"&&Ei(n),n=n._next},e.killTweensOf=function(r,n,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)mi!==a[h]&&a[h].kill(r,n);return this},e.getTweensOf=function(r,n){for(var o=[],a=xe(r),h=this._first,l=ui(n),u;h;)h instanceof Tt?Q0(h._targets,a)&&(l?(!mi||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(u=h.getTweensOf(a,n)).length&&o.push.apply(o,u),h=h._next;return o},e.tweenTo=function(r,n){n=n||{};var o=this,a=oe(o,r),h=n,l=h.startAt,u=h.onStart,c=h.onStartParams,d=h.immediateRender,f,p=Tt.to(o,be({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||rt,onStart:function(){if(o.pause(),!f){var g=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());p._dur!==g&&Ls(p,g,0,1).render(p._time,!0,!0),f=1}u&&u.apply(p,c||[])}},n));return d?p.render(0):p},e.tweenFromTo=function(r,n,o){return this.tweenTo(n,be({startAt:{time:oe(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),Du(this,oe(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),Du(this,oe(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+rt)},e.shiftChildren=function(r,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=r);return qi(this)},e.invalidate=function(r){var n=this._first;for(this._lock=0;n;)n.invalidate(r),n=n._next;return i.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),qi(this)},e.totalDuration=function(r){var n=0,o=this,a=o._last,h=_e,l,u,c;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(c=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ve(o,a,u-a._delay,1)._lock=0):h=u,u<0&&a._ts&&(n-=u,(!c&&!o._dp||c&&c.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;Ls(o,o===ut&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(ut._ts&&(xf(ut,no(r,ut)),gf=Jt.frame),Jt.frame>=Pu){Pu+=se.autoSleep||120;var n=ut._first;if((!n||!n._ts)&&se.autoSleep&&Jt._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||Jt.sleep()}}},t}(Br);be(Vt.prototype,{_lock:0,_hasPause:0,_forcing:0});var bx=function(t,e,s,r,n,o,a){var h=new Wt(this._pt,t,e,0,1,Wf,null,n),l=0,u=0,c,d,f,p,m,g,x,v;for(h.b=s,h.e=r,s+="",r+="",(x=~r.indexOf("random("))&&(r=Dr(r)),o&&(v=[s,r],o(v,t,e),s=v[0],r=v[1]),d=s.match(aa)||[];c=aa.exec(r);)p=c[0],m=r.substring(l,c.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),p!==d[u++]&&(g=parseFloat(d[u-1])||0,h._pt={_next:h._pt,p:m||u===1?m:",",s:g,c:p.charAt(1)==="="?Cs(g,p)-g:parseFloat(p)-g,m:f&&f<4?Math.round:0},l=aa.lastIndex);return h.c=l<r.length?r.substring(l,r.length):"",h.fp=a,(cf.test(r)||x)&&(h.e=0),this._pt=h,h},fl=function(t,e,s,r,n,o,a,h,l,u){gt(r)&&(r=r(n||0,t,o));var c=t[e],d=s!=="get"?s:gt(c)?l?t[e.indexOf("set")||!gt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():c,f=gt(c)?l?Sx:$f:ml,p;if(Mt(r)&&(~r.indexOf("random(")&&(r=Dr(r)),r.charAt(1)==="="&&(p=Cs(d,r)+(Ot(d)||0),(p||p===0)&&(r=p))),!u||d!==r||eh)return!isNaN(d*r)&&r!==""?(p=new Wt(this._pt,t,e,+d||0,r-(d||0),typeof c=="boolean"?Px:Xf,0,f),l&&(p.fp=l),a&&p.modifier(a,this,t),this._pt=p):(!c&&!(e in t)&&ll(e,r),bx.call(this,t,e,d,r,f,h||se.stringFilter,l))},wx=function(t,e,s,r,n){if(gt(t)&&(t=pr(t,n,e,s,r)),!Ze(t)||t.style&&t.nodeType||Nt(t)||lf(t))return Mt(t)?pr(t,n,e,s,r):t;var o={},a;for(a in t)o[a]=pr(t[a],n,e,s,r);return o},zf=function(t,e,s,r,n,o){var a,h,l,u;if(Qt[t]&&(a=new Qt[t]).init(n,a.rawVars?e[t]:wx(e[t],r,n,o,s),s,r,o)!==!1&&(s._pt=h=new Wt(s._pt,n,t,0,1,a.render,a,0,a.priority),s!==ys))for(l=s._ptLookup[s._targets.indexOf(n)],u=a._props.length;u--;)l[a._props[u]]=h;return a},mi,eh,pl=function i(t,e,s){var r=t.vars,n=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,l=r.onUpdate,u=r.onUpdateParams,c=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,p=r.keyframes,m=r.autoRevert,g=t._dur,x=t._startAt,v=t._targets,_=t.parent,y=_&&_.data==="nested"?_.vars.targets:v,b=t._overwrite==="auto"&&!nl,A=t.timeline,T,w,E,M,I,D,P,S,O,G,C,k,X;if(A&&(!p||!n)&&(n="none"),t._ease=Ki(n,ks.ease),t._yEase=f?Lf(Ki(f===!0?n:f,ks.ease)):0,f&&t._yoyo&&!t._repeat&&(f=t._yEase,t._yEase=t._ease,t._ease=f),t._from=!A&&!!r.runBackwards,!A||p&&!r.stagger){if(S=v[0]?Yi(v[0]).harness:0,k=S&&r[S.prop],T=ro(r,ul),x&&(x._zTime<0&&x.progress(1),e<0&&d&&a&&!m?x.render(-1,!0):x.revert(d&&g?Bn:K0),x._lazy=0),o){if(Ei(t._startAt=Tt.set(v,be({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!x&&$t(h),startAt:null,delay:0,onUpdate:l,onUpdateParams:u,callbackScope:c,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Lt||!a&&!m)&&t._startAt.revert(Bn),a&&g&&e<=0&&s<=0){e&&(t._zTime=e);return}}else if(d&&g&&!x){if(e&&(a=!1),E=be({overwrite:!1,data:"isFromStart",lazy:a&&!x&&$t(h),immediateRender:a,stagger:0,parent:_},T),k&&(E[S.prop]=k),Ei(t._startAt=Tt.set(v,E)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Lt?t._startAt.revert(Bn):t._startAt.render(-1,!0)),t._zTime=e,!a)i(t._startAt,rt,rt);else if(!e)return}for(t._pt=t._ptCache=0,h=g&&$t(h)||h&&!g,w=0;w<v.length;w++){if(I=v[w],P=I._gsap||dl(v)[w]._gsap,t._ptLookup[w]=G={},qa[P.id]&&yi.length&&so(),C=y===v?w:y.indexOf(I),S&&(O=new S).init(I,k||T,t,C,y)!==!1&&(t._pt=M=new Wt(t._pt,I,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(R){G[R]=M}),O.priority&&(D=1)),!S||k)for(E in T)Qt[E]&&(O=zf(E,T,t,C,I,y))?O.priority&&(D=1):G[E]=M=fl.call(t,I,E,"get",T[E],C,y,0,r.stringFilter);t._op&&t._op[w]&&t.kill(I,t._op[w]),b&&t._pt&&(mi=t,ut.killTweensOf(I,G,t.globalTime(e)),X=!t.parent,mi=0),t._pt&&h&&(qa[P.id]=1)}D&&jf(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!X,p&&e<=0&&A.render(_e,!0,!0)},Tx=function(t,e,s,r,n,o,a){var h=(t._pt&&t._ptCache||(t._ptCache={}))[e],l,u,c,d;if(!h)for(h=t._ptCache[e]=[],c=t._ptLookup,d=t._targets.length;d--;){if(l=c[d][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return eh=1,t.vars[e]="+=0",pl(t,a),eh=0,1;h.push(l)}for(d=h.length;d--;)u=h[d],l=u._pt||u,l.s=(r||r===0)&&!n?r:l.s+(r||0)+o*l.c,l.c=s-l.s,u.e&&(u.e=_t(s)+Ot(u.e)),u.b&&(u.b=l.s+Ot(u.b))},Ex=function(t,e){var s=t[0]?Yi(t[0]).harness:0,r=s&&s.aliases,n,o,a,h;if(!r)return e;n=es({},e);for(o in r)if(o in n)for(h=r[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},Ax=function(t,e,s,r){var n=e.ease||r||"power1.inOut",o,a;if(Nt(e))a=s[t]||(s[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=s[o]||(s[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},pr=function(t,e,s,r,n){return gt(t)?t.call(e,s,r,n):Mt(t)&&~t.indexOf("random(")?Dr(t):t},Hf=cl+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Vf={};Xt(Hf+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return Vf[i]=1});var Tt=function(i){af(t,i);function t(s,r,n,o){var a;typeof r=="number"&&(n.duration=r,r=n,n=null),a=i.call(this,o?r:dr(r))||this;var h=a.vars,l=h.duration,u=h.delay,c=h.immediateRender,d=h.stagger,f=h.overwrite,p=h.keyframes,m=h.defaults,g=h.scrollTrigger,x=h.yoyoEase,v=r.parent||ut,_=(Nt(s)||lf(s)?ui(s[0]):"length"in r)?[s]:xe(s),y,b,A,T,w,E,M,I;if(a._targets=_.length?dl(_):io("GSAP target "+s+" not found. https://greensock.com",!se.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||Tn(l)||Tn(u)){if(r=a.vars,y=a.timeline=new Vt({data:"nested",defaults:m||{},targets:v&&v.data==="nested"?v.vars.targets:_}),y.kill(),y.parent=y._dp=si(a),y._start=0,d||Tn(l)||Tn(u)){if(T=_.length,M=d&&Cf(d),Ze(d))for(w in d)~Hf.indexOf(w)&&(I||(I={}),I[w]=d[w]);for(b=0;b<T;b++)A=ro(r,Vf),A.stagger=0,x&&(A.yoyoEase=x),I&&es(A,I),E=_[b],A.duration=+pr(l,si(a),b,E,_),A.delay=(+pr(u,si(a),b,E,_)||0)-a._delay,!d&&T===1&&A.delay&&(a._delay=u=A.delay,a._start+=u,A.delay=0),y.to(E,A,M?M(b,E,_):0),y._ease=et.none;y.duration()?l=u=0:a.timeline=0}else if(p){dr(be(y.vars.defaults,{ease:"none"})),y._ease=Ki(p.ease||r.ease||"none");var D=0,P,S,O;if(Nt(p))p.forEach(function(G){return y.to(_,G,">")}),y.duration();else{A={};for(w in p)w==="ease"||w==="easeEach"||Ax(w,p[w],A,p.easeEach);for(w in A)for(P=A[w].sort(function(G,C){return G.t-C.t}),D=0,b=0;b<P.length;b++)S=P[b],O={ease:S.e,duration:(S.t-(b?P[b-1].t:0))/100*l},O[w]=S.v,y.to(_,O,D),D+=O.duration;y.duration()<l&&y.to({},{duration:l-y.duration()})}}l||a.duration(l=y.duration())}else a.timeline=0;return f===!0&&!nl&&(mi=si(a),ut.killTweensOf(_),mi=0),Ve(v,si(a),n),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(c||!l&&!p&&a._start===Ft(v._time)&&$t(c)&&ix(si(a))&&v.data!=="nested")&&(a._tTime=-rt,a.render(Math.max(0,-u)||0)),g&&Tf(si(a),g),a}var e=t.prototype;return e.render=function(r,n,o){var a=this._time,h=this._tDur,l=this._dur,u=r<0,c=r>h-rt&&!u?h:r<rt?0:r,d,f,p,m,g,x,v,_,y;if(!l)rx(this,r,n,o);else if(c!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=c,_=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(m*100+r,n,o);if(d=Ft(c%m),c===h?(p=this._repeat,d=l):(p=~~(c/m),p&&p===c/m&&(d=l,p--),d>l&&(d=l)),x=this._yoyo&&p&1,x&&(y=this._yEase,d=l-d),g=Os(this._tTime,m),d===a&&!o&&this._initted)return this._tTime=c,this;p!==g&&(_&&this._yEase&&Nf(_,x),this.vars.repeatRefresh&&!x&&!this._lock&&(this._lock=o=1,this.render(Ft(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(Ef(this,u?r:d,o,n,c))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,n,o)}if(this._tTime=c,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(y||this._ease)(d/l),this._from&&(this.ratio=v=1-v),d&&!a&&!n&&!p&&(ve(this,"onStart"),this._tTime!==c))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;_&&_.render(r<0?r:!d&&x?-rt:_._dur*_._ease(d/this._dur),n,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!n&&(u&&Ka(this,r,n,o),ve(this,"onUpdate")),this._repeat&&p!==g&&this.vars.onRepeat&&!n&&this.parent&&ve(this,"onRepeat"),(c===this._tDur||!c)&&this._tTime===c&&(u&&!this._onUpdate&&Ka(this,r,!0,!0),(r||!l)&&(c===this._tDur&&this._ts>0||!c&&this._ts<0)&&Ei(this,1),!n&&!(u&&!a)&&(c||a||x)&&(ve(this,c===h?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},e.resetTo=function(r,n,o,a){Fr||Jt.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||pl(this,h),l=this._ease(h/this._dur),Tx(this,r,n,o,a,l,h)?this.resetTo(r,n,o,a):(Fo(this,0),this.parent||bf(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,n){if(n===void 0&&(n="all"),!r&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?hr(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,n,mi&&mi.vars.overwrite!==!0)._first||hr(this),this.parent&&o!==this.timeline.totalDuration()&&Ls(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?xe(r):a,l=this._ptLookup,u=this._pt,c,d,f,p,m,g,x;if((!n||n==="all")&&tx(a,h))return n==="all"&&(this._pt=0),hr(this);for(c=this._op=this._op||[],n!=="all"&&(Mt(n)&&(m={},Xt(n,function(v){return m[v]=1}),n=m),n=Ex(a,n)),x=a.length;x--;)if(~h.indexOf(a[x])){d=l[x],n==="all"?(c[x]=n,p=d,f={}):(f=c[x]=c[x]||{},p=n);for(m in p)g=d&&d[m],g&&((!("kill"in g.d)||g.d.kill(m)===!0)&&Mo(this,g,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&u&&hr(this),this},t.to=function(r,n){return new t(r,n,arguments[2])},t.from=function(r,n){return fr(1,arguments)},t.delayedCall=function(r,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,n,o){return fr(2,arguments)},t.set=function(r,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(r,n)},t.killTweensOf=function(r,n,o){return ut.killTweensOf(r,n,o)},t}(Br);be(Tt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Xt("staggerTo,staggerFrom,staggerFromTo",function(i){Tt[i]=function(){var t=new Vt,e=Qa.call(arguments,0);return e.splice(i==="staggerFromTo"?5:4,0,0),t[i].apply(t,e)}});var ml=function(t,e,s){return t[e]=s},$f=function(t,e,s){return t[e](s)},Sx=function(t,e,s,r){return t[e](r.fp,s)},Cx=function(t,e,s){return t.setAttribute(e,s)},gl=function(t,e){return gt(t[e])?$f:ol(t[e])&&t.setAttribute?Cx:ml},Xf=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Px=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Wf=function(t,e){var s=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;s;)r=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+r,s=s._next;r+=e.c}e.set(e.t,e.p,r,e)},_l=function(t,e){for(var s=e._pt;s;)s.r(t,s.d),s=s._next},Ix=function(t,e,s,r){for(var n=this._pt,o;n;)o=n._next,n.p===r&&n.modifier(t,e,s),n=o},Rx=function(t){for(var e=this._pt,s,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?Mo(this,e,"_pt"):e.dep||(s=1),e=r;return!s},Mx=function(t,e,s,r){r.mSet(t,e,r.m.call(r.tween,s,r.mt),r)},jf=function(t){for(var e=t._pt,s,r,n,o;e;){for(s=e._next,r=n;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:n=e,(e._next=r)?r._prev=e:o=e,e=s}t._pt=n},Wt=function(){function i(e,s,r,n,o,a,h,l,u){this.t=s,this.s=n,this.c=o,this.p=r,this.r=a||Xf,this.d=h||this,this.set=l||ml,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=i.prototype;return t.modifier=function(s,r,n){this.mSet=this.mSet||this.set,this.set=Mx,this.m=s,this.mt=n,this.tween=r},i}();Xt(cl+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return ul[i]=1});re.TweenMax=re.TweenLite=Tt;re.TimelineLite=re.TimelineMax=Vt;ut=new Vt({sortChildren:!1,defaults:ks,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});se.stringFilter=Of;var Zi=[],On={},Dx=[],Bu=0,Fx=0,da=function(t){return(On[t]||Dx).map(function(e){return e()})},ih=function(){var t=Date.now(),e=[];t-Bu>2&&(da("matchMediaInit"),Zi.forEach(function(s){var r=s.queries,n=s.conditions,o,a,h,l;for(a in r)o=ae.matchMedia(r[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(s.revert(),h&&e.push(s))}),da("matchMediaRevert"),e.forEach(function(s){return s.onMatch(s)}),Bu=t,da("matchMedia"))},Yf=function(){function i(e,s){this.selector=s&&Ja(s),this.data=[],this._r=[],this.isReverted=!1,this.id=Fx++,e&&this.add(e)}var t=i.prototype;return t.add=function(s,r,n){gt(s)&&(n=r,r=s,s=gt);var o=this,a=function(){var l=mt,u=o.selector,c;return l&&l!==o&&l.data.push(o),n&&(o.selector=Ja(n)),mt=o,c=r.apply(o,arguments),gt(c)&&o._r.push(c),mt=l,o.selector=u,o.isReverted=!1,c};return o.last=a,s===gt?a(o):s?o[s]=a:a},t.ignore=function(s){var r=mt;mt=null,s(this),mt=r},t.getTweens=function(){var s=[];return this.data.forEach(function(r){return r instanceof i?s.push.apply(s,r.getTweens()):r instanceof Tt&&!(r.parent&&r.parent.data==="nested")&&s.push(r)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,r){var n=this;if(s){var o=this.getTweens();this.data.forEach(function(h){h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(h){return{g:h.globalTime(0),t:h}}).sort(function(h,l){return l.g-h.g||-1/0}).forEach(function(h){return h.t.revert(s)}),this.data.forEach(function(h){return!(h instanceof Tt)&&h.revert&&h.revert(s)}),this._r.forEach(function(h){return h(s,n)}),this.isReverted=!0}else this.data.forEach(function(h){return h.kill&&h.kill()});if(this.clear(),r)for(var a=Zi.length;a--;)Zi[a].id===this.id&&Zi.splice(a,1)},t.revert=function(s){this.kill(s||{})},i}(),Bx=function(){function i(e){this.contexts=[],this.scope=e}var t=i.prototype;return t.add=function(s,r,n){Ze(s)||(s={matches:s});var o=new Yf(0,n||this.scope),a=o.conditions={},h,l,u;mt&&!o.selector&&(o.selector=mt.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=s;for(l in s)l==="all"?u=1:(h=ae.matchMedia(s[l]),h&&(Zi.indexOf(o)<0&&Zi.push(o),(a[l]=h.matches)&&(u=1),h.addListener?h.addListener(ih):h.addEventListener("change",ih)));return u&&r(o),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(r){return r.kill(s,!0)})},i}(),oo={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e.forEach(function(r){return Ff(r)})},timeline:function(t){return new Vt(t)},getTweensOf:function(t,e){return ut.getTweensOf(t,e)},getProperty:function(t,e,s,r){Mt(t)&&(t=xe(t)[0]);var n=Yi(t||{}).get,o=s?yf:vf;return s==="native"&&(s=""),t&&(e?o((Qt[e]&&Qt[e].get||n)(t,e,s,r)):function(a,h,l){return o((Qt[a]&&Qt[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,s){if(t=xe(t),t.length>1){var r=t.map(function(u){return jt.quickSetter(u,e,s)}),n=r.length;return function(u){for(var c=n;c--;)r[c](u)}}t=t[0]||{};var o=Qt[e],a=Yi(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(u){var c=new o;ys._pt=0,c.init(t,s?u+s:u,ys,0,[t]),c.render(1,c),ys._pt&&_l(1,ys)}:a.set(t,h);return o?l:function(u){return l(t,h,s?u+s:u,a,1)}},quickTo:function(t,e,s){var r,n=jt.to(t,es((r={},r[e]="+=0.1",r.paused=!0,r),s||{})),o=function(h,l,u){return n.resetTo(e,h,l,u)};return o.tween=n,o},isTweening:function(t){return ut.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Ki(t.ease,ks.ease)),Iu(ks,t||{})},config:function(t){return Iu(se,t||{})},registerEffect:function(t){var e=t.name,s=t.effect,r=t.plugins,n=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Qt[a]&&!re[a]&&io(e+" effect requires "+a+" plugin.")}),ha[e]=function(a,h,l){return s(xe(a),be(h||{},n),l)},o&&(Vt.prototype[e]=function(a,h,l){return this.add(ha[e](a,Ze(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){et[t]=Ki(e)},parseEase:function(t,e){return arguments.length?Ki(t,e):et},getById:function(t){return ut.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var s=new Vt(t),r,n;for(s.smoothChildTiming=$t(t.smoothChildTiming),ut.remove(s),s._dp=0,s._time=s._tTime=ut._time,r=ut._first;r;)n=r._next,(e||!(!r._dur&&r instanceof Tt&&r.vars.onComplete===r._targets[0]))&&Ve(s,r,r._start-r._delay),r=n;return Ve(ut,s,0),s},context:function(t,e){return t?new Yf(t,e):mt},matchMedia:function(t){return new Bx(t)},matchMediaRefresh:function(){return Zi.forEach(function(t){var e=t.conditions,s,r;for(r in e)e[r]&&(e[r]=!1,s=1);s&&t.revert()})||ih()},addEventListener:function(t,e){var s=On[t]||(On[t]=[]);~s.indexOf(e)||s.push(e)},removeEventListener:function(t,e){var s=On[t],r=s&&s.indexOf(e);r>=0&&s.splice(r,1)},utils:{wrap:dx,wrapYoyo:fx,distribute:Cf,random:If,snap:Pf,normalize:cx,getUnit:Ot,clamp:ax,splitColor:Bf,toArray:xe,selector:Ja,mapRange:Mf,pipe:lx,unitize:ux,interpolate:px,shuffle:Sf},install:pf,effects:ha,ticker:Jt,updateRoot:Vt.updateRoot,plugins:Qt,globalTimeline:ut,core:{PropTween:Wt,globals:mf,Tween:Tt,Timeline:Vt,Animation:Br,getCache:Yi,_removeLinkedListItem:Mo,reverting:function(){return Lt},context:function(t){return t&&mt&&(mt.data.push(t),t._ctx=mt),mt},suppressOverwrites:function(t){return nl=t}}};Xt("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return oo[i]=Tt[i]});Jt.add(Vt.updateRoot);ys=oo.to({},{duration:0});var kx=function(t,e){for(var s=t._pt;s&&s.p!==e&&s.op!==e&&s.fp!==e;)s=s._next;return s},Ox=function(t,e){var s=t._targets,r,n,o;for(r in e)for(n=s.length;n--;)o=t._ptLookup[n][r],o&&(o=o.d)&&(o._pt&&(o=kx(o,r)),o&&o.modifier&&o.modifier(e[r],t,s[n],r))},fa=function(t,e){return{name:t,rawVars:1,init:function(r,n,o){o._onInit=function(a){var h,l;if(Mt(n)&&(h={},Xt(n,function(u){return h[u]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}Ox(a,n)}}}},jt=oo.registerPlugin({name:"attr",init:function(t,e,s,r,n){var o,a,h;this.tween=s;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],r,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var s=e._pt;s;)Lt?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",init:function(t,e){for(var s=e.length;s--;)this.add(t,s,t[s]||0,e[s],0,0,0,0,0,1)}},fa("roundProps",th),fa("modifiers"),fa("snap",Pf))||oo;Tt.version=Vt.version=jt.version="3.12.2";ff=1;al()&&Ns();et.Power0;et.Power1;et.Power2;et.Power3;et.Power4;et.Linear;et.Quad;et.Cubic;et.Quart;et.Quint;et.Strong;et.Elastic;et.Back;et.SteppedEase;et.Bounce;et.Sine;et.Expo;et.Circ;/*!
 * CSSPlugin 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ku,gi,Ps,xl,Hi,Ou,vl,Lx=function(){return typeof window<"u"},ci={},Ni=180/Math.PI,Is=Math.PI/180,us=Math.atan2,Lu=1e8,yl=/([A-Z])/g,Nx=/(left|right|width|margin|padding|x)/i,Ux=/[\s,\(]\S/,Xe={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},sh=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Gx=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},zx=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Hx=function(t,e){var s=e.s+e.c*t;e.set(e.t,e.p,~~(s+(s<0?-.5:.5))+e.u,e)},qf=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Kf=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Vx=function(t,e,s){return t.style[e]=s},$x=function(t,e,s){return t.style.setProperty(e,s)},Xx=function(t,e,s){return t._gsap[e]=s},Wx=function(t,e,s){return t._gsap.scaleX=t._gsap.scaleY=s},jx=function(t,e,s,r,n){var o=t._gsap;o.scaleX=o.scaleY=s,o.renderTransform(n,o)},Yx=function(t,e,s,r,n){var o=t._gsap;o[e]=s,o.renderTransform(n,o)},dt="transform",ke=dt+"Origin",qx=function i(t,e){var s=this,r=this.target,n=r.style;if(t in ci&&n){if(this.tfm=this.tfm||{},t!=="transform")t=Xe[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return s.tfm[o]=ri(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:ri(r,t);else return Xe.transform.split(",").forEach(function(o){return i.call(s,o,e)});if(this.props.indexOf(dt)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(ke,e,"")),t=dt}(n||e)&&this.props.push(t,e,n[t])},Zf=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Kx=function(){var t=this.props,e=this.target,s=e.style,r=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?s[t[n]]=t[n+2]:s.removeProperty(t[n].substr(0,2)==="--"?t[n]:t[n].replace(yl,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=vl(),(!n||!n.isStart)&&!s[dt]&&(Zf(s),r.uncache=1)}},Qf=function(t,e){var s={target:t,props:[],revert:Kx,save:qx};return t._gsap||jt.core.getCache(t),e&&e.split(",").forEach(function(r){return s.save(r)}),s},Jf,rh=function(t,e){var s=gi.createElementNS?gi.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):gi.createElement(t);return s.style?s:gi.createElement(t)},Ye=function i(t,e,s){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(yl,"-$1").toLowerCase())||r.getPropertyValue(e)||!s&&i(t,Us(e)||e,1)||""},Nu="O,Moz,ms,Ms,Webkit".split(","),Us=function(t,e,s){var r=e||Hi,n=r.style,o=5;if(t in n&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(Nu[o]+t in n););return o<0?null:(o===3?"ms":o>=0?Nu[o]:"")+t},nh=function(){Lx()&&window.document&&(ku=window,gi=ku.document,Ps=gi.documentElement,Hi=rh("div")||{style:{}},rh("div"),dt=Us(dt),ke=dt+"Origin",Hi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Jf=!!Us("perspective"),vl=jt.core.reverting,xl=1)},pa=function i(t){var e=rh("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,r=this.nextSibling,n=this.style.cssText,o;if(Ps.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(r?s.insertBefore(this,r):s.appendChild(this)),Ps.removeChild(e),this.style.cssText=n,o},Uu=function(t,e){for(var s=e.length;s--;)if(t.hasAttribute(e[s]))return t.getAttribute(e[s])},tp=function(t){var e;try{e=t.getBBox()}catch{e=pa.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===pa||(e=pa.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+Uu(t,["x","cx","x1"])||0,y:+Uu(t,["y","cy","y1"])||0,width:0,height:0}:e},ep=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&tp(t))},kr=function(t,e){if(e){var s=t.style;e in ci&&e!==ke&&(e=dt),s.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),s.removeProperty(e.replace(yl,"-$1").toLowerCase())):s.removeAttribute(e)}},_i=function(t,e,s,r,n,o){var a=new Wt(t._pt,e,s,0,1,o?Kf:qf);return t._pt=a,a.b=r,a.e=n,t._props.push(s),a},Gu={deg:1,rad:1,turn:1},Zx={grid:1,flex:1},Ai=function i(t,e,s,r){var n=parseFloat(s)||0,o=(s+"").trim().substr((n+"").length)||"px",a=Hi.style,h=Nx.test(e),l=t.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(h?"Width":"Height"),c=100,d=r==="px",f=r==="%",p,m,g,x;return r===o||!n||Gu[r]||Gu[o]?n:(o!=="px"&&!d&&(n=i(t,e,s,"px")),x=t.getCTM&&ep(t),(f||o==="%")&&(ci[e]||~e.indexOf("adius"))?(p=x?t.getBBox()[h?"width":"height"]:t[u],_t(f?n/p*c:n/100*p)):(a[h?"width":"height"]=c+(d?o:r),m=~e.indexOf("adius")||r==="em"&&t.appendChild&&!l?t:t.parentNode,x&&(m=(t.ownerSVGElement||{}).parentNode),(!m||m===gi||!m.appendChild)&&(m=gi.body),g=m._gsap,g&&f&&g.width&&h&&g.time===Jt.time&&!g.uncache?_t(n/g.width*c):((f||o==="%")&&!Zx[Ye(m,"display")]&&(a.position=Ye(t,"position")),m===t&&(a.position="static"),m.appendChild(Hi),p=Hi[u],m.removeChild(Hi),a.position="absolute",h&&f&&(g=Yi(m),g.time=Jt.time,g.width=m[u]),_t(d?p*n/c:p&&n?c/p*n:0))))},ri=function(t,e,s,r){var n;return xl||nh(),e in Xe&&e!=="transform"&&(e=Xe[e],~e.indexOf(",")&&(e=e.split(",")[0])),ci[e]&&e!=="transform"?(n=Lr(t,r),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:ho(Ye(t,ke))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||r||~(n+"").indexOf("calc("))&&(n=ao[e]&&ao[e](t,e,s)||Ye(t,e)||_f(t,e)||(e==="opacity"?1:0))),s&&!~(n+"").trim().indexOf(" ")?Ai(t,e,n,s)+s:n},Qx=function(t,e,s,r){if(!s||s==="none"){var n=Us(e,t,1),o=n&&Ye(t,n,1);o&&o!==s?(e=n,s=o):e==="borderColor"&&(s=Ye(t,"borderTopColor"))}var a=new Wt(this._pt,t.style,e,0,1,Wf),h=0,l=0,u,c,d,f,p,m,g,x,v,_,y,b;if(a.b=s,a.e=r,s+="",r+="",r==="auto"&&(t.style[e]=r,r=Ye(t,e)||r,t.style[e]=s),u=[s,r],Of(u),s=u[0],r=u[1],d=s.match(vs)||[],b=r.match(vs)||[],b.length){for(;c=vs.exec(r);)g=c[0],v=r.substring(h,c.index),p?p=(p+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(p=1),g!==(m=d[l++]||"")&&(f=parseFloat(m)||0,y=m.substr((f+"").length),g.charAt(1)==="="&&(g=Cs(f,g)+y),x=parseFloat(g),_=g.substr((x+"").length),h=vs.lastIndex-_.length,_||(_=_||se.units[e]||y,h===r.length&&(r+=_,a.e+=_)),y!==_&&(f=Ai(t,e,m,_)||0),a._pt={_next:a._pt,p:v||l===1?v:",",s:f,c:x-f,m:p&&p<4||e==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=e==="display"&&r==="none"?Kf:qf;return cf.test(r)&&(a.e=0),this._pt=a,a},zu={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Jx=function(t){var e=t.split(" "),s=e[0],r=e[1]||"50%";return(s==="top"||s==="bottom"||r==="left"||r==="right")&&(t=s,s=r,r=t),e[0]=zu[s]||s,e[1]=zu[r]||r,e.join(" ")},tv=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var s=e.t,r=s.style,n=e.u,o=s._gsap,a,h,l;if(n==="all"||n===!0)r.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],ci[a]&&(h=1,a=a==="transformOrigin"?ke:dt),kr(s,a);h&&(kr(s,dt),o&&(o.svg&&s.removeAttribute("transform"),Lr(s,1),o.uncache=1,Zf(r)))}},ao={clearProps:function(t,e,s,r,n){if(n.data!=="isFromStart"){var o=t._pt=new Wt(t._pt,e,s,0,0,tv);return o.u=r,o.pr=-10,o.tween=n,t._props.push(s),1}}},Or=[1,0,0,1,0,0],ip={},sp=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},Hu=function(t){var e=Ye(t,dt);return sp(e)?Or:e.substr(7).match(uf).map(_t)},bl=function(t,e){var s=t._gsap||Yi(t),r=t.style,n=Hu(t),o,a,h,l;return s.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?Or:n):(n===Or&&!t.offsetParent&&t!==Ps&&!s.svg&&(h=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Ps.appendChild(t)),n=Hu(t),h?r.display=h:kr(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Ps.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},oh=function(t,e,s,r,n,o){var a=t._gsap,h=n||bl(t,!0),l=a.xOrigin||0,u=a.yOrigin||0,c=a.xOffset||0,d=a.yOffset||0,f=h[0],p=h[1],m=h[2],g=h[3],x=h[4],v=h[5],_=e.split(" "),y=parseFloat(_[0])||0,b=parseFloat(_[1])||0,A,T,w,E;s?h!==Or&&(T=f*g-p*m)&&(w=y*(g/T)+b*(-m/T)+(m*v-g*x)/T,E=y*(-p/T)+b*(f/T)-(f*v-p*x)/T,y=w,b=E):(A=tp(t),y=A.x+(~_[0].indexOf("%")?y/100*A.width:y),b=A.y+(~(_[1]||_[0]).indexOf("%")?b/100*A.height:b)),r||r!==!1&&a.smooth?(x=y-l,v=b-u,a.xOffset=c+(x*f+v*m)-x,a.yOffset=d+(x*p+v*g)-v):a.xOffset=a.yOffset=0,a.xOrigin=y,a.yOrigin=b,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!s,t.style[ke]="0px 0px",o&&(_i(o,a,"xOrigin",l,y),_i(o,a,"yOrigin",u,b),_i(o,a,"xOffset",c,a.xOffset),_i(o,a,"yOffset",d,a.yOffset)),t.setAttribute("data-svg-origin",y+" "+b)},Lr=function(t,e){var s=t._gsap||new Gf(t);if("x"in s&&!e&&!s.uncache)return s;var r=t.style,n=s.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=Ye(t,ke)||"0",u,c,d,f,p,m,g,x,v,_,y,b,A,T,w,E,M,I,D,P,S,O,G,C,k,X,R,H,q,it,J,nt;return u=c=d=m=g=x=v=_=y=0,f=p=1,s.svg=!!(t.getCTM&&ep(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[dt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[dt]!=="none"?h[dt]:"")),r.scale=r.rotate=r.translate="none"),T=bl(t,s.svg),s.svg&&(s.uncache?(k=t.getBBox(),l=s.xOrigin-k.x+"px "+(s.yOrigin-k.y)+"px",C=""):C=!e&&t.getAttribute("data-svg-origin"),oh(t,C||l,!!C||s.originIsAbsolute,s.smooth!==!1,T)),b=s.xOrigin||0,A=s.yOrigin||0,T!==Or&&(I=T[0],D=T[1],P=T[2],S=T[3],u=O=T[4],c=G=T[5],T.length===6?(f=Math.sqrt(I*I+D*D),p=Math.sqrt(S*S+P*P),m=I||D?us(D,I)*Ni:0,v=P||S?us(P,S)*Ni+m:0,v&&(p*=Math.abs(Math.cos(v*Is))),s.svg&&(u-=b-(b*I+A*P),c-=A-(b*D+A*S))):(nt=T[6],it=T[7],R=T[8],H=T[9],q=T[10],J=T[11],u=T[12],c=T[13],d=T[14],w=us(nt,q),g=w*Ni,w&&(E=Math.cos(-w),M=Math.sin(-w),C=O*E+R*M,k=G*E+H*M,X=nt*E+q*M,R=O*-M+R*E,H=G*-M+H*E,q=nt*-M+q*E,J=it*-M+J*E,O=C,G=k,nt=X),w=us(-P,q),x=w*Ni,w&&(E=Math.cos(-w),M=Math.sin(-w),C=I*E-R*M,k=D*E-H*M,X=P*E-q*M,J=S*M+J*E,I=C,D=k,P=X),w=us(D,I),m=w*Ni,w&&(E=Math.cos(w),M=Math.sin(w),C=I*E+D*M,k=O*E+G*M,D=D*E-I*M,G=G*E-O*M,I=C,O=k),g&&Math.abs(g)+Math.abs(m)>359.9&&(g=m=0,x=180-x),f=_t(Math.sqrt(I*I+D*D+P*P)),p=_t(Math.sqrt(G*G+nt*nt)),w=us(O,G),v=Math.abs(w)>2e-4?w*Ni:0,y=J?1/(J<0?-J:J):0),s.svg&&(C=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!sp(Ye(t,dt)),C&&t.setAttribute("transform",C))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(f*=-1,v+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),e=e||s.uncache,s.x=u-((s.xPercent=u&&(!e&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-u)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+o,s.y=c-((s.yPercent=c&&(!e&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-c)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+o,s.z=d+o,s.scaleX=_t(f),s.scaleY=_t(p),s.rotation=_t(m)+a,s.rotationX=_t(g)+a,s.rotationY=_t(x)+a,s.skewX=v+a,s.skewY=_+a,s.transformPerspective=y+o,(s.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[ke]=ho(l)),s.xOffset=s.yOffset=0,s.force3D=se.force3D,s.renderTransform=s.svg?iv:Jf?rp:ev,s.uncache=0,s},ho=function(t){return(t=t.split(" "))[0]+" "+t[1]},ma=function(t,e,s){var r=Ot(e);return _t(parseFloat(e)+parseFloat(Ai(t,"x",s+"px",r)))+r},ev=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,rp(t,e)},Di="0deg",tr="0px",Fi=") ",rp=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.z,l=s.rotation,u=s.rotationY,c=s.rotationX,d=s.skewX,f=s.skewY,p=s.scaleX,m=s.scaleY,g=s.transformPerspective,x=s.force3D,v=s.target,_=s.zOrigin,y="",b=x==="auto"&&t&&t!==1||x===!0;if(_&&(c!==Di||u!==Di)){var A=parseFloat(u)*Is,T=Math.sin(A),w=Math.cos(A),E;A=parseFloat(c)*Is,E=Math.cos(A),o=ma(v,o,T*E*-_),a=ma(v,a,-Math.sin(A)*-_),h=ma(v,h,w*E*-_+_)}g!==tr&&(y+="perspective("+g+Fi),(r||n)&&(y+="translate("+r+"%, "+n+"%) "),(b||o!==tr||a!==tr||h!==tr)&&(y+=h!==tr||b?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+Fi),l!==Di&&(y+="rotate("+l+Fi),u!==Di&&(y+="rotateY("+u+Fi),c!==Di&&(y+="rotateX("+c+Fi),(d!==Di||f!==Di)&&(y+="skew("+d+", "+f+Fi),(p!==1||m!==1)&&(y+="scale("+p+", "+m+Fi),v.style[dt]=y||"translate(0, 0)"},iv=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.rotation,l=s.skewX,u=s.skewY,c=s.scaleX,d=s.scaleY,f=s.target,p=s.xOrigin,m=s.yOrigin,g=s.xOffset,x=s.yOffset,v=s.forceCSS,_=parseFloat(o),y=parseFloat(a),b,A,T,w,E;h=parseFloat(h),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,h+=u),h||l?(h*=Is,l*=Is,b=Math.cos(h)*c,A=Math.sin(h)*c,T=Math.sin(h-l)*-d,w=Math.cos(h-l)*d,l&&(u*=Is,E=Math.tan(l-u),E=Math.sqrt(1+E*E),T*=E,w*=E,u&&(E=Math.tan(u),E=Math.sqrt(1+E*E),b*=E,A*=E)),b=_t(b),A=_t(A),T=_t(T),w=_t(w)):(b=c,w=d,A=T=0),(_&&!~(o+"").indexOf("px")||y&&!~(a+"").indexOf("px"))&&(_=Ai(f,"x",o,"px"),y=Ai(f,"y",a,"px")),(p||m||g||x)&&(_=_t(_+p-(p*b+m*T)+g),y=_t(y+m-(p*A+m*w)+x)),(r||n)&&(E=f.getBBox(),_=_t(_+r/100*E.width),y=_t(y+n/100*E.height)),E="matrix("+b+","+A+","+T+","+w+","+_+","+y+")",f.setAttribute("transform",E),v&&(f.style[dt]=E)},sv=function(t,e,s,r,n){var o=360,a=Mt(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?Ni:1),l=h-r,u=r+l+"deg",c,d;return a&&(c=n.split("_")[1],c==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),c==="cw"&&l<0?l=(l+o*Lu)%o-~~(l/o)*o:c==="ccw"&&l>0&&(l=(l-o*Lu)%o-~~(l/o)*o)),t._pt=d=new Wt(t._pt,e,s,r,l,Gx),d.e=u,d.u="deg",t._props.push(s),d},Vu=function(t,e){for(var s in e)t[s]=e[s];return t},rv=function(t,e,s){var r=Vu({},s._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=s.style,a,h,l,u,c,d,f,p;r.svg?(l=s.getAttribute("transform"),s.setAttribute("transform",""),o[dt]=e,a=Lr(s,1),kr(s,dt),s.setAttribute("transform",l)):(l=getComputedStyle(s)[dt],o[dt]=e,a=Lr(s,1),o[dt]=l);for(h in ci)l=r[h],u=a[h],l!==u&&n.indexOf(h)<0&&(f=Ot(l),p=Ot(u),c=f!==p?Ai(s,h,l,p):parseFloat(l),d=parseFloat(u),t._pt=new Wt(t._pt,a,h,c,d-c,sh),t._pt.u=p||0,t._props.push(h));Vu(a,r)};Xt("padding,margin,Width,Radius",function(i,t){var e="Top",s="Right",r="Bottom",n="Left",o=(t<3?[e,s,r,n]:[e+n,e+s,r+s,r+n]).map(function(a){return t<2?i+a:"border"+a+i});ao[t>1?"border"+i:i]=function(a,h,l,u,c){var d,f;if(arguments.length<4)return d=o.map(function(p){return ri(a,p,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(h,f,c)}});var np={name:"css",register:nh,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,s,r,n){var o=this._props,a=t.style,h=s.vars.startAt,l,u,c,d,f,p,m,g,x,v,_,y,b,A,T,w;xl||nh(),this.styles=this.styles||Qf(t),w=this.styles.props,this.tween=s;for(m in e)if(m!=="autoRound"&&(u=e[m],!(Qt[m]&&zf(m,e,s,r,t,n)))){if(f=typeof u,p=ao[m],f==="function"&&(u=u.call(s,r,t,n),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=Dr(u)),p)p(this,t,m,u,s)&&(T=1);else if(m.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(m)+"").trim(),u+="",bi.lastIndex=0,bi.test(l)||(g=Ot(l),x=Ot(u)),x?g!==x&&(l=Ai(t,m,l,x)+x):g&&(u+=g),this.add(a,"setProperty",l,u,r,n,0,0,m),o.push(m),w.push(m,0,a[m]);else if(f!=="undefined"){if(h&&m in h?(l=typeof h[m]=="function"?h[m].call(s,r,t,n):h[m],Mt(l)&&~l.indexOf("random(")&&(l=Dr(l)),Ot(l+"")||(l+=se.units[m]||Ot(ri(t,m))||""),(l+"").charAt(1)==="="&&(l=ri(t,m))):l=ri(t,m),d=parseFloat(l),v=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),v&&(u=u.substr(2)),c=parseFloat(u),m in Xe&&(m==="autoAlpha"&&(d===1&&ri(t,"visibility")==="hidden"&&c&&(d=0),w.push("visibility",0,a.visibility),_i(this,a,"visibility",d?"inherit":"hidden",c?"inherit":"hidden",!c)),m!=="scale"&&m!=="transform"&&(m=Xe[m],~m.indexOf(",")&&(m=m.split(",")[0]))),_=m in ci,_){if(this.styles.save(m),y||(b=t._gsap,b.renderTransform&&!e.parseTransform||Lr(t,e.parseTransform),A=e.smoothOrigin!==!1&&b.smooth,y=this._pt=new Wt(this._pt,a,dt,0,1,b.renderTransform,b,0,-1),y.dep=1),m==="scale")this._pt=new Wt(this._pt,b,"scaleY",b.scaleY,(v?Cs(b.scaleY,v+c):c)-b.scaleY||0,sh),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){w.push(ke,0,a[ke]),u=Jx(u),b.svg?oh(t,u,0,A,0,this):(x=parseFloat(u.split(" ")[2])||0,x!==b.zOrigin&&_i(this,b,"zOrigin",b.zOrigin,x),_i(this,a,m,ho(l),ho(u)));continue}else if(m==="svgOrigin"){oh(t,u,1,A,0,this);continue}else if(m in ip){sv(this,b,m,d,v?Cs(d,v+u):u);continue}else if(m==="smoothOrigin"){_i(this,b,"smooth",b.smooth,u);continue}else if(m==="force3D"){b[m]=u;continue}else if(m==="transform"){rv(this,u,t);continue}}else m in a||(m=Us(m)||m);if(_||(c||c===0)&&(d||d===0)&&!Ux.test(u)&&m in a)g=(l+"").substr((d+"").length),c||(c=0),x=Ot(u)||(m in se.units?se.units[m]:g),g!==x&&(d=Ai(t,m,l,x)),this._pt=new Wt(this._pt,_?b:a,m,d,(v?Cs(d,v+c):c)-d,!_&&(x==="px"||m==="zIndex")&&e.autoRound!==!1?Hx:sh),this._pt.u=x||0,g!==x&&x!=="%"&&(this._pt.b=l,this._pt.r=zx);else if(m in a)Qx.call(this,t,m,l,v?v+u:u);else if(m in t)this.add(t,m,l||t[m],v?v+u:u,r,n);else if(m!=="parseTransform"){ll(m,u);continue}_||(m in a?w.push(m,0,a[m]):w.push(m,1,l||t[m])),o.push(m)}}T&&jf(this)},render:function(t,e){if(e.tween._time||!vl())for(var s=e._pt;s;)s.r(t,s.d),s=s._next;else e.styles.revert()},get:ri,aliases:Xe,getSetter:function(t,e,s){var r=Xe[e];return r&&r.indexOf(",")<0&&(e=r),e in ci&&e!==ke&&(t._gsap.x||ri(t,"x"))?s&&Ou===s?e==="scale"?Wx:Xx:(Ou=s||{})&&(e==="scale"?jx:Yx):t.style&&!ol(t.style[e])?Vx:~e.indexOf("-")?$x:gl(t,e)},core:{_removeProperty:kr,_getMatrix:bl}};jt.utils.checkPrefix=Us;jt.core.getStyleSaver=Qf;(function(i,t,e,s){var r=Xt(i+","+t+","+e,function(n){ci[n]=1});Xt(t,function(n){se.units[n]="deg",ip[n]=1}),Xe[r[13]]=i+","+t,Xt(s,function(n){var o=n.split(":");Xe[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Xt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){se.units[i]="px"});jt.registerPlugin(np);var wl=jt.registerPlugin(np)||jt;wl.core.Tween;/*!
 * PixiPlugin 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var xi,$u,lo,te,mr,op,ah,ap=function(){return typeof window<"u"},hp=function(){return xi||ap()&&(xi=window.gsap)&&xi.registerPlugin&&xi},hh=function(t){return typeof t=="function"},lp=function(t){return console.warn(t)},nv=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],le=.212671,ue=.71516,ce=.072169,up=function(t){return hh(te[t])?te[t]:te.filters[t]},Bo=function(t,e){var s=[],r=0,n=0,o,a;for(o=0;o<4;o++){for(a=0;a<5;a++)n=a===4?t[r+4]:0,s[r+a]=t[r]*e[a]+t[r+1]*e[a+5]+t[r+2]*e[a+10]+t[r+3]*e[a+15]+n;r+=5}return s},Xu=function(t,e){var s=1-e,r=s*le,n=s*ue,o=s*ce;return Bo([r+e,n,o,0,0,r,n+e,o,0,0,r,n,o+e,0,0,0,0,0,1,0],t)},Wu=function(t,e,s){var r=lo(e),n=r[0]/255,o=r[1]/255,a=r[2]/255,h=1-s;return Bo([h+s*n*le,s*n*ue,s*n*ce,0,0,s*o*le,h+s*o*ue,s*o*ce,0,0,s*a*le,s*a*ue,h+s*a*ce,0,0,0,0,0,1,0],t)},ju=function(t,e){e*=Math.PI/180;var s=Math.cos(e),r=Math.sin(e);return Bo([le+s*(1-le)+r*-le,ue+s*-ue+r*-ue,ce+s*-ce+r*(1-ce),0,0,le+s*-le+r*.143,ue+s*(1-ue)+r*.14,ce+s*-ce+r*-.283,0,0,le+s*-le+r*-(1-le),ue+s*-ue+r*ue,ce+s*(1-ce)+r*ce,0,0,0,0,0,1,0,0,0,0,0,1],t)},Yu=function(t,e){return Bo([e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0],t)},cp=function(t,e){var s=up(e),r=t.filters||[],n=r.length,o;for(s||lp(e+" not found. PixiPlugin.registerPIXI(PIXI)");--n>-1;)if(r[n]instanceof s)return r[n];return o=new s,e==="BlurFilter"&&(o.blur=0),r.push(o),t.filters=r,o},St=function(t,e,s,r){e.add(s,t,s[t],r[t]),e._props.push(t)},qu=function(t,e){var s=up("ColorMatrixFilter"),r=new s;return r.matrix=e,r.brightness(t,!0),r.matrix},ov=function(t){var e={},s;for(s in t)e[s]=t[s];return e},qt={contrast:1,saturation:1,colorizeAmount:0,colorize:"rgb(255,255,255)",hue:0,brightness:1},av=function(t,e,s){var r=cp(t,"ColorMatrixFilter"),n=t._gsColorMatrixFilter=t._gsColorMatrixFilter||ov(qt),o=e.combineCMF&&!("colorMatrixFilter"in e&&!e.colorMatrixFilter),a,h,l;for(l=r.matrix,e.resolution&&(r.resolution=e.resolution),e.matrix&&e.matrix.length===l.length?(h=e.matrix,n.contrast!==1&&St("contrast",s,n,qt),n.hue&&St("hue",s,n,qt),n.brightness!==1&&St("brightness",s,n,qt),n.colorizeAmount&&(St("colorize",s,n,qt),St("colorizeAmount",s,n,qt)),n.saturation!==1&&St("saturation",s,n,qt)):(h=nv.slice(),e.contrast!=null?(h=Yu(h,+e.contrast),St("contrast",s,n,e)):n.contrast!==1&&(o?h=Yu(h,n.contrast):St("contrast",s,n,qt)),e.hue!=null?(h=ju(h,+e.hue),St("hue",s,n,e)):n.hue&&(o?h=ju(h,n.hue):St("hue",s,n,qt)),e.brightness!=null?(h=qu(+e.brightness,h),St("brightness",s,n,e)):n.brightness!==1&&(o?h=qu(n.brightness,h):St("brightness",s,n,qt)),e.colorize!=null?(e.colorizeAmount="colorizeAmount"in e?+e.colorizeAmount:1,h=Wu(h,e.colorize,e.colorizeAmount),St("colorize",s,n,e),St("colorizeAmount",s,n,e)):n.colorizeAmount&&(o?h=Wu(h,n.colorize,n.colorizeAmount):(St("colorize",s,n,qt),St("colorizeAmount",s,n,qt))),e.saturation!=null?(h=Xu(h,+e.saturation),St("saturation",s,n,e)):n.saturation!==1&&(o?h=Xu(h,n.saturation):St("saturation",s,n,qt))),a=h.length;--a>-1;)h[a]!==l[a]&&s.add(l,a,l[a],h[a],"colorMatrixFilter");s._props.push("colorMatrixFilter")},hv=function(t,e){var s=e.t,r=e.p,n=e.color,o=e.set;o(s,r,n[0]<<16|n[1]<<8|n[2])},lv=function(t,e){var s=e.g;s&&(s.dirty++,s.clearDirty++)},uv=function(t,e){e.t.visible=!!e.t.alpha},Ku=function(t,e,s,r){var n=t[e],o=lo(hh(n)?t[e.indexOf("set")||!hh(t["get"+e.substr(3)])?e:"get"+e.substr(3)]():n),a=lo(s);r._pt=new mr(r._pt,t,e,0,0,hv,{t,p:e,color:o,set:op(t,e)}),r.add(o,0,o[0],a[0]),r.add(o,1,o[1],a[1]),r.add(o,2,o[2],a[2])},cv={tint:1,lineColor:1,fillColor:1},Zu="position,scale,skew,pivot,anchor,tilePosition,tileScale".split(","),lh={x:"position",y:"position",tileX:"tilePosition",tileY:"tilePosition"},dv={colorMatrixFilter:1,saturation:1,contrast:1,hue:1,colorize:1,colorizeAmount:1,brightness:1,combineCMF:1},uo=Math.PI/180,dp=function(t){return typeof t=="string"},fv=function(t){return dp(t)&&t.charAt(1)==="="?t.substr(0,2)+parseFloat(t.substr(2))*uo:t*uo},pv=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e5)/1e5,e)},mv=function(t,e,s,r,n,o){var a=360*(o?uo:1),h=dp(n),l=h&&n.charAt(1)==="="?+(n.charAt(0)+"1"):0,u=parseFloat(l?n.substr(2):n)*(o?uo:1),c=l?u*l:u-r,d=r+c,f,p;return h&&(f=n.split("_")[1],f==="short"&&(c%=a,c!==c%(a/2)&&(c+=c<0?a:-a)),f==="cw"&&c<0?c=(c+a*1e10)%a-~~(c/a)*a:f==="ccw"&&c>0&&(c=(c-a*1e10)%a-~~(c/a)*a)),t._pt=p=new mr(t._pt,e,s,r,c,pv),p.e=d,p},Qu=function(){ap()&&($u=window,xi=hp(),te=te||$u.PIXI,ah=te&&te.VERSION&&te.VERSION.charAt(0)==="4",lo=function(e){return xi.utils.splitColor((e+"").substr(0,2)==="0x"?"#"+e.substr(2):e)})},En,er;for(En=0;En<Zu.length;En++)er=Zu[En],lh[er+"X"]=er,lh[er+"Y"]=er;var Tl={version:"3.12.2",name:"pixi",register:function(t,e,s){xi=t,mr=s,op=e.getSetter,Qu()},registerPIXI:function(t){te=t},init:function(t,e,s,r,n){if(te||Qu(),!te||!(t instanceof te.DisplayObject))return lp(t),!1;var o,a,h,l,u,c,d,f,p;for(c in e){if(o=lh[c],h=e[c],o)a=~c.charAt(c.length-1).toLowerCase().indexOf("x")?"x":"y",this.add(t[o],a,t[o][a],o==="skew"?fv(h):h,0,0,0,0,0,1);else if(c==="scale"||c==="anchor"||c==="pivot"||c==="tileScale")this.add(t[c],"x",t[c].x,h),this.add(t[c],"y",t[c].y,h);else if(c==="rotation"||c==="angle")mv(this,t,c,t[c],h,c==="rotation");else if(dv[c])l||(av(t,e.colorMatrixFilter||e,this),l=!0);else if(c==="blur"||c==="blurX"||c==="blurY"||c==="blurPadding"){if(u=cp(t,"BlurFilter"),this.add(u,c,u[c],h),e.blurPadding!==0)for(d=e.blurPadding||Math.max(u[c],h)*2,f=t.filters.length;--f>-1;)t.filters[f].padding=Math.max(t.filters[f].padding,d)}else if(cv[c])if((c==="lineColor"||c==="fillColor")&&t instanceof te.Graphics)for(p=(t.geometry||t).graphicsData,this._pt=new mr(this._pt,t,c,0,0,lv,{g:t.geometry||t}),f=p.length;--f>-1;)Ku(ah?p[f]:p[f][c.substr(0,4)+"Style"],ah?c:"color",h,this);else Ku(t,c,h,this);else c==="autoAlpha"?(this._pt=new mr(this._pt,t,"visible",0,0,uv),this.add(t,"alpha",t.alpha,h),this._props.push("alpha","visible")):c!=="resolution"&&this.add(t,c,"get",h);this._props.push(c)}}};hp()&&xi.registerPlugin(Tl);var ft=(i=>(i.CHERRY="CHERRY",i.SEVEN="SEVEN",i.BARx1="BARx1",i.BARx2="BARx2",i.BARx3="BARx3",i))(ft||{}),uh=(i=>(i.WIN="WIN",i.SPIN="SPIN",i))(uh||{}),co=(i=>(i.IMAGES="IMAGES",i.AUDIOS="AUDIOS",i))(co||{}),pe=(i=>(i[i.WIDTH=426]="WIDTH",i[i.HEIGHT=240]="HEIGHT",i))(pe||{}),bs=(i=>(i[i.WIDTH=142]="WIDTH",i[i.HEIGHT=240]="HEIGHT",i))(bs||{}),Pt=(i=>(i[i.WIDTH=142]="WIDTH",i[i.HEIGHT=120]="HEIGHT",i[i.LINE_THICKNESS=1]="LINE_THICKNESS",i))(Pt||{});class gv extends Ut{constructor(){super();W(this,"progress");const e=new ji("Loading...",{fill:"white",fontFamily:"Verdana, Geneva, sans-serif",fontVariant:"small-caps",fontWeight:"900"});e.anchor.set(.5),e.y=pe.HEIGHT/2,e.x=pe.WIDTH/2;const s=new ji("Powered by PIXI.JS",{fill:"white",fontFamily:"Verdana, Geneva, sans-serif",fontVariant:"small-caps",fontWeight:"100",fontSize:10});s.anchor.set(.5),s.y=pe.HEIGHT-16,s.x=pe.WIDTH/2,this.progress=new ji("0.00%",{fill:"white",fontFamily:"Verdana, Geneva, sans-serif",fontVariant:"small-caps",fontWeight:"300",fontSize:10}),this.progress.anchor.set(.5),this.progress.y=pe.HEIGHT-32,this.progress.x=pe.WIDTH/2,this.addChild(e,s,this.progress)}updateProgress(e){this.progress.text=this.toPercent(e)}toPercent(e){return e.toFixed(2)+"%"}}const go=class go extends rs{constructor(t,e){super(),this.y=e,this.x=t,this.beginFill("#6A6E6AE8"),this.drawRect(0,0,go.width,1),this.endFill(),this.zIndex=2}};W(go,"width",8);let Ce=go;class _v{constructor(t){W(this,"status","ON");W(this,"volume",.25);W(this,"name");this.name=t;const e=localStorage.getItem(t),s=["ON","OFF"].includes(e);this.status=s?e:"ON"}setVolume(t){this.volume=t}isEnabled(){return this.status==="ON"}isDisabled(){return this.status!=="ON"}enable(){localStorage.setItem(this.name,"ON"),this.status="ON"}disable(){localStorage.setItem(this.name,"OFF"),this.status="OFF"}toggle(){const t=this.status.replace(/ON|OFF/g,this.status);this.status=t,localStorage.setItem(this.name,t)}}class xv extends _v{constructor(t,e){super("SLOT-SOUND"),this.winSound=t,this.spinSound=e}playSpin(t){return this.spinSound.volume=t??this.volume,this.spinSound.muted=this.isDisabled(),this.spinSound.play().then(),this.spinSound}playWin(t){return this.winSound.volume=t??this.volume,this.winSound.muted=this.isDisabled(),this.winSound.play().then(),this.winSound}}class vv extends Map{}class yv{constructor(){W(this,"spinner");W(this,"app");W(this,"slotSound");W(this,"slotSymbols");this.slotSymbols=new vv,this.spinner=new gv}attachAudios(t){this.slotSound=new xv(t.get(uh.WIN),t.get(uh.SPIN))}attachSymbols(t){for(const[e,s]of Object.entries(t))this.slotSymbols.set(e,s)}updateProgress(t){this.spinner.updateProgress(t*100)}start(){if(!this.slotSound)throw new Error("[attachAudios] hasn't been called");if(!this.slotSymbols)throw new Error("[attachSymbols] hasn't been called")}hideSpinner(){this.spinner.destroy()}createPixiApplication(){const t=document.getElementById("slot");if(!t)throw new Error("#slot not found in the document");this.app=new Co({view:t,width:pe.WIDTH,height:pe.HEIGHT,backgroundColor:0,resolution:Math.min(window.devicePixelRatio,2),antialias:!0,hello:!1})}renderSpinner(){this.app.stage.addChild(this.spinner)}drawStoppingLines(){this.app.stage.addChild(new Ce(0,Pt.HEIGHT/2),new Ce(0,bs.HEIGHT/2),new Ce(0,bs.HEIGHT-Pt.HEIGHT/2),new Ce(pe.WIDTH-Ce.width,Pt.HEIGHT/2),new Ce(pe.WIDTH-Ce.width,bs.HEIGHT/2),new Ce(pe.WIDTH-Ce.width,bs.HEIGHT-Pt.HEIGHT/2))}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.18.2
 * @author George Michael Brower
 * @license MIT
 */class qe{constructor(t,e,s,r,n="div"){this.parent=t,this.object=e,this.property=s,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),qe.nextNameID=qe.nextNameID||0,this.$name.id=`lil-gui-name-${++qe.nextNameID}`,this.$widget=document.createElement(n),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",o=>o.stopPropagation()),this.domElement.addEventListener("keyup",o=>o.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(s)}name(t){return this._name=t,this.$name.innerHTML=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled?this:(this._disabled=t,this.domElement.classList.toggle("disabled",t),this.$disable.toggleAttribute("disabled",t),this)}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(t){const e=this.parent.add(this.object,this.property,t);return e.name(this._name),this.destroy(),e}min(t){return this}max(t){return this}step(t){return this}decimals(t){return this}listen(t=!0){return this._listening=t,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const t=this.save();t!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=t}getValue(){return this.object[this.property]}setValue(t){return this.object[this.property]=t,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(t){return this.setValue(t),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class bv extends qe{constructor(t,e,s){super(t,e,s,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function ch(i){let t,e;return(t=i.match(/(#|0x)?([a-f0-9]{6})/i))?e=t[2]:(t=i.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?e=parseInt(t[1]).toString(16).padStart(2,0)+parseInt(t[2]).toString(16).padStart(2,0)+parseInt(t[3]).toString(16).padStart(2,0):(t=i.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(e=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),e?"#"+e:!1}const wv={isPrimitive:!0,match:i=>typeof i=="string",fromHexString:ch,toHexString:ch},Nr={isPrimitive:!0,match:i=>typeof i=="number",fromHexString:i=>parseInt(i.substring(1),16),toHexString:i=>"#"+i.toString(16).padStart(6,0)},Tv={isPrimitive:!1,match:i=>Array.isArray(i),fromHexString(i,t,e=1){const s=Nr.fromHexString(i);t[0]=(s>>16&255)/255*e,t[1]=(s>>8&255)/255*e,t[2]=(s&255)/255*e},toHexString([i,t,e],s=1){s=255/s;const r=i*s<<16^t*s<<8^e*s<<0;return Nr.toHexString(r)}},Ev={isPrimitive:!1,match:i=>Object(i)===i,fromHexString(i,t,e=1){const s=Nr.fromHexString(i);t.r=(s>>16&255)/255*e,t.g=(s>>8&255)/255*e,t.b=(s&255)/255*e},toHexString({r:i,g:t,b:e},s=1){s=255/s;const r=i*s<<16^t*s<<8^e*s<<0;return Nr.toHexString(r)}},Av=[wv,Nr,Tv,Ev];function Sv(i){return Av.find(t=>t.match(i))}class Cv extends qe{constructor(t,e,s,r){super(t,e,s,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Sv(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const n=ch(this.$text.value);n&&this._setValueFromHexString(n)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const e=this._format.fromHexString(t);this.setValue(e)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){return this._setValueFromHexString(t),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class ga extends qe{constructor(t,e,s){super(t,e,s,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class Pv extends qe{constructor(t,e,s,r,n,o){super(t,e,s,"number"),this._initInput(),this.min(r),this.max(n);const a=o!==void 0;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(t){return this._decimals=t,this.updateDisplay(),this}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,e=!0){return this._step=t,this._stepExplicit=e,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){let e=(t-this._min)/(this._max-this._min);e=Math.max(0,Math.min(e,1)),this.$fill.style.width=e*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?t:t.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=()=>{let v=parseFloat(this.$input.value);isNaN(v)||(this._stepExplicit&&(v=this._snap(v)),this.setValue(this._clamp(v)))},s=v=>{const _=parseFloat(this.$input.value);isNaN(_)||(this._snapClampSetValue(_+v),this.$input.value=this.getValue())},r=v=>{v.key==="Enter"&&this.$input.blur(),v.code==="ArrowUp"&&(v.preventDefault(),s(this._step*this._arrowKeyMultiplier(v))),v.code==="ArrowDown"&&(v.preventDefault(),s(this._step*this._arrowKeyMultiplier(v)*-1))},n=v=>{this._inputFocused&&(v.preventDefault(),s(this._step*this._normalizeMouseWheel(v)))};let o=!1,a,h,l,u,c;const d=5,f=v=>{a=v.clientX,h=l=v.clientY,o=!0,u=this.getValue(),c=0,window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)},p=v=>{if(o){const _=v.clientX-a,y=v.clientY-h;Math.abs(y)>d?(v.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(_)>d&&m()}if(!o){const _=v.clientY-l;c-=_*this._step*this._arrowKeyMultiplier(v),u+c>this._max?c=this._max-u:u+c<this._min&&(c=this._min-u),this._snapClampSetValue(u+c)}l=v.clientY},m=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)},g=()=>{this._inputFocused=!0},x=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",e),this.$input.addEventListener("keydown",r),this.$input.addEventListener("wheel",n,{passive:!1}),this.$input.addEventListener("mousedown",f),this.$input.addEventListener("focus",g),this.$input.addEventListener("blur",x)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=(x,v,_,y,b)=>(x-v)/(_-v)*(b-y)+y,e=x=>{const v=this.$slider.getBoundingClientRect();let _=t(x,v.left,v.right,this._min,this._max);this._snapClampSetValue(_)},s=x=>{this._setDraggingStyle(!0),e(x.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",n)},r=x=>{e(x.clientX)},n=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",n)};let o=!1,a,h;const l=x=>{x.preventDefault(),this._setDraggingStyle(!0),e(x.touches[0].clientX),o=!1},u=x=>{x.touches.length>1||(this._hasScrollBar?(a=x.touches[0].clientX,h=x.touches[0].clientY,o=!0):l(x),window.addEventListener("touchmove",c,{passive:!1}),window.addEventListener("touchend",d))},c=x=>{if(o){const v=x.touches[0].clientX-a,_=x.touches[0].clientY-h;Math.abs(v)>Math.abs(_)?l(x):(window.removeEventListener("touchmove",c),window.removeEventListener("touchend",d))}else x.preventDefault(),e(x.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",d)},f=this._callOnFinishChange.bind(this),p=400;let m;const g=x=>{if(Math.abs(x.deltaX)<Math.abs(x.deltaY)&&this._hasScrollBar)return;x.preventDefault();const _=this._normalizeMouseWheel(x)*this._step;this._snapClampSetValue(this.getValue()+_),this.$input.value=this.getValue(),clearTimeout(m),m=setTimeout(f,p)};this.$slider.addEventListener("mousedown",s),this.$slider.addEventListener("touchstart",u,{passive:!1}),this.$slider.addEventListener("wheel",g,{passive:!1})}_setDraggingStyle(t,e="horizontal"){this.$slider&&this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-dragging",t),document.body.classList.toggle(`lil-gui-${e}`,t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:e,deltaY:s}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(e=0,s=-t.wheelDelta/120,s*=this._stepExplicit?1:10),e+-s}_arrowKeyMultiplier(t){let e=this._stepExplicit?1:10;return t.shiftKey?e*=10:t.altKey&&(e/=10),e}_snap(t){const e=Math.round(t/this._step)*this._step;return parseFloat(e.toPrecision(15))}_clamp(t){return t<this._min&&(t=this._min),t>this._max&&(t=this._max),t}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class Iv extends qe{constructor(t,e,s,r){super(t,e,s,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach(n=>{const o=document.createElement("option");o.innerHTML=n,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const t=this.getValue(),e=this._values.indexOf(t);return this.$select.selectedIndex=e,this.$display.innerHTML=e===-1?t:this._names[e],this}}class Rv extends qe{constructor(t,e,s){super(t,e,s,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const Mv=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function Dv(i){const t=document.createElement("style");t.innerHTML=i;const e=document.querySelector("head link[rel=stylesheet], head style");e?document.head.insertBefore(t,e):document.head.appendChild(t)}let Ju=!1;class El{constructor({parent:t,autoPlace:e=t===void 0,container:s,width:r,title:n="Controls",closeFolders:o=!1,injectStyles:a=!0,touchStyles:h=!0}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{(l.code==="Enter"||l.code==="Space")&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(n),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),h&&this.domElement.classList.add("allow-touch-styles"),!Ju&&a&&(Dv(Mv),Ju=!0),s?s.appendChild(this.domElement):e&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=o}add(t,e,s,r,n){if(Object(s)===s)return new Iv(this,t,e,s);const o=t[e];switch(typeof o){case"number":return new Pv(this,t,e,s,r,n);case"boolean":return new bv(this,t,e);case"string":return new Rv(this,t,e);case"function":return new ga(this,t,e)}console.error(`gui.add failed
	property:`,e,`
	object:`,t,`
	value:`,o)}addColor(t,e,s=1){return new Cv(this,t,e,s)}addFolder(t){const e=new El({parent:this,title:t});return this.root._closeFolders&&e.close(),e}load(t,e=!0){return t.controllers&&this.controllers.forEach(s=>{s instanceof ga||s._name in t.controllers&&s.load(t.controllers[s._name])}),e&&t.folders&&this.folders.forEach(s=>{s._title in t.folders&&s.load(t.folders[s._title])}),this}save(t=!0){const e={controllers:{},folders:{}};return this.controllers.forEach(s=>{if(!(s instanceof ga)){if(s._name in e.controllers)throw new Error(`Cannot save GUI with duplicate property "${s._name}"`);e.controllers[s._name]=s.save()}}),t&&this.folders.forEach(s=>{if(s._title in e.folders)throw new Error(`Cannot save GUI with duplicate folder "${s._title}"`);e.folders[s._title]=s.save()}),e}open(t=!0){return this._setClosed(!t),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(t){this._closed!==t&&(this._closed=t,this._callOnOpenClose(this))}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(t=!0){return this._setClosed(!t),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const e=this.$children.clientHeight;this.$children.style.height=e+"px",this.domElement.classList.add("transition");const s=n=>{n.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",s))};this.$children.addEventListener("transitionend",s);const r=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(t){return this._title=t,this.$title.innerHTML=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach(s=>s.reset()),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),this._onChange!==void 0&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(t){this.parent&&this.parent._callOnFinishChange(t),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onOpenClose(t){return this._onOpenClose=t,this}_callOnOpenClose(t){this.parent&&this.parent._callOnOpenClose(t),this._onOpenClose!==void 0&&this._onOpenClose.call(this,t)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(t=>t.destroy())}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach(e=>{t=t.concat(e.controllersRecursive())}),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach(e=>{t=t.concat(e.foldersRecursive())}),t}}const Fv=El,Bv=new Fv({title:"Slot Machine"});class kv{constructor(t="Full block"){W(this,"_value");this._value=t}get value(){return this._value}partial(){this._value="Partial block"}full(){this._value="Full block"}isPartial(){return this._value==="Partial block"}isFull(){return this._value==="Full block"}chooseRandomly(){return Math.random()>.5?this.partial():this.full()}byPosition(t){return t==="Middle"?this.partial():this.full()}equals(t){return this.value===t.value}}var Gs=1e3,zs=Gs*60,Hs=zs*60,is=Hs*24,Ov=is*7,Lv=is*365.25,Nv=function(i,t){t=t||{};var e=typeof i;if(e==="string"&&i.length>0)return Uv(i);if(e==="number"&&isFinite(i))return t.long?zv(i):Gv(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function Uv(i){if(i=String(i),!(i.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(t){var e=parseFloat(t[1]),s=(t[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return e*Lv;case"weeks":case"week":case"w":return e*Ov;case"days":case"day":case"d":return e*is;case"hours":case"hour":case"hrs":case"hr":case"h":return e*Hs;case"minutes":case"minute":case"mins":case"min":case"m":return e*zs;case"seconds":case"second":case"secs":case"sec":case"s":return e*Gs;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function Gv(i){var t=Math.abs(i);return t>=is?Math.round(i/is)+"d":t>=Hs?Math.round(i/Hs)+"h":t>=zs?Math.round(i/zs)+"m":t>=Gs?Math.round(i/Gs)+"s":i+"ms"}function zv(i){var t=Math.abs(i);return t>=is?An(i,t,is,"day"):t>=Hs?An(i,t,Hs,"hour"):t>=zs?An(i,t,zs,"minute"):t>=Gs?An(i,t,Gs,"second"):i+" ms"}function An(i,t,e,s){var r=t>=e*1.5;return Math.round(i/e)+" "+s+(r?"s":"")}const Hv=_h(Nv);class _a extends Ut{constructor(e,s,r){super();W(this,"_spinning");W(this,"_blocks");W(this,"_stopAt");W(this,"_size",0);this.reelOptions=e,this.gui=s,this.ease=r,this._spinning=!1,this._blocks=[],this._stopAt=new kv,this.x=e.id*bs.WIDTH,this.reset()}get stopAt(){return this._stopAt}get isSpinning(){return this._spinning}get blocks(){return this._blocks}get size(){return this._blocks.length*Pt.HEIGHT}get spinTime(){return Hv(this.reelOptions.spinTime)}subscribe(){const e=this.reelOptions.id+1,s=String(e).padStart(2,"0"),r=this.gui.addFolder(`Reel ${s}`),n=["1.0 sec","1.4 sec","1.8 sec","2.2 sec","2.6 sec","3.0 sec"];r.add(this.reelOptions,"spinTime",n).name("Spin time").onChange(o=>{this.reelOptions.spinTime=o})}stopAtEquals(...e){return e.every(s=>this.stopAt.equals(s.stopAt))}async spin(){this._spinning=!0,await wl.to(this,{pixi:{y:this.getCalculatedStopAtPoint()},duration:this.getCalculatedSpinTime(),ease:this.ease.current}).then(()=>{this._spinning=!1})}addBlock(e){this._blocks.push(e),e.y=-this._blocks.length*Pt.HEIGHT,this._size+=Pt.HEIGHT+Pt.LINE_THICKNESS*2,this.addChild(e)}clearBlocks(){this._blocks.length=0,this.removeChildren()}update(e,s){for(const r of this._blocks)r.update(e,s)}reset(){this.clearBlocks(),this.y=this.size+2*Pt.HEIGHT,this._size=0,this.stopAt.chooseRandomly()}getCalculatedStopAtPoint(){return this.stopAt.isPartial()?this.size-Pt.HEIGHT/2:this.size}getCalculatedSpinTime(){return this.spinTime/1e3}}class Vv{constructor(t,e){W(this,"reels");W(this,"section");W(this,"app");W(this,"animations",["back.out(0.5)","bounce.out(0.9)","power1.out(0.7)","power1.inOut(0.4)","expo.out(0.4)","sine.out(0.4)","elastic.out(0.3)"]);W(this,"animation",{current:this.animations[0]});this.app=e,this.section=t.addFolder("Reels"),this.reels=[new _a({spinTime:"1.0 sec",id:0},this.section,this.animation),new _a({spinTime:"1.4 sec",id:1},this.section,this.animation),new _a({spinTime:"1.8 sec",id:2},this.section,this.animation)],this.update=this.update.bind(this)}subscribe(){this.section.addFolder("Animation functions").add(this.animations,"",this.animations).name("Choose fn").setValue(this.animation.current).onChange(t=>{this.animation.current=t});for(const t of this.reels)t.subscribe(),this.app.stage.addChild(t)}areRunning(){for(const t of this.reels)if(t.isSpinning)return!0;return!1}stoppedAtSamePosition(){const[t]=this.reels;return t.stopAtEquals(...this.reels)}stoppedAtPartialPosition(){for(const t of this.reels)if(!t.stopAt.isPartial())return!1;return!0}extractLines(){const t=[];let e=-1;for(;++e<3;){const s=[];for(const r of this.reels)s.push(r.blocks[r.blocks.length-1-e]);t.push(s)}return{first:t[0],second:t[1],third:t[2]}}toArray(){return this.reels}update(t,e){for(const s of this.reels)s.update(t,e)}*[Symbol.iterator](){for(const t of this.reels)yield t}}class $v{calculate([t,e,s],r){return t.equals(e,s)?this.getValue(t)*this.getMultiplier(t,r):t.isAnyBAR&&e.isAnyBAR&&s.isAnyBAR?5:t.isSevenOrCherry&&e.isSevenOrCherry&&s.isSevenOrCherry?75:0}getMultiplier(t,e){if(t.isCherry){if(e==="Top")return 2;if(e==="Middle")return 1;if(e==="Bottom")return 4}if(t.isSeven){if(e==="Top")return 1;if(e==="Middle")return 3;if(e==="Bottom")return 2}return 1}getValue(t){return t.isBARx1?10:t.isBARx2?20:t.isBARx3?50:t.isSeven?150:t.isCherry?1e3:0}}class fp{constructor(t,e){W(this,"symbols",[ft.SEVEN,ft.CHERRY,ft.BARx1,ft.BARx2,ft.BARx3]);W(this,"calculator");this.reels=t,this.reelSymbols=e,this.calculator=new $v}async spin(){if(this.reels.areRunning())return;this.reset(),this.addBlocks();const t=[];for(const e of this.reels)t.push(e.spin());await Promise.all(t)}reset(){for(const t of this.reels)t.reset()}calculatePayout(){const t=this.reels.extractLines();if(!this.reels.stoppedAtSamePosition())return 0;if(this.reels.stoppedAtPartialPosition()){const r=this.calculateMiddleLine(t.second);return r>0?(t.second.forEach(n=>n.highlightWinnerLine()),r):0}const e=this.calculateTopLine(t.first),s=this.calculateBottomLine(t.second);return e>0&&t.first.forEach(r=>r.highlightWinnerLine()),s>0&&t.second.forEach(r=>r.highlightWinnerLine()),e+s}subscribe(){}hideGui(){}showGui(){}calculateMiddleLine(t){return this.calculator.calculate(t,"Middle")}calculateTopLine(t){return this.calculator.calculate(t,"Top")}calculateBottomLine(t){return this.calculator.calculate(t,"Bottom")}}var Xv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Wv=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,jv=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;let fo=class extends Q{constructor(t=4,e=3,s=!1){super(Xv,s?jv:Wv),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new K,this.pixelSize=1,this._clamp=s,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,s,r){const n=this._pixelSize.x/e._frame.width,o=this._pixelSize.y/e._frame.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,e,s,r);else{const h=t.getFilterTexture();let l=e,u=h,c;const d=this._quality-1;for(let f=0;f<d;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,u,1),c=l,l=u,u=c;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,s,r),t.returnFilterTexture(h)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){const t=this._blur,e=this._quality,s=[t];if(t>0){let r=t;const n=t/e;for(let o=1;o<e;o++)r-=n,s.push(r)}this._kernels=s,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof K?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var pp=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Yv=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;let qv=class extends Q{constructor(t=.5){super(pp,Yv),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}};var Kv=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;const mp=class extends Q{constructor(t){super(pp,Kv),this.bloomScale=1,this.brightness=1,this._resolution=B.FILTER_RESOLUTION,typeof t=="number"&&(t={threshold:t});const e=Object.assign(mp.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:s,blur:r,quality:n,pixelSize:o,resolution:a}=e;this._extractFilter=new qv(e.threshold),this._extractFilter.resolution=a,this._blurFilter=s?new fo(s):new fo(r,n),this.pixelSize=o,this.resolution=a}apply(t,e,s,r,n){const o=t.getFilterTexture();this._extractFilter.apply(t,e,o,1,n);const a=t.getFilterTexture();this._blurFilter.apply(t,o,a,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=a,t.applyFilter(this,e,s,r),t.returnFilterTexture(a),t.returnFilterTexture(o)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let Zv=mp;Zv.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:B.FILTER_RESOLUTION};var Qv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Jv=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;const gp=class extends Q{constructor(t){super(Qv,Jv),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,gp.defaults,t)}apply(t,e,s,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,t.applyFilter(this,e,s,r)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};let ty=gp;ty.defaults={center:[.5,.5],radius:100,strength:1};var ey=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    // mix resulting color with current color
    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
}
`,iy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,os=os||{};os.stringify=function(){var i={"visit_linear-gradient":function(t){return i.visit_gradient(t)},"visit_repeating-linear-gradient":function(t){return i.visit_gradient(t)},"visit_radial-gradient":function(t){return i.visit_gradient(t)},"visit_repeating-radial-gradient":function(t){return i.visit_gradient(t)},visit_gradient:function(t){var e=i.visit(t.orientation);return e&&(e+=", "),t.type+"("+e+i.visit(t.colorStops)+")"},visit_shape:function(t){var e=t.value,s=i.visit(t.at),r=i.visit(t.style);return r&&(e+=" "+r),s&&(e+=" at "+s),e},"visit_default-radial":function(t){var e="",s=i.visit(t.at);return s&&(e+=s),e},"visit_extent-keyword":function(t){var e=t.value,s=i.visit(t.at);return s&&(e+=" at "+s),e},"visit_position-keyword":function(t){return t.value},visit_position:function(t){return i.visit(t.value.x)+" "+i.visit(t.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(t){return i.visit_color(t.value,t)},visit_hex:function(t){return i.visit_color("#"+t.value,t)},visit_rgb:function(t){return i.visit_color("rgb("+t.value.join(", ")+")",t)},visit_rgba:function(t){return i.visit_color("rgba("+t.value.join(", ")+")",t)},visit_color:function(t,e){var s=t,r=i.visit(e.length);return r&&(s+=" "+r),s},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(t){var e="",s=t.length;return t.forEach(function(r,n){e+=i.visit(r),n<s-1&&(e+=", ")}),e},visit:function(t){if(!t)return"";var e="";if(t instanceof Array)return i.visit_array(t,e);if(t.type){var s=i["visit_"+t.type];if(s)return s(t);throw Error("Missing visitor visit_"+t.type)}else throw Error("Invalid node.")}};return function(t){return i.visit(t)}}();var os=os||{};os.parse=function(){var i={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function e(C){var k=new Error(t+": "+C);throw k.source=t,k}function s(){var C=r();return t.length>0&&e("Invalid input not EOF"),C}function r(){return _(n)}function n(){return o("linear-gradient",i.linearGradient,h)||o("repeating-linear-gradient",i.repeatingLinearGradient,h)||o("radial-gradient",i.radialGradient,c)||o("repeating-radial-gradient",i.repeatingRadialGradient,c)}function o(C,k,X){return a(k,function(R){var H=X();return H&&(O(i.comma)||e("Missing comma before color stops")),{type:C,orientation:H,colorStops:_(y)}})}function a(C,k){var X=O(C);if(X){O(i.startCall)||e("Missing (");var R=k(X);return O(i.endCall)||e("Missing )"),R}}function h(){return l()||u()}function l(){return S("directional",i.sideOrCorner,1)}function u(){return S("angular",i.angleValue,1)}function c(){var C,k=d(),X;return k&&(C=[],C.push(k),X=t,O(i.comma)&&(k=d(),k?C.push(k):t=X)),C}function d(){var C=f()||p();if(C)C.at=g();else{var k=m();if(k){C=k;var X=g();X&&(C.at=X)}else{var R=x();R&&(C={type:"default-radial",at:R})}}return C}function f(){var C=S("shape",/^(circle)/i,0);return C&&(C.style=P()||m()),C}function p(){var C=S("shape",/^(ellipse)/i,0);return C&&(C.style=I()||m()),C}function m(){return S("extent-keyword",i.extentKeywords,1)}function g(){if(S("position",/^at/,0)){var C=x();return C||e("Missing positioning value"),C}}function x(){var C=v();if(C.x||C.y)return{type:"position",value:C}}function v(){return{x:I(),y:I()}}function _(C){var k=C(),X=[];if(k)for(X.push(k);O(i.comma);)k=C(),k?X.push(k):e("One extra comma");return X}function y(){var C=b();return C||e("Expected color definition"),C.length=I(),C}function b(){return T()||E()||w()||A()}function A(){return S("literal",i.literalColor,0)}function T(){return S("hex",i.hexColor,1)}function w(){return a(i.rgbColor,function(){return{type:"rgb",value:_(M)}})}function E(){return a(i.rgbaColor,function(){return{type:"rgba",value:_(M)}})}function M(){return O(i.number)[1]}function I(){return S("%",i.percentageValue,1)||D()||P()}function D(){return S("position-keyword",i.positionKeywords,1)}function P(){return S("px",i.pixelValue,1)||S("em",i.emValue,1)}function S(C,k,X){var R=O(k);if(R)return{type:C,value:R[X]}}function O(C){var k,X;return X=/^[\n\r\t\s]+/.exec(t),X&&G(X[0].length),k=C.exec(t),k&&G(k[0].length),k}function G(C){t=t.substr(C)}return function(C){return t=C.toString(),s()}}();var sy=os.parse;os.stringify;var tc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ec={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function ry(i){var t,e=[],s=1,r;if(typeof i=="string")if(tc[i])e=tc[i].slice(),r="rgb";else if(i==="transparent")s=0,r="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(i)){var n=i.slice(1),o=n.length,a=o<=4;s=1,a?(e=[parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16)],o===4&&(s=parseInt(n[3]+n[3],16)/255)):(e=[parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16)],o===8&&(s=parseInt(n[6]+n[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),r="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(i)){var h=t[1],l=h==="rgb",n=h.replace(/a$/,"");r=n;var o=n==="cmyk"?4:n==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(d,f){if(/%$/.test(d))return f===o?parseFloat(d)/100:n==="rgb"?parseFloat(d)*255/100:parseFloat(d);if(n[f]==="h"){if(/deg$/.test(d))return parseFloat(d);if(ec[d]!==void 0)return ec[d]}return parseFloat(d)}),h===n&&e.push(1),s=l||e[o]===void 0?1:e[o],e=e.slice(0,o)}else i.length>10&&/[0-9](?:\s|\/)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),r=i.match(/([a-z])/ig).join("").toLowerCase());else isNaN(i)?Array.isArray(i)||i.length?(e=[i[0],i[1],i[2]],r="rgb",s=i.length===4?i[3]:1):i instanceof Object&&(i.r!=null||i.red!=null||i.R!=null?(r="rgb",e=[i.r||i.red||i.R||0,i.g||i.green||i.G||0,i.b||i.blue||i.B||0]):(r="hsl",e=[i.h||i.hue||i.H||0,i.s||i.saturation||i.S||0,i.l||i.lightness||i.L||i.b||i.brightness]),s=i.a||i.alpha||i.opacity||1,i.opacity!=null&&(s/=100)):(r="rgb",e=[i>>>16,(i&65280)>>>8,i&255]);return{space:r,values:e,alpha:s}}var dh={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},xa={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(i){var t=i[0]/360,e=i[1]/100,s=i[2]/100,r,n,o,a,h;if(e===0)return h=s*255,[h,h,h];s<.5?n=s*(1+e):n=s+e-s*e,r=2*s-n,a=[0,0,0];for(var l=0;l<3;l++)o=t+1/3*-(l-1),o<0?o++:o>1&&o--,6*o<1?h=r+(n-r)*6*o:2*o<1?h=n:3*o<2?h=r+(n-r)*(2/3-o)*6:h=r,a[l]=h*255;return a}};dh.hsl=function(i){var t=i[0]/255,e=i[1]/255,s=i[2]/255,r=Math.min(t,e,s),n=Math.max(t,e,s),o=n-r,a,h,l;return n===r?a=0:t===n?a=(e-s)/o:e===n?a=2+(s-t)/o:s===n&&(a=4+(t-e)/o),a=Math.min(a*60,360),a<0&&(a+=360),l=(r+n)/2,n===r?h=0:l<=.5?h=o/(n+r):h=o/(2-n-r),[a,h*100,l*100]};function ny(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments));var t,e=ry(i);if(!e.space)return[];const s=e.space[0]==="h"?xa.min:dh.min,r=e.space[0]==="h"?xa.max:dh.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],s[0]),r[0]),t[1]=Math.min(Math.max(e.values[1],s[1]),r[1]),t[2]=Math.min(Math.max(e.values[2],s[2]),r[2]),e.space[0]==="h"&&(t=xa.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function _p(i){switch(typeof i){case"string":return oy(i);case"number":return Gr(i);default:return i}}function oy(i){const t=ny(i);if(!t)throw new Error(`Unable to parse color "${i}" as RGBA.`);return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function ay(i){const t=sy(gy(i));if(t.length===0)throw new Error("Invalid CSS gradient.");if(t.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const e=t[0],s=hy(e.type),r=ly(e.colorStops),n=py(e.orientation);return{type:s,stops:r,angle:n}}function hy(i){const t={"linear-gradient":0,"radial-gradient":1};if(!(i in t))throw new Error(`Unsupported gradient type "${i}"`);return t[i]}function ly(i){const t=dy(i),e=[];for(let s=0;s<i.length;s++){const r=uy(i[s]);e.push({offset:t[s],color:r.slice(0,3),alpha:r[3]})}return e}function uy(i){return _p(cy(i))}function cy(i){switch(i.type){case"hex":return`#${i.value}`;case"literal":return i.value;default:return`${i.type}(${i.value.join(",")})`}}function dy(i){const t=[];for(let r=0;r<i.length;r++){const n=i[r];let o=-1;n.type==="literal"&&n.length&&"type"in n.length&&n.length.type==="%"&&"value"in n.length&&(o=parseFloat(n.length.value)/100),t.push(o)}const e=r=>{for(let n=r;n<t.length;n++)if(t[n]!==-1)return{indexDelta:n-r,offset:t[n]};return{indexDelta:t.length-1-r,offset:1}};let s=0;for(let r=0;r<t.length;r++){const n=t[r];if(n!==-1)s=n;else if(r===0)t[r]=0;else if(r+1===t.length)t[r]=1;else{const o=e(r),a=(o.offset-s)/(1+o.indexDelta);for(let h=0;h<=o.indexDelta;h++)t[r+h]=s+(h+1)*a;r+=o.indexDelta,s=t[r]}}return t.map(fy)}function fy(i){return i.toString().length>6?parseFloat(i.toString().substring(0,6)):i}function py(i){if(typeof i>"u")return 0;if("type"in i&&"value"in i)switch(i.type){case"angular":return parseFloat(i.value);case"directional":return my(i.value)}return 0}function my(i){const t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(i in t))throw new Error(`Unsupported directional value "${i}"`);return t[i]}function gy(i){let t=i.replace(/\s{2,}/gu," ");return t=t.replace(/;/g,""),t=t.replace(/ ,/g,","),t=t.replace(/\( /g,"("),t=t.replace(/ \)/g,")"),t.trim()}var _y=Object.defineProperty,xy=Object.defineProperties,vy=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,yy=Object.prototype.hasOwnProperty,by=Object.prototype.propertyIsEnumerable,sc=(i,t,e)=>t in i?_y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,va=(i,t)=>{for(var e in t||(t={}))yy.call(t,e)&&sc(i,e,t[e]);if(ic)for(var e of ic(t))by.call(t,e)&&sc(i,e,t[e]);return i},wy=(i,t)=>xy(i,vy(t));const rc=90;function Ty(i){return[...i].sort((t,e)=>t.offset-e.offset)}const Al=class extends Q{constructor(t){t&&"css"in t&&(t=wy(va({},ay(t.css||"")),{alpha:t.alpha,maxColors:t.maxColors}));const e=va(va({},Al.defaults),t);if(!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(iy,ey),this._stops=[],this.autoFit=!1,Object.assign(this,e)}get stops(){return this._stops}set stops(t){const e=Ty(t),s=new Float32Array(e.length*3),r=0,n=1,o=2;for(let a=0;a<e.length;a++){const h=_p(e[a].color),l=a*3;s[l+r]=h[r],s[l+n]=h[n],s[l+o]=h[o]}this.uniforms.uColors=s,this.uniforms.uOffsets=e.map(a=>a.offset),this.uniforms.uAlphas=e.map(a=>a.alpha),this.uniforms.uNumStops=e.length,this._stops=e}set type(t){this.uniforms.uType=t}get type(){return this.uniforms.uType}set angle(t){this.uniforms.uAngle=t-rc}get angle(){return this.uniforms.uAngle+rc}set alpha(t){this.uniforms.uAlpha=t}get alpha(){return this.uniforms.uAlpha}set maxColors(t){this.uniforms.uMaxColors=t}get maxColors(){return this.uniforms.uMaxColors}};let Sn=Al;Sn.LINEAR=0,Sn.RADIAL=1,Sn.CONIC=2,Sn.defaults={type:Al.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};var Ey=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ay=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;const xp=class extends Q{constructor(t){super(Ey,Ay),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,xp.defaults,t)}apply(t,e,s,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,s,r)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let vp=xp;vp.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var Sy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Cy=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,Py=Object.defineProperty,nc=Object.getOwnPropertySymbols,Iy=Object.prototype.hasOwnProperty,Ry=Object.prototype.propertyIsEnumerable,oc=(i,t,e)=>t in i?Py(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,ac=(i,t)=>{for(var e in t||(t={}))Iy.call(t,e)&&oc(i,e,t[e]);if(nc)for(var e of nc(t))Ry.call(t,e)&&oc(i,e,t[e]);return i};const fh=class extends Q{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=B.FILTER_RESOLUTION;const e=t?ac(ac({},fh.defaults),t):fh.defaults,{kernels:s,blur:r,quality:n,pixelSize:o,resolution:a}=e;this._offset=new $e(this._updatePadding,this),this._tintFilter=new Q(Sy,Cy),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=a,this._blurFilter=s?new fo(s):new fo(r,n),this.pixelSize=o,this.resolution=a;const{shadowOnly:h,rotation:l,distance:u,offset:c,alpha:d,color:f}=e;this.shadowOnly=h,l!==void 0&&u!==void 0?(this.rotation=l,this.distance=u):this.offset=c,this.alpha=d,this.color=f}apply(t,e,s,r){const n=t.getFilterTexture();this._tintFilter.apply(t,e,n,1),this._blurFilter.apply(t,n,s,r),this.shadowOnly!==!0&&t.applyFilter(this,e,s,0),t.returnFilterTexture(n)}_updatePadding(){const t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){j("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/Ms}set rotation(t){j("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*Ms,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return zr(this._tintFilter.uniforms.color)}set color(t){Gr(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let My=fh;My.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:B.FILTER_RESOLUTION};var Dy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Fy=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;const ph=class extends Q{constructor(t){super(Dy,Fy),this.offset=100,this.fillMode=ph.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=N.from(this._canvas,{scaleMode:Re.NEAREST}),Object.assign(this,ph.defaults,t)}apply(t,e,s,r){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,s,r)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,s=this.sampleSize,r=Math.min(this.minSize/s,.9/this._slices);if(this.average){const n=this._slices;let o=1;for(let a=0;a<e;a++){const h=o/(n-a),l=Math.max(h*(1-Math.random()*.6),r);t[a]=l,o-=l}t[e]=o}else{let n=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<e;a++){const h=Math.max(o*n*Math.random(),r);t[a]=h,n-=h}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes,e=this._slices-1;for(let s=e;s>0;s--){const r=Math.random()*s>>0,n=t[s];t[s]=t[r],t[r]=n}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,s=this._canvas.getContext("2d");s.clearRect(0,0,8,t);let r,n=0;for(let o=0;o<this._slices;o++){r=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*t,h=r>0?r:0,l=r<0?-r:0;s.fillStyle=`rgba(${h}, ${l}, 0, 1)`,s.fillRect(0,n>>0,t,a+1>>0),n+=a}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let s=0;s<e;s++)this._sizes[s]=t[s]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let s=0;s<e;s++)this._offsets[s]=t[s]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*Ms;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let cs=ph;cs.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},cs.TRANSPARENT=0,cs.ORIGINAL=1,cs.LOOP=2,cs.CLAMP=3,cs.MIRROR=4;var By=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ky=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const yp=class extends Q{constructor(i){const t=Object.assign({},yp.defaults,i),{outerStrength:e,innerStrength:s,color:r,knockout:n,quality:o,alpha:a}=t,h=Math.round(t.distance);super(By,ky.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/h).toFixed(7)}`).replace(/__DIST__/gi,`${h.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:r,outerStrength:e,innerStrength:s,padding:h,knockout:n,alpha:a})}get color(){return zr(this.uniforms.glowColor)}set color(i){Gr(i,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(i){this.uniforms.outerStrength=i}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(i){this.uniforms.innerStrength=i}get knockout(){return this.uniforms.knockout}set knockout(i){this.uniforms.knockout=i}get alpha(){return this.uniforms.alpha}set alpha(i){this.uniforms.alpha=i}};let bp=yp;bp.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var Oy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ly=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,Ny=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;const wp=class extends Q{constructor(t){super(Oy,Ny.replace("${perlin}",Ly)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(wp.defaults,t);this._angleLight=new K,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,s,r){const{width:n,height:o}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,s,r)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*Ms;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};let Uy=wp;Uy.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var Gy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,zy=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`;const Tp=class extends Q{constructor(i){super(Gy,zy),this._hue=0;const t=Object.assign({},Tp.defaults,i);Object.assign(this,t)}get hue(){return this._hue}set hue(i){this._hue=i,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(i){this.uniforms.uAlpha=i}get colorize(){return this.uniforms.uColorize}set colorize(i){this.uniforms.uColorize=i}get lightness(){return this.uniforms.uLightness}set lightness(i){this.uniforms.uLightness=i}get saturation(){return this.uniforms.uSaturation}set saturation(i){this.uniforms.uSaturation=i}};let Hy=Tp;Hy.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};var Vy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$y=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;const Ep=class extends Q{constructor(t,e=0){super(Vy,$y),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof t=="number"?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,Ep.defaults,t)}apply(t,e,s,r){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,s,r)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let Xy=Ep;Xy.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var Wy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,jy=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;const Ln=class extends Q{constructor(t=1,e=0,s=.1,r=1,n=!1){super(Wy,jy.replace(/\$\{angleStep\}/,Ln.getAngleStep(s))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=r,this.uniforms.uKnockout=n,Object.assign(this,{thickness:t,color:e,quality:s,alpha:r,knockout:n})}static getAngleStep(t){const e=Math.max(t*Ln.MAX_SAMPLES,Ln.MIN_SAMPLES);return(Math.PI*2/e).toFixed(7)}apply(t,e,s,r){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,s,r)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return zr(this.uniforms.uColor)}set color(t){Gr(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let hc=Ln;hc.MIN_SAMPLES=1,hc.MAX_SAMPLES=100;var Yy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,qy=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;const Ap=class extends Q{constructor(t){super(Yy,qy),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Ap.defaults,t)}apply(t,e,s,r){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.time=this.time,t.applyFilter(this,e,s,r)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};let Ky=Ap;Ky.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var Zy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Qy=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;const Sp=class extends Q{constructor(t=[0,0],e,s=0){super(Zy,Qy),this.center=t,Object.assign(this,Sp.defaults,e),this.time=s}apply(t,e,s,r){this.uniforms.time=this.time,t.applyFilter(this,e,s,r)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};let Jy=Sp;Jy.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var t1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,e1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;let Cp=class extends Q{constructor(t){var e,s;super(t1,e1),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=(e=t.start)!=null?e:new K(0,window.innerHeight/2),this.uniforms.end=(s=t.end)!=null?s:new K(600,window.innerHeight/2),this.uniforms.delta=new K(30,30),this.uniforms.texSize=new K(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}},i1=class extends Cp{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,s=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/s,this.uniforms.delta.y=e/s}},s1=class extends Cp{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,s=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/s,this.uniforms.delta.y=t/s}};const Pp=class extends Q{constructor(t,e,s,r){super(),typeof t=="number"&&(j("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:s,end:r}),t=Object.assign({},Pp.defaults,t),this.tiltShiftXFilter=new i1(t),this.tiltShiftYFilter=new s1(t)}apply(t,e,s,r){const n=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,n,1),this.tiltShiftYFilter.apply(t,n,s,r),t.returnFilterTexture(n)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}};let r1=Pp;r1.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};var n1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;const Ip=class extends Q{constructor(i){super(n1,o1),Object.assign(this,Ip.defaults,i)}get offset(){return this.uniforms.offset}set offset(i){this.uniforms.offset=i}get radius(){return this.uniforms.radius}set radius(i){this.uniforms.radius=i}get angle(){return this.uniforms.angle}set angle(i){this.uniforms.angle=i}};let a1=Ip;a1.defaults={radius:200,angle:4,padding:20,offset:new K};var h1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,l1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,lc=Object.getOwnPropertySymbols,u1=Object.prototype.hasOwnProperty,c1=Object.prototype.propertyIsEnumerable,d1=(i,t)=>{var e={};for(var s in i)u1.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&lc)for(var s of lc(i))t.indexOf(s)<0&&c1.call(i,s)&&(e[s]=i[s]);return e};const Rp=class extends Q{constructor(i){const t=Object.assign(Rp.defaults,i),{maxKernelSize:e}=t,s=d1(t,["maxKernelSize"]);super(h1,l1.replace("${maxKernelSize}",e.toFixed(1))),Object.assign(this,s)}get center(){return this.uniforms.uCenter}set center(i){this.uniforms.uCenter=i}get strength(){return this.uniforms.uStrength}set strength(i){this.uniforms.uStrength=i}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(i){this.uniforms.uInnerRadius=i}get radius(){return this.uniforms.uRadius}set radius(i){(i<0||i===1/0)&&(i=-1),this.uniforms.uRadius=i}};let f1=Rp;f1.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};class Mp{constructor(){}update(t,e){}}class p1 extends Mp{constructor(){super();W(this,"_filter");W(this,"_high",5);W(this,"_low",1);W(this,"_sign",1);this._filter=new bp({outerStrength:0,distance:10,innerStrength:0})}get filter(){return this._filter}update(e,s){const r=this._filter.outerStrength+this._sign*e*.1;r>this._high&&(this._sign=-1),r<this._low&&(this._sign=1),this._filter.outerStrength=r}}class m1 extends Mp{constructor(){super();W(this,"_filter");this._filter=new vp({vignettingAlpha:.5,vignettingBlur:.3,time:0,seed:10})}get filter(){return this._filter}update(e,s){this._filter.time+=e*.1,this._filter.seed=Math.random()*e}}class Ur extends rs{constructor(e,s,r){super();W(this,"_id");W(this,"_key");W(this,"_sprite");W(this,"_default");W(this,"_highlight");this._id=r,this._key=s,this.width=Pt.WIDTH,this.height=Pt.HEIGHT,this.lineStyle(Pt.LINE_THICKNESS,"#6A6E6AE8",1),this.drawRect(0,0,Pt.WIDTH,Pt.HEIGHT),this.endFill(),this.zIndex=1,this._sprite=new Je(e),this._sprite.width=Ur.reduce(Pt.WIDTH).by(30),this._sprite.height=Ur.reduce(Pt.HEIGHT).by(30),this._sprite.x=this.alignX(this._sprite),this._sprite.y=this.alignY(this._sprite),this.addChild(this._sprite),this._highlight=new p1,this._default=new m1,this._sprite.filters=[this._default.filter]}get id(){return this._id}get key(){return this._key}get isBARx1(){return this.key===ft.BARx1}get isBARx2(){return this.key===ft.BARx2}get isBARx3(){return this.key===ft.BARx3}get isAnyBAR(){return this.isBARx1||this.isBARx2||this.isBARx3}get isSeven(){return this.key===ft.SEVEN}get isCherry(){return this.key===ft.CHERRY}get isSevenOrCherry(){return this.isSeven||this.isCherry}static reduce(e){return{by(s){return e-e*s/100}}}equals(...e){return e.every(s=>s.key===this.key)}highlightWinnerLine(){this._sprite.filters=[this._highlight.filter]}update(e,s){this._highlight.update(e,s),this._default.update(e,s)}alignX(e){return(this.width-e.width)/2}alignY(e){return(this.height-e.height)/2}}let Sl=class Nn{static int(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t)+t)}static shuffleList(t){for(let e=0;e<t.length;e++){const s=Nn.int(e+1,t.length-1);[t[s],t[e]]=[t[e],t[s]]}return t}static pick(t,e=30){const s=[],r=Nn.pickRandom(t);let n=r.next();for(;s.length<e&&n.value;)s.push(n.value),n=r.next();return s}static*pickRandom(t){let e=0,s=Array.from(t);for(;;){s.length===0&&(s=Array.from(t));const r=Nn.int(0,s.length),n=s[r];s.splice(r,1),yield{val:n,idx:e++}}}};class uc extends fp{constructor(t,e){super(t,e)}addBlocks(){for(const[t,e]of this.reels.toArray().entries()){const s=Sl.pick(this.symbols,(t+1)*8);for(const{val:r,idx:n}of s)e.addBlock(new Ur(this.reelSymbols.get(r),r,n))}}}class cc extends fp{constructor(e,s,r){super(e,s);W(this,"position");W(this,"symbol");W(this,"section");this.section=r.addFolder("Fixed mode options"),this.position="Middle",this.symbol=ft.SEVEN}setPosition(e){this.position=e}setSymbol(e){this.symbol=e}hideGui(){super.hideGui(),this.section.hide()}showGui(){super.showGui(),this.section.show()}addBlocks(){for(const[e,s]of this.reels.toArray().entries()){s.stopAt.byPosition(this.position);const r=Sl.pick(this.symbols,(e+1)*8),n=this.getIndex(r.length);for(const{val:o,idx:a}of r){const h=a===n?this.symbol:o;s.addBlock(new Ur(this.reelSymbols.get(h),h,a))}}}subscribe(){super.subscribe(),this.section.hide();const e=["Top","Middle","Bottom"];this.section.add(this,"position",e).name("Position").setValue("Middle").onChange(s=>{this.reset(),this.position=s}),this.section.add(this,"symbol",this.symbols).name("Symbol").setValue("Seven").onChange(s=>{this.reset(),this.symbol=s})}getIndex(e){return this.position==="Top"?e-1:e-2}}class g1{constructor(t,e,s){W(this,"modes");W(this,"mode");this.modes={Random:new uc(t,e),Fixed:new cc(t,e,s)},this.mode=this.modes.Random}get current(){return this.mode}isFixed(){return this.mode instanceof cc}isRandom(){return this.mode instanceof uc}changeTo(t){this.mode.hideGui(),this.mode=this.modes[t],this.mode.showGui()}subscribe(){this.modes.Random.subscribe(),this.modes.Fixed.subscribe()}}const Ui=class Ui extends yv{constructor(){super();W(this,"reels");W(this,"modes");W(this,"section");this.createPixiApplication(),this.renderSpinner(),this.section=Bv.addFolder("Game options"),this.reels=new Vv(this.section,this.app),this.modes=new g1(this.reels,this.slotSymbols,this.section)}static getInstance(){return Ui.instance||(Ui.instance=new Ui),Ui.instance}start(){super.start(),this.hideSpinner(),this.drawStoppingLines(),this.subscribe()}attachControls(e){e.addEventListener("click",this.spin.bind(this))}async spin(){await this.modes.current.spin();const e=this.modes.current.calculatePayout();e>0&&console.log(`You won ${e} coins!`)}subscribe(){this.reels.subscribe(),this.modes.subscribe(),this.app.ticker.add(e=>this.reels.update(e,this.app.ticker.elapsedMS/1e3)),this.section.add(this.modes,"name",["Random","Fixed"]).setValue("Random").name("Select mode").onChange(e=>{this.modes.changeTo(e),this.modes.isFixed()&&(this.modes.current.setPosition("Middle"),this.modes.current.setSymbol(ft.SEVEN))}),this.section.add(this,"spin").name("Spin")}};W(Ui,"instance");let mh=Ui;const di=class di{static imageFileVerify(t){const e=di.extract(t);return di.imageAllowedExtensions.includes(e)?null:Error(`Image type [${e}] not allowed to load!`)}static audioFileVerify(t){const e=di.extract(t);return di.audioAllowedExtensions.includes(e)?null:new Error(`Audio type [${e}] not allowed to load!`)}static extract(t){const e=t.split(".");return e[e.length-1].toLowerCase()}};W(di,"imageAllowedExtensions",["png","jpg","bmp","gif","svg","tif","tiff","webp","jpeg"]),W(di,"audioAllowedExtensions",["mp3","wav","ogg"]);let po=di,_1=class{constructor(){W(this,"errors",[]);W(this,"imageResources",[]);W(this,"audioResources",[]);W(this,"images",new Map);W(this,"audios",new Map);W(this,"counter",0);W(this,"callback",()=>{})}get total(){return this.imageResources.length+this.audioResources.length}get progress(){return this.counter/this.total*100}get done(){return this.progress===100}get loaded(){return this.counter}onProgress(t){return this.callback=t,this}startLoading(){return console.time("Resource loading finished in"),this.errors.length?Promise.reject(this.errors.pop()):(console.log("Started"),Promise.all([Promise.all(this.imageResources.map(this.loadImage.bind(this))),Promise.all(this.audioResources.map(this.loadAudio.bind(this)))]).then(([t,e])=>{for(const[s,r]of t)this.images.set(s,r);for(const[s,r]of e)this.audios.set(s,r)}).then(()=>console.timeEnd("Resource loading finished in")).then(()=>Promise.resolve({images:this.images,audios:this.audios})))}addImage(t){const e=po.imageFileVerify(t);if(e){this.errors.push(e);return}this.imageResources.push(t)}addImages(...t){for(const e of t)this.addImage(e);return this}addAudio(t){const e=po.audioFileVerify(t);if(e){this.errors.push(e);return}this.audioResources.push(t)}addAudios(...t){for(const e of t)this.addAudio(e);return this}loadImage(t){return new Promise((e,s)=>{const r=new Image;r.src=t,r.addEventListener("load",()=>{this.counter++,this.callback({total:this.total,loaded:this.loaded,progress:this.progress,done:this.done}),e([t,r])}),r.addEventListener("error",()=>s(new Error(`Resource [${t}] was not able to load!`)))})}loadAudio(t){return new Promise((e,s)=>{const r=new Audio(t),n=()=>{this.counter++,this.callback({total:this.total,loaded:this.loaded,progress:this.progress,done:this.done}),e([t,r])};r.addEventListener("canplaythrough",n),r.load(),e([t,r]),r.addEventListener("error",()=>s(new Error(`Resource [${t}] was not able to load!`)))})}};const Ts=class Ts{static addAudios(t){Ts.loader.addAudios(...t)}static loadAudios(t,e){return typeof e=="function"&&Ts.loader.onProgress(({progress:s})=>{e(s/100)}),Ts.loader.startLoading().then(({audios:s})=>s)}};W(Ts,"loader",new _1);let mo=Ts;wl.registerPlugin(Tl);Tl.registerPIXI($0);B.ROUND_PIXELS=!0;const ws=mh.getInstance(),He={images:0,audios:0,setImage(i){He.images=i,ws.updateProgress(He.value)},setAudio(i){He.audios=i,ws.updateProgress(He.value)},get value(){return(He.images+He.audios)/2}};mo.addAudios([Gp,zp]);zi.addBundle(co.IMAGES,{[ft.BARx1]:kp,[ft.BARx2]:Op,[ft.BARx3]:Lp,[ft.SEVEN]:Np,[ft.CHERRY]:Up});const x1=[zi.loadBundle(co.IMAGES,He.setImage.bind(He)),mo.loadAudios(co.AUDIOS,He.setAudio.bind(He))],v1=document.querySelector("#spin");Promise.all(x1).then(([i,t])=>{ws.attachAudios(t),ws.attachSymbols(i),ws.attachControls(v1)}).then(()=>ws.start()).then(()=>{const i=[ft.SEVEN,ft.CHERRY,ft.BARx1,ft.BARx2,ft.BARx3];Sl.pick(i,8)}).catch(i=>{console.error((i==null?void 0:i.message)||i)});
//# sourceMappingURL=index-a6e0a5f5.js.map
